<HTML>
<HEAD>
   <META HTTP-EQUIV="content-type" CONTENT="text/html">
   <META NAME="Generator" CONTENT="enCoreXpress/2.1.1">
   <META NAME="Description" CONTENT="This page was generated by the Gentleman Loser enCoreXpress/2.1.1 web server on August 29. 2000 at 23:58:08, /et">
   <META NAME="Keywords" CONTENT="enCore, enCore Xpress, Gentleman Loser, MOO, CypherText">
   <META NAME="Copyright" CONTENT="High Wired enCore and enCore Xpress is Copyright (C) 1997-2000 of enCore Open Source MOO Project. All Rights Reserved.">
   <TITLE>idle_chat (Gentleman Loser)</TITLE>
</HEAD>
<BODY   BGCOLOR="White" BACKGROUND="" TEXT="Black" LINK="blue" ALINK="red" VLINK="purple">
<FONT FACE="Arial" SIZE="5" COLOR="Black">
idle_chat<BR>
</FONT>
<FONT FACE="Arial" SIZE="3" COLOR="Black">
-- Start log: Saturday, August 26, 2000 2:22:20 am Gentleman Loser time --<BR>
<BR>
Bruce says, "in both cases, you seem to have to stop recording in order to see what's there"<BR>
Bruce says, "i know that corresponds to a real tape recorder, but sometimes you can carry modelling the real world tooo far"<BR>
andreas says, "Yes. But I think the log already exists somewhere out there. Sec..."<BR>
andreas says, "Ok. Since I started the recording, the object is owned by me. When you clock on "edit" in the toolbar, you can list your objects there. There will be an object test_log, which is the one you created. This has a property text with the text."<BR>
andreas teleports idle_chat in.<BR>
andreas says, "Ok, here is the log file I`ve created. Just click on idle_chat to see the text."<BR>
Bruce says, "there's no "edit" in my tool bar"<BR>
andreas says, "Then you have to reconnect. You only get that as a programmer."<BR>
Bruce says, "tap tap .. is this mike live?"<BR>
Bruce says, "aaah .. it *is* live"<BR>
andreas says, "MOOs are by far the most dynamic environments I know."<BR>
Bruce says, "more so than Squeak et al?"<BR>
andreas says, "Yes. MOO comes out of XEROX, just as Smalltalk."<BR>
andreas says, "But in Smalltalk there is no permission system, so you cannot have hundreds of programmers work on the same image."<BR>
igor waves.<BR>
Bruce waves back<BR>
andreas says, "hi igor..."<BR>
Bruce says, "so it's lunchtime Saturday here, Andreas is probably ready for bed in the next hour or so, and igor is the middle of Friday evening..."<BR>
andreas says, "so since you two are awake and I`m going to sleep soon, will anybody of you look into the parser/lexer stuff?"<BR>
Bruce says, "who do we know in India or something :-)"<BR>
Bruce says, "I'm building a generic Dylan app package in the format they want"<BR>
Bruce says, ".. basically a modification of make-dylan-app"<BR>
igor says, "So, can we check our 'contest app' somewhere?  I don't think we'll need more than one library..."<BR>
Bruce says, "the parser needed last year was simple enough to hand-code in a couple of hours using recursive descent.  The chances are that this year will heva no more difficult a parsing task"<BR>
igor nods.<BR>
Bruce says, "I agree -- one library but possibly several source files"<BR>
igor says, "Probably ad-hoc is our best bet, as anything more than that could end up causing us more trouble than we need..."<BR>
Bruce says, " we may want to be able to explore different avenues, though"<BR>
andreas says, "yes. one library, types only where neccessary for dispatch, nor for speed."<BR>
Bruce says, ".. and we need to be able to rename the project at a late stage :-)"<BR>
igor nods.  (or to use the free type checks)<BR>
Bruce says, "types for speed when we get it *working*, and the deadline looms"<BR>
You hear a quiet popping sound; Wizard has disconnected.<BR>
Bruce says, "I also 8very* much doubt that we'll get a task where parser speed is a rate-limiter"<BR>
Bruce says, ".. or even I/O speed in general, so our crappy I/O libs don't matter."<BR>
Bruce says, "basically we should get C-like speed, but without the memory management hassles.  Our only downside against some of the languages is pattern matching"<BR>
Bruce says, "we've got awesome macros that we can likely use to good advantage"<BR>
andreas says, "Though the macro system still has bugs. The getopt macros don`t work currently for instance."<BR>
Bruce says, "GFs can be pretty expressive as pattern matchers, but I suspect not too fast compared to some other mechanisms"<BR>
andreas says, "But that won`t stop us to use macros."<BR>
Bruce says, " .. with the curren timplementation at least ... if we had that new Cecil algorithm we'd be pretty sweet there too"<BR>
andreas says, "Ok, I go to bed now."<BR>
andreas waves.<BR>
You hear a quiet popping sound; andreas has disconnected.<BR>
Bruce thinks "in fact, with the Cecil dispatch algorithm, last year's challenge could have been implemented simply as one big GF, and let the compiler optomise it for us!!!!<BR>
Bruce says, "OK, igor, so I'll get a skeleton app checked in (probably while you sleep), and I've also got to get some work out of the way so I'm free for a couple of days"<BR>
Bruce says, "do you have plans?"<BR>
igor plans to get a bunch of work out of the way...<BR>
igor is working on a web site for a client, which actually uses a MOO as the back-end.<BR>
igor says, "Do we have a 'master compile computer'?"<BR>
igor says, "They'd like a statically linked executable, if possible..."<BR>
igor says, "(I imagine we can provide that...)"<BR>
Bruce says, "not yet.  Do we need one, as such."<BR>
igor can install a stable GD for the purpose, as he has a 450MHz PIII<BR>
Bruce says, "right -- I'm working on getting the directory layout right, and being able to build a staticly-linked binary as default"<BR>
igor can also create user accounts for the team to work in...<BR>
Bruce says, "actually .. I *always* use statically linked anyway, for speed"<BR>
igor says, "Right."<BR>
igor says, "Does that statically link the clib as well?"<BR>
Bruce has an Athlon 700<BR>
Bruce says, "ummm .. not 1005 positive on that"<BR>
igor nods.  You'll be a tad faster, although I have an ATM connection, for reliability.<BR>
igor says, "(though speed for such a trivial program won't matter as much...)"<BR>
igor says, "In any case, I am going to go cuddle with my girlfriend now...  I'll perhaps be back a little later."<BR>
igor says, "(Don't expect me to sleep too much tonight anyhow...)"<BR>
Bruce says, "i'm picking that anything we do will have an under-15 second build time -- probably 10 - 11 or so"<BR>
Bruce says, "I'm just off to have a cappuchino with my GF as well :-)"<BR>
Bruce says, "They're using Redhat 6.2 and so am I, so I think we can wing the clib"<BR>
Bruce is AFK<BR>
Bruce tests<BR>
You hear a quiet popping sound; Bruce has disconnected.<BR>
Bruce has connected.<BR>
Bruce is back on Linux instead of MacOS<BR>
Bruce shares a URL...<BR>
  <<A HREF="http://www.gwydiondylan.org" TARGET="_blank">http://www.gwydiondylan.org</A>>.<BR>
Bruce pings again<BR>
Bruce pings yet again<BR>
Bruce declares the timeout problem ... gone<BR>
andreas has connected.<BR>
andreas says, "hi folks... I'm awake now, but the weather is fine, so I'll be spending the hours until the challenge is publised in the sun with wife and kid..."<BR>
igor waves.<BR>
igor nods.<BR>
igor has to finish up a bunch of work first...<BR>
igor says, "Oh...  Could you @programmer me?"<BR>
You hear a quiet popping sound; andreas has disconnected.<BR>
Wizard has connected.<BR>
igor is now a programmer.<BR>
igor says, "Thanks!"<BR>
Wizard says, "Ok, see you later..."<BR>
Wizard waves.<BR>
igor waves.<BR>
You hear a quiet popping sound; Wizard has disconnected.<BR>
igor drops ICFP Countdown Clock.<BR>
You hear the bips of keyclick, the sliding of mice and the hum of computers in the distance as igor fades slowly out of view, heading towards them.<BR>
There are the light bips of keyclick and the sliding of mice as igor fades into view, shoving itself away from the console, which promptly fades away.<BR>
You hear the bips of keyclick, the sliding of mice and the hum of computers in the distance as igor fades slowly out of view, heading towards them.<BR>
andreas has connected.<BR>
A small swarm of 3x5 index cards blows in and disperses, revealing igor.<BR>
A small swarm of 3x5 index cards arrives, engulfs igor, and carries it away.<BR>
A small swarm of 3x5 index cards blows in and disperses, revealing igor.<BR>
igor waves to andreas.<BR>
igor says, "Look at #178 :-)"<BR>
andreas says, "Nice! One problem: using the Xpress client I see the description in the upper window, and the countdown in the lower window."<BR>
igor scratches his head...<BR>
igor says, "How do multi-line descriptions work around here, then?"<BR>
igor says, "#178:description merely returns a list..."<BR>
andreas says, "I have no clue. The MOO I used to operace came without web interface, I'm new to this web stuff."<BR>
andreas says, "I see. The list has three strings, the middle one is the URL of the object."<BR>
igor says, "Oh well...  Until someone with an Xpress client feels like fixing it, people using Xpress clients will have to suck it up :-)"<BR>
igor says, "I'll be back in a few."<BR>
andreas says, "ok, see you later. Maybe I find out how this web stuff is supposed to work in the meantime..."<BR>
You hear a quiet popping sound; igor has disconnected.<BR>
igor has connected.<BR>
Bruce pops in and waves<BR>
igor says, "Yo."<BR>
Bruce says, "gooooooood morning!  0752 here"<BR>
igor grins.<BR>
igor says, "15:55 here..."<BR>
Bruce says, ".. and your countdown clock doesn't work for me.  I can "look" at it, but clicking on it doesn't show the time"<BR>
igor [to Bruce]: Then 'look' at it...  This is a MOO, therefore I don't care if your pretty little web interface thingy works or not :-)<BR>
Bruce thinks "it's not *my* pretty web interface"<BR>
igor says, "'tis not mine either, I'm using TinyFugue, the One True Client ;-)"<BR>
Bruce says, "I've got a choice between this enCoreXpress thing that Andreas pointed me to, or else telnet.  AFAIK, anyway.  The only MOOing I've done before is when I've been feeding the calves"<BR>
igor says, "What OS are you using right now?"<BR>
Bruce says, "well, my desk contains one 17" Trinitron attached to RedHat 6.2 and another 17" Trinitron attached to MacOS 8.6.  Take your pick."<BR>
Bruce says, "both have Communicator 4.72"<BR>
Bruce says, "right at this very instant I'm using the Linux box"<BR>
igor says, "Well, try <A HREF="http://www.rapscallion.co.uk/" TARGET="_blank">http://www.rapscallion.co.uk/</A> for the Mac"<BR>
igor says, "Or ftp://ftp.tcp.com/pub/mud/Clients/MUDDweller(macintosh).bin.gz, again for the Mac..."<BR>
Bruce downloads the first one<BR>
Bruce yawns.  Man, it's been a while since I've seen sunrise on a Sunday morning...<BR>
Bruce 's world becomes suddenly brighter and shadows form<BR>
Bruce says, "do you have a cellphone that does SMS?"<BR>
igor says, "Nope."<BR>
Bruce says, "Andreas and I have exchanged numbers"<BR>
igor doesn't have a cellphone period...<BR>
Bruce uses his for text mesages about 50 times more frequently than he uses it for voice<BR>
Bruce says, "If you happen, for some reason, to want to attract my attention when I don't seem to be responding here or to email, feel free to womble on over to www.mtnsms.com and send a message to +64211104457.  I'll usually get it within 5 - 10 seconds."<BR>
igor nods.<BR>
Bruce says, "Andreas is +491777777742""<BR>
igor yays at the Wombles :-)<BR>
igor says, "And, of course, what we've all been waiting for: will the contest info appear at 5pm EDT or 6pm EDT (due to the EST/EDT confusion)"<BR>
Bruce says, "well they gae it in UTC as well"<BR>
Bruce says, "I guess they just refelxively said "EST" when they meant "EDT"."<BR>
igor used the UTC to setup #178<BR>
igor says, "It claims we have 72:37:04 left..."<BR>
Bruce says, "Americans do that to me so often that I just assume they mean the time on their clocks and correct the TZ without even thinking"<BR>
igor nods.  In any case, the clock should be timezone-blind<BR>
Bruce says, "then it's only advanced by 37 seconds since I've been online this morning."<BR>
Bruce says, "i *suspect* it's more like 37 minutes"<BR>
igor says, "This server is operating on GMT, prolly because andreas hasn't set /etc/localtime properly..."<BR>
Bruce says, "waitsec ... that's 72 *hours* left."<BR>
igor says, "Yep :-)"<BR>
Bruce says, ".. and it's advanced by 37 minutes, as it should"<BR>
igor didn't feel that the microseconds were all that important...<BR>
igor says, "Besides, we don't get microsecond timings on most MOOs."<BR>
igor's MOO does, though...<BR>
Bruce says, "well, I make it 34 minutes left"<BR>
Bruce says, "33 minutes ....  NOW"<BR>
igor grins.<BR>
-----------------------------------igor------------------------------------<BR>
Bruce says, "33 minutes ....  NOW"<BR>
l clock<BR>
You see a large Guiness sign on the wall.  In the middle, an LED display proclaims:<BR>
72:32:55<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "ah .. OK, so it's time until the *finish*.  that's OK then"<BR>
Bruce is still asleep<BR>
igor says, "Yes."<BR>
igor figured it was of limited use *before* the contest started, and I spent all of about 2 minutes writing it....<BR>
Bruce suspects he'll see the sunrise again 72 hours hence<BR>
Bruce suspects it might be after an all-nighter<BR>
Bruce says, "ok, I'm now on via rapscallion"<BR>
Bruce shares a URL...<BR>
  <<A HREF="http://www.gwydiondylan.org" TARGET="_blank">http://www.gwydiondylan.org</A>>.<BR>
igor grins.<BR>
Bruce wondered if it would redirect @URL to netscape or something.  It didn't.<BR>
igor says, "We might want to put the fact that we're doing this, a brief statement of the problem and your email address on the home page..."<BR>
Bruce  agrees<BR>
Bruce wonders why when he typed :agrees the a was swallowed, apparently as a command, and how to avoid it<BR>
igor says, "Odd..."<BR>
Bruce says, "it said 'sending command to all characters'"<BR>
igor says, "Weird..."<BR>
Bruce says, "so I had to type ': agrees'"<BR>
Bruce act now<BR>
Bruce says, "OK, there was a preference in the app which converted ':a' to send to all, ':?' to send to a particular person etc. I nuked it"<BR>
igor says, "OK, that's pretty weird..."<BR>
igor pokes Andreas.<BR>
A small swarm of 3x5 index cards arrives, engulfs igor, and carries it away.<BR>
There are the light bips of keyclick and the sliding of mice as igor fades into view, shoving itself away from the console, which promptly fades away.<BR>
Bruce says, "do you recall where the web oage source hides?"<BR>
igor hmms.<BR>
Bruce thinks probably easier to wait to Andreas<BR>
igor grins.<BR>
igor says, "Probably."<BR>
Bruce says, "the problem is up!"<BR>
Bruce says, "the problem is up!"ray tracer"<BR>
igor says, "Woo!"<BR>
igor prints a hard copy...<BR>
igor is pretty familiar with the math, etc. involved, which is cool...<BR>
igor drops IFCP TODO List.<BR>
Bruce says, "and Dylan has fast FP"<BR>
Bruce thinks we might want to work with the optimiser-hacking branch to get packed arrays<BR>
igor says, "OK, use 'add "Do something!" to todo to add stuff to the TODO list :-)"<BR>
Bruce says, "just got the emial from the organisers .. 11 minutes late"<BR>
igor says, "the "resources" section looks particularly useful..."<BR>
igor says, "Oh well...  No EMK for us..."<BR>
igor says, "Have you sent anything to the icfp2000 list lately?"<BR>
igor says, "i.e., are my filters discarding it, or is it just quiet..."<BR>
Bruce says, "not since 0916 your time"<BR>
Bruce wonders if there's some way we can compile this stuff instead of interpreting it<BR>
Bruce says, "we need a lexer but no parser.  ::phew::"<BR>
Bruce knows PostScript pretty well<BR>
igor says, "Cool.  I'm not very good with postfix languages..."<BR>
igor says, "I do, however, know a bunch about 3D graphics."<BR>
igor says, "(And I have Foley, Van Dam right here, too)"<BR>
Bruce says, "my  Foley and Van Dam is an old one -- (c) 1983"<BR>
Bruce says, "looks like a bug in the function at the bottom of P7"<BR>
Bruce says, "should be 'lst 0 get lst 1 get if-cons apply'"<BR>
Bruce says, "pretty cool language, actually.  Basically lambda-based, but with a stack for arg passing.  Look at the factorial example on P8. It's crying out for a Y-combinator.  And we could make one :-)"<BR>
You hear a quiet popping sound; igor has disconnected.<BR>
igor has connected.<BR>
igor says, "Hello, hello (again...)"<BR>
Bruce says, "hi"<BR>
igor says, "Sorry, I accidently hit the power bar, thus killing my computer :-P"<BR>
igor says, "While it was rebooting, I went and started dinner..."<BR>
igor says, "(and I picked my hardcopy of task.ps up at the printers)"<BR>
Bruce says, "OK, so I guess we need to define a spec for "object" (a scene), and then maybe you get to work on the Ray Tracing part and I get to work on the language part that builds the scene?"<BR>
igor nods.<BR>
igor says, "So a scene is simply a big compound object, then?"<BR>
Bruce says, "how do you feel about implementing the CSG stuff?"<BR>
igor says, "CSG?"<BR>
Bruce says, "yes, a scene is implemented by a bunch of object unions"<BR>
igor hasn't done more than skim the problem yet...<BR>
Bruce says, "constructive solid geometry"<BR>
igor says, "Ah...  I should be able to do that..."<BR>
Bruce says, "you part can probably crib a bunch of stuff from POVRay"<BR>
igor says, "This project does not require any reflections, does it?"<BR>
Bruce says, "we need plances and spheres for tier 1, and directional lights (at infinity)."<BR>
Bruce says, "you sure do need to follow the reflections!"<BR>
Bruce says, "see P11"<BR>
igor says, "Well, that's just illumination, though..."<BR>
andreas waves.<BR>
Bruce waves back<BR>
igor says, "You can't make a mirror here, can you?"<BR>
Bruce says, "so what's the S ray for?"<BR>
Bruce says, "What if Ks is 1 and Kd is zero?"<BR>
andreas says, "oh, it's already up for an hour...."<BR>
igor says, "The 'S' ray is related to lighting.  The angle between S and L figures into the reflective component of the lighting."<BR>
Bruce says, "an hour and 20 minutes, actually."<BR>
andreas mixes up his timezones from time to time...<BR>
igor nods that Andreas's computer's clock is slow<BR>
igor says, "So, this is a ray-tracer, but not a recursive one."<BR>
Bruce says, "what's the KsIsC term at the end, then?  Looks like pure reflection form other objects"<BR>
igor says, "Nope.  That's the ambient coefficient."<BR>
Bruce says, "It's recursive.  The render operator takes a parameter to specify the max recusrion depth to follow to"<BR>
igor says, "Hmm... No it isn't..."<BR>
Bruce says, "the first term is the ambient"<BR>
igor says, "Right."<BR>
igor says, "OK, so it is recursive."<BR>
igor says, "(not that that makes is all that worse..."<BR>
andreas picks up his Foley/van Dam...<BR>
Bruce points out that's he's never actually looked at a ray tracer before but knows some physics and math :-(<BR>
igor has Foley/van Dam as well...<BR>
igor [to Bruce]: OK, so what else belongs on the 'todo' list?<BR>
Bruce also has it, but an old one (1983) form when he was a 3rd year student<BR>
igor points at "todo"<BR>
andreas says, "I volounteer for the PPM exporter."<BR>
Bruce says, "yeah, that's the easiest"<BR>
igor says, "Chapter 16.12"<BR>
Bruce says, "andreas, I'm prety good on PostScript, and Igor seems to knwo something abhout 3D.  how are you on what?"<BR>
igor says, "(use 'add "item" to todo to add stuff)"<BR>
andreas says, "I have a 3D background, but it's been 5 years that I've touched a transformation matrix,"<BR>
Bruce says, "all the necessary math is in the task spec"<BR>
igor says, "Though I'm probably the most familiar with it, ATM."<BR>
andreas says, "the gwydion matrix library unfortunately isn't polished up for 3D purposes."<BR>
igor says, "Hmm...  That's unfortunate...  What's it missing?"<BR>
Bruce says, "we can hand-code 4x4 matrix operations in about an hour"<BR>
andreas says, "cross product of two vectors for instance."<BR>
andreas says, "that should be the first task in the 3d section."<BR>
igor says, "A special case for 3D vectors should be easy for that."<BR>
igor has the general case programmed elsewhere, but not in Dylan...<BR>
Bruce says, "where do we need cross product?  thee are only dots (which are trivial) in the illumiation function."<BR>
Bruce says, "to get surface normals?"<BR>
igor was wondering about that as well...<BR>
igor says, "We can figure out the surface normals through a bit of Funky Math, I think..."<BR>
Bruce thinks so too<BR>
andreas says, "I'm not through the task yet, but surface normals are usually useful for illumination."<BR>
Bruce says, "surface normal of a plane falls straight out of the equation"<BR>
igor says, "For a sphere, it's even easier..."<BR>
Bruce nods<BR>
andreas says, "I'll print the file, and be back in a quarter of an hour..."<BR>
Bruce says, "KO"<BR>
Bruce just had hot pancakes and sugar and lemon joice delivered by GF.  mmmmm<BR>
igor says, "Cool..."<BR>
igor extracts a cup of not-quite-cold-enough-yet iced tea from the fridge.<BR>
Bruce says, "she knows this is important :-)"<BR>
igor says, "Woohoo!  Our CVS messages go to gd-chatter..."<BR>
igor says, "Actually, perhaps what we could do is add 'gd-chatter' to the ifcp2000 list, then tell people who want to follow the play-by-play to subscribe to gd-chatter..."<BR>
Bruce says, "umm .. mine didn't last night"<BR>
igor says, "Well, mine just did..."<BR>
Bruce saw it<BR>
igor shrugs.<BR>
Bruce says, ".cvsignore added"<BR>
igor says, "I don't think we'll have a real security problem on this contest."<BR>
igor says, "Everyone knows *what* to do, after all..."<BR>
Bruce nods<BR>
igor says, "And the people that know and can use dylan seem to be generally mature..."<BR>
igor says, "Anyhow...   Let's get some preliminary code hashed out..."<BR>
Bruce says, "we're going to struggle just to get a correct implementation -- performance hacks are going to be *way* down the list"<BR>
igor grins.<BR>
igor says, "If they wanted to be *really* evil, they'd have made the test-box an SMP machine..."<BR>
Bruce says, "they did that the first time around."<BR>
Bruce says, "there *are* mirrors, btw"<BR>
igor says, "Yeah...  Recursive RTing it is, then..."<BR>
Bruce shares a URL...<BR>
  <<A HREF="http://www.cs.bell-labs.com/who/jhr/icfp/images/reflect.jpg" TARGET="_blank">http://www.cs.bell-labs.com/who/jhr/icfp/images/reflect.jpg</A>>.<BR>
Bruce says, "% ... <color> <kd> <ks> <n>  ==>  ... <surface>"<BR>
igor says, "?"<BR>
igor says, "Oh, right..."<BR>
Bruce says, "% ... <color> <kd> <ks> <n>  ==>  ... <surface>"<BR>
Bruce says, "{ /n /ks /kd /color"<BR>
Bruce says, "  { /v /u /face"<BR>
Bruce says, "    color kd ks n"<BR>
Bruce says, "  }"<BR>
Bruce says, "} /const-surface"<BR>
Bruce says, "% a mirror plane"<BR>
Bruce says, "white 0.1 1.0 1.0 const-surface apply plane /mirror"<BR>
Bruce says, "that's difuse = 0.1, specular = 1.0"<BR>
igor nods.<BR>
igor says, "So...  What do we start with?"<BR>
igor <- eager to break the ground...<BR>
andreas says, "left-handed world coodinates... thanks a lot :)"<BR>
igor says, "No, left-handed is standard...  X goes right, Y goes up, and Z goes in."<BR>
andreas says, "since when? for all I did, z came out of the screen."<BR>
andreas says, "SGI Performer had left-handed coordinates, as far as I remember."<BR>
igor shrugs.  It doesn't matter *that* much...<BR>
Bruce says, "some classes to hold a built scene description"<BR>
igor nods.<BR>
Bruce says, "that way we can split the work in two immediately and start working in each direction"<BR>
igor says, "Get the basic interfaces between the different parts of the program established."<BR>
Bruce says, "whoever works on the ray tracer proper will be able to start immdeiately, missing only the procedural surfaces"<BR>
igor nods.<BR>
Bruce says, "I'm happy to rough out the language implementation"<BR>
igor says, "So, an 'obj' should be either a primitive or a list of sub-objects, K?"<BR>
Bruce says, "at the moment, yes"<BR>
igor says, "<obj> = type-union(<primitive>, <collection>) ?"<BR>
Bruce says, "later there are several different ways of combning the subobjects"<BR>
andreas says, "classic composite pattern"<BR>
andreas says, "we should make the transformations objects too."<BR>
igor says, "Which transformations?  the boolean ones?"<BR>
Bruce says, "I think he means coordinate transforms"<BR>
igor hasn't looked too closely at the transformation system yet...<BR>
andreas says, "yes. but stop the press, I noticed that the transforms return a new object instead of transforming an existing one."<BR>
Bruce says, "yes, it's all totally side-effect free"<BR>
igor says, "Yeehaw..."<BR>
Bruce says, "except for the small detail of the operand stack..."<BR>
Bruce says, "we'll give the GC a good workoout :-)"<BR>
Bruce says, "note that the object that got transformed may be the base object for a *number* of differently-transformed concrete objects"<BR>
igor says, "So,  "<surface> cube 4 5 7 translate" => unit cube at (4,5,7)?"<BR>
Bruce says, "yes.  "<BR>
Bruce says, "Plus an unreachable unit cube at the origin"<BR>
igor says, "Right (which got GC's somewhere along the line, prolly)"<BR>
igor says, "er GC'd"<BR>
igor says, "Cool...  we don't need arbitrary rotations, even..."<BR>
Bruce says, "'<surface> cube /foo  foo 4 5 7 translate /A   foo 10 11 12 /B' gives two cubes"<BR>
igor nods.  I don't see any way to avoid simply making copies here...<BR>
igor says, "(unless we implemented some weird copy-on-write system, which is probably more trouble than it's worth)"<BR>
Bruce says, "THERE IS NO 'WRITE'"<BR>
igor says, "Yes, but we can't really toss references around, hoping that something will only be used once..."<BR>
igor says, "Actually, yes we can."<BR>
igor says, "But, in any case, this is not a useful optimization."<BR>
Bruce says, "an object is a bunch of things with an associated transform"<BR>
Bruce says, "transforms concatenate happily"<BR>
igor says, "Why?  Why not just make a copy of the object and move the coordinates?"<BR>
igor says, "Oh, OK, I see..."<BR>
Bruce says, "you could , of course, but what do you gain by copying it?"<BR>
Bruce says, "for a cube or sphere it hardly matters, but what about for a model of the concorde?"<BR>
igor says, "This means we can have a 'canonical cube' somewhere, right?"<BR>
Bruce says, "right, and "cube" just returns it"<BR>
igor says, "OK, I'm down with this now..."<BR>
andreas says, "that's a good idea. So any cube is just a reference to a canonical cube plus a transformation matrix, which gets accumulated."<BR>
Bruce says, "OK, how's this sound.  I'll get to work on the lexer and language, minus the graphics."<BR>
Bruce says, "you guys design the object representation and start the ray tracer."<BR>
Bruce says, "by the time I need the object reps you'll have them :-)"<BR>
andreas says, "SOunds good. I'm typing a vector/matrix library as we talk."<BR>
igor says, "Sounds good."<BR>
igor [to andreas]: What's wrong with our own?<BR>
andreas says, "I can't find a multiplication of matrix and vector, for instance."<BR>
igor says, "Hmm.  Is that, perhaps, in the 'vector' library?"<BR>
andreas says, "There is none."<BR>
igor says, "What about a quick hack to redefine vectors as 3x1 arrays, then mult them?"<BR>
Bruce thinks 'this is going to keep us busy'<BR>
igor tries to remember all of his Dylan sytax again...<BR>
andreas [to igor]: this is probably what I'm going to do. 4x1, to be more precise.<BR>
igor says, "Good, good."<BR>
andreas says, "Or just some more methods on \*."<BR>
igor says, "I'm bashing out the basic object classes."<BR>
igor nods at Andreas.  Exactly what I'd have gone for...<BR>
Bruce says, "leave room for a bounding sphere around each composite object."<BR>
Bruce says, "testing the distance between a point and a ray is easy and fast"<BR>
igor nods.  That's an optimization we can add later, though...<BR>
Bruce says, "finding the optimal point for the center of the sphere is the only hard part..."<BR>
igor nods.  In a pinch, we can simply use the average of all the centres of the component objs...<BR>
Bruce says, "actually, a bounding ellipsoid woudl be cooool :-)"<BR>
igor says, "Later, later..."<BR>
Bruce says, "I know..."<BR>
Bruce off to work<BR>
igor checks in obj.dylan.<BR>
Bruce says, "keep reading the home page and the FAQ guys"<BR>
igor nods.<BR>
Bruce says, "the code listing bug I mentioned before has been corected"<BR>
Bruce was going to email them but didn't<BR>
Bruce correctly picked what they *meant* though, which is a good sign that he understands the language<BR>
igor [to andreas]: How goes that matrix thing?<BR>
andreas says, "busy typing..."<BR>
igor says, "How do I index into a matrix?"<BR>
andreas says, "It's a subclass of array. So you do mat[x, y]"<BR>
-----------------------------------igor------------------------------------<BR>
define method translate!(o :: <obj>, x, y, z) => (same_obj :: <obj>)<BR>
  let trans_matrix = $identity;<BR>
<BR>
  trans_matrix[1, 4] := x;<BR>
  trans_matrix[2, 4] := y;<BR>
  trans_matrix[3, 4] := z;<BR>
<BR>
  o.transform := o.transform * trans_matrix;<BR>
end method translate!;<BR>
---------------------------------finished----------------------------------<BR>
igor says, "(+ o; at the bottom)"<BR>
andreas says, "how do you do the multiline paste?"<BR>
igor says, "use @paste"<BR>
igor says, "Is that the general idea (renaming $identity to whatever, of course...)"<BR>
andreas says, "the first line is a problem. Use identity-matrix(dimensions: #[4,4]) instead."<BR>
igor nods.  Sounds good...  Why don't we make a global containing that, actually...<BR>
andreas says, "matrices are mutable, so you would modify the identity matrix in your code above."<BR>
igor says, "Ah, true enough..."<BR>
-----------------------------------igor------------------------------------<BR>
define variable *trans_matrix* = identity-matrix(dimensions: #[4,4]);<BR>
<BR>
define method translate!(o :: <obj>, x, y, z) => (same_obj :: <obj>)<BR>
  *trans_matrix*[1, 4] := x;<BR>
  *trans_matrix*[2, 4] := y;<BR>
  *trans_matrix*[3, 4] := z;<BR>
<BR>
  o.transform := o.transform * *trans_matrix*;<BR>
  o;<BR>
end method translate!;<BR>
---------------------------------finished----------------------------------<BR>
igor says, "Reduce, reuse, recycle :-)"<BR>
andreas says, "Now that's ok."<BR>
Bruce says, "umm ... you're crapping all over that global"<BR>
igor says, "Yeah, and?"<BR>
Bruce says, "well it's not going to be identity the next time you want to use it"<BR>
igor says, "As long as I always crap over the *same* part of the global, it's all good..."<BR>
Bruce says, "but you don't -- there's scaling and rotation isn't there?"<BR>
igor [to Bruce]: Yeah, I'm gonna use different global  matrices for those...<BR>
Bruce says, "OK"<BR>
igor has already renamed to to *translation_matrix*<BR>
andreas says, "oh, and please use dashes instead of underscores. We want to show off ;)."<BR>
igor says, "Right, right.  Old habits dying hard..."<BR>
igor says, "Are matrices 0-index or 1-index?"<BR>
andreas says, "0-index."<BR>
igor says, "And which is first, the row or the column?"<BR>
igor hmms.  Wait a sec...  To transform A => A', is it A' = TA or A' = AT?<BR>
andreas says, "It's matrix[row, column]."<BR>
andreas says, "And TA."<BR>
igor says, "That's what I thought."<BR>
andreas hopes that he remembers right after 5 years.<BR>
andreas says, "And in TTTA, operations are done from right to left."<BR>
igor says, "Do we have a designated 'not defined yet' value?"<BR>
igor's adjusting it to use the existing rot/translation matrix if it's the same rotation as before...<BR>
igor says, "Anyhow, I'm gonna go chow down on dinner.  I'll be back in 30 or so."<BR>
igor checks in his code.<BR>
igor <- back.<BR>
Bruce <- busy<BR>
igor grins.<BR>
igor continues writing up the rotation/scaling functions.<BR>
andreas says, "wait, I'll commit my changes..."<BR>
igor says, "No more 'breaking news'..."<BR>
igor says, "So, just to clarify, we do feel buff enough to go for the full Tier-III solution, right?"<BR>
andreas done with check-in.<BR>
-----------------------------------igor------------------------------------<BR>
Processing matrix.dylan<BR>
...<BR>
In Define Method *{<vector>, <matrix>}:<BR>
"matrix.dylan", line 18, characters 26 through 35:<BR>
      (matrix(vector) * mat).components;<BR>
                             ^^^^^^^^^^<BR>
  Error: Undefined variable: components<BR>
..<BR>
---------------------------------finished----------------------------------<BR>
andreas says, "yes, do another update. I fixed that a second ago."<BR>
igor says, "Ah, there it is."<BR>
Bruce says, "tier 1 2 or 3 doesn't affect my bit :-)"<BR>
andreas is still undecided.<BR>
Bruce says, "(except trivially)"<BR>
You hear a quiet popping sound; igor has disconnected.<BR>
You hear a quiet popping sound; Bruce has disconnected.<BR>
You hear a quiet popping sound; andreas has disconnected.<BR>
andreas has connected.<BR>
igor has connected.<BR>
igor says, "Server panic bad, eh?"<BR>
andreas says, "hi igor..."<BR>
You hear a quiet popping sound; andreas has disconnected.<BR>
andreas has connected.<BR>
igor says, "Hello again.,"<BR>
igor says, "What was the panic all about?"<BR>
andreas says, "hi again..."<BR>
andreas says, "out of RAM on the server."<BR>
andreas says, "The Gwydion documentation is generated using jade. jade is triggered when the SGML in the CVS changes."<BR>
andreas says, "I blindly copied the line from gdwww to icfp, without taking out the jade part."<BR>
andreas says, "so the massive number of commits spawned a massive number of jade processes."<BR>
andreas says, "won't happen again."<BR>
You hear a quiet popping sound; andreas has disconnected.<BR>
andreas has connected.<BR>
andreas says, "ok, I go to bed now. "<BR>
andreas waves<BR>
igor waves.<BR>
You hear a quiet popping sound; andreas has disconnected.<BR>
Bruce has connected.<BR>
Bruce says, "hiya"<BR>
igor says, "Yo!"<BR>
igor says, "Andreas has packed it in for the night..."<BR>
Bruce back from a nice brisk walk outside<BR>
igor nods.<BR>
igor writing some <color>-manipulation code.<BR>
Bruce says, "we had a little recorder going here before.  I see we lots it in the crash"<BR>
igor shrugs.  Oh well...<BR>
Bruce says, "probably doens't metter much, but it would be nice to be able to check what others were tlaking about while you were absent"<BR>
igor nods.<BR>
igor says, "Don't be absent, then :-)"<BR>
igor says, "Andreas & I were pretty quiet, though..."<BR>
Bruce says, "so it must be 10:30 where you are.  How long until you pack it in too?"<BR>
igor says, "A while..."<BR>
igor says, "How long will you be up for?"<BR>
Bruce says, "I've got another ten hours at least available today.  I'll certainly have a working lexer by then, and I hope most of a crude interpreter impleemntation as well."<BR>
igor nods.  Cool!<BR>
igor says, "I'm going to write the PPM exporter now, I think."<BR>
igor has some preliminary work done on the ray tracing engine<BR>
Bruce says, "you'll want to write each pixel on the fly as you calculate it won't you?"<BR>
igor says, "Well, I figured I'd store 'em up in a buffer then squirt the whole thing to disk, but I suppose we could do it on the fly..."<BR>
Bruce says, "I mean, you can calculate the pixels in any damn order that you want, so why not do it in the PPM order?"<BR>
igor says, "Actually, it'll be faster to write to a colorbuffer then write the whole buffer out, as we don't need 1 syscall/pixel then."<BR>
igor says, "We can write in blocks > 3 bytes at a time, and we'll probably have plenty of memory..."<BR>
Bruce says, "Right, but that's just a matter of saving up a few hundred or few thousand of them, not the whole image"<BR>
Bruce says, "64 MB was what they promised"<BR>
igor says, "I suppose..."<BR>
igor says, "OK, sure..."<BR>
Bruce says, "if the output files remain in the several-hundred-K range then it reaally doens't matter much, but what if they throw a *big* image at us."<BR>
igor says, "True enough.  Might as well make this an unlimited-resolution kinda deal, then."<BR>
igor looks up the stuff about PPMs...<BR>
Bruce says, "in the past competitions, the judges have thrown some *wierd* input files at the programs.  Dealing gracefully with anything is needed to stop being disqualified"<BR>
igor says, "Cool."<BR>
Bruce says, "correctness and not crashing are the #1 marking criteria.  If you crash you're out.  Immediately."<BR>
igor nods.  We're reasonably crash-proof, fortunately...<BR>
Bruce says, "Dylan is good like that"<BR>
igor says, "(barring unfortunate divide-by-zeros)"<BR>
Bruce says, "in FP that is OK.  the only place integer can happen is in the interpreter, and I'll be checking operands each time, believe me!"<BR>
igor grins.<BR>
Bruce says, "Are Dylan symbols case-sensitive?"<BR>
igor says, "I don't think so."<BR>
Bruce says, "drat.  We need case-sensitive identifiers"<BR>
igor says, "Oh, #"foo" kindsa symbols?"<BR>
Bruce right<BR>
igor hmms.<BR>
igor says, "Other than comparing to string-table, I dunno."<BR>
igor says, "Interpreter speed is important, however, for procedural textures..."<BR>
Bruce says, "they're not case sensitive:  drm_101.htm#HEADING101-30"<BR>
Bruce says, "how do I paste a mul;ti-line in?"<BR>
Bruce says, "as (singleton (<symbol>)) string => symbol [Sealed G.F. Method]"<BR>
Bruce says, ""This method on as returns the symbol that has the name string. If the symbol does "not yet exist, it is created. This method on as will always return the same symbol for"<BR>
Bruce says, "strings of the same characters, without regard to alphabetic case."<BR>
igor says, "@paste"<BR>
-----------------------------------Bruce-----------------------------------<BR>
as (singleton (<symbol>)) string => symbol [Sealed G.F. Method]<BR>
<BR>
This method on as returns the symbol that has the name string. If the symbol does not yet exist, it is created. This method on as will always return the same symbol for<BR>
strings of the same characters, without regard to alphabetic case.<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "close but no ceeegar"<BR>
igor says, "Do you only need case-insensitive symbols for variables?"<BR>
Bruce says, "yes"<BR>
Bruce says, "er, case sensitive"<BR>
igor says, "right..."<BR>
igor says, "Well, hmm...  What punctionation is disallowed in variable names?"<BR>
Bruce says, "actually, its probably OK. It'w lexically bound, so I can do the name -> object-address lookup before runtime"<BR>
igor says, "Just stick a * in front of each capital letter:  FoO => *Fo*O"<BR>
igor says, "That works, too."<BR>
Bruce says, "can have letters, digits, dashes, and underscores.  So that would work"<BR>
Bruce says, "dam, wish I knew where my copy of SICP was.  I think I loaned it to someone :-("<BR>
igor has a copy here, if that helps...<BR>
Bruce wishes it did<BR>
igor is going to go for coffee with his g/f and will be back in about 30 minutes.<BR>
Bruce says, "ciao"<BR>
igor <- back (again)<BR>
Bruce says, "hi"<BR>
Bruce says, "you won't believe this -- I just stole the float parsing function from d2c.  And it's buggy!!  It totally fails on any float constant with an exponent"<BR>
igor says, "Doh!"<BR>
Bruce says, "see atof in lexer.dylan"<BR>
Bruce says, "first, it calls the return() exit function when it sees a e/E/d/D/s/S/x/X."<BR>
Bruce says, ".. instead of calling the parse-exponent() exit function"<BR>
igor says, "Doh."<BR>
Bruce says, "... then, it fails to move to the next character of the exponent, so on say 1.2e57 you get 1.2e55555555555555555555555..."<BR>
Bruce says, "other than that it works great!"<BR>
igor says, "Oh, rapture..."<BR>
igor says, "Does d2c actually use that code?"<BR>
Bruce not sure if he want's the answer to be "yes" or "no"<BR>
Bruce thnks both are equally bad<BR>
Bruce says, "the effect was that exponents were ignored, but it otherwise worked"<BR>
igor nods.<BR>
Bruce says, "just tried a test program that does 'format-out("%=", 3.12345678901234567e30)"<BR>
igor nods.<BR>
Bruce says, "it prints with an exponent of zero.  So, yes, d2c *does* use that function"<BR>
igor bangs is head against something hard.<BR>
igor says, "er his."<BR>
Bruce says, "oh well, the fixed version is back in the d2c cvs now..."<BR>
igor says, "Yay!  Participate in programming contests!  Fix compiler bugs!"<BR>
Bruce shares a URL...<BR>
  <<A HREF="http://www.ccc.de/cgi-bin/cvsweb/gd/src/d2c/compiler/parser/lexer.dylan.diff?r1=1.6&r2=1.7" TARGET="_blank">http://www.ccc.de/cgi-bin/cvsweb/gd/src/d2c/compiler/parser/lexer.dylan.diff?r1=1.6&r2=1.7</A>>.<BR>
igor says, "Is there a better way to write bytes than this:"<BR>
-----------------------------------igor------------------------------------<BR>
  format(ppm.file-handle, "%=%=%=", as(<character>, r),<BR>
 as(<character>, g), as(<character>, b));<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "shouldn't those be <byte-character> ?"<BR>
Bruce says, "other than that, what happens when you have non-printable chars?"<BR>
igor says, "Ah, OK..."<BR>
igor adjusts it.<BR>
Bruce says, "you'd be better off not going throught that %= dispatch stuff, too"<BR>
igor says, "What would be better?"<BR>
Bruce says, "well, looking in print.dylan I see that deep internally it uses write-element(stream, char)"<BR>
Bruce says, "when it's writing strings it loops on that funciton, so it's about the lowest you can go"<BR>
igor says, "Is that exported?"<BR>
Bruce says, "other than that, you could just keep a string as a buffer and poke characters into that and eventually print the whole string"<BR>
Bruce says, "... would be just as fast wihtout digging down deep"<BR>
igor says, "But that won't let us do the "image-size-larger-than 64MB" trick..."<BR>
Bruce says, "yes it would if your string was maybe 1000 chars or something and you flushed it from tiem to time"<BR>
igor says, "True, I suppose..."<BR>
igor says, "We'll fix that up later, when it is our biggest bottleneck, K?"<BR>
-----------------------------------Bruce-----------------------------------<BR>
local foo(i :: <integer>)<BR>
  buf[pos] := as(<byte-character>, i);<BR>
  pos := pos + 1;<BR>
  if (pos = buf.length) format-out("%=", buf); pos := 0; end;<BR>
end;<BR>
foo(r); foo(g); foo(b);<BR>
---------------------------------finished----------------------------------<BR>
igor says, "I wonder if we'd have done better by translating the input file into POVray code, then invoking POVray..."<BR>
Bruce says, "is it on the list of software on the machine?"<BR>
igor imagines not...<BR>
igor says, "Nope.  We'd have to give 'em a statically linked POVray executable & stuff..."<BR>
igor says, "Is it even free software?"<BR>
Bruce says, "as in beer"<BR>
igor says, "Ah, OK."<BR>
igor scratches his head.<BR>
igor has a define method write-pixel(ppm :: <ppm-image>, color :: <color>)<BR>
igor says, "in ppm.dylan"<BR>
igor says, "In icfp2000.dylan, I call it, but it says there aren't any applicable methods..."<BR>
igor says, "ppm.dylan gives me a couple of warnings, but doesn't fail..."<BR>
igor woos as his 'meta' key mysteriously starts working again...<BR>
Bruce says, "ordering of the files in the .lid?"<BR>
igor says, "Nope.  Moron that I was I happily wrote:"<BR>
igor says, "write-pixel(<ppm-image>, color)"<BR>
Bruce says, "oops"<BR>
Bruce says, "that'll do it"<BR>
igor says, "(Since the 'make' above worked just fine, I didn't notice the problem)"<BR>
Bruce busy stealing the lexing state machine from d2c<BR>
Bruce mostly chopping out the extra stuff that we don't need<BR>
igor grins.<BR>
igor supposes that lexodus is nowhere near mature enough to try...<BR>
igor says, "It can barely lex *itself* let anything else..."<BR>
igor says, "Cool!  The PPM exporter works."<BR>
igor checks stuff in.<BR>
Bruce says, "define 'works'"<BR>
igor eeps at the scan-moray pattern.<BR>
Bruce says, "does it make xv happy?"<BR>
igor says, "It makes xview happy..."<BR>
igor says, "Well, try it yourself..."<BR>
igor says, "Oops... Missed one, update again."<BR>
Bruce says, "in a while -- I don't compile right now"<BR>
igor nods.<BR>
igor emails you the PPM.<BR>
igor says, "What's the background color here?  Black?"<BR>
Bruce says, "luuuverly"<BR>
Bruce says, "watcha mean?"<BR>
igor says, "What should the color of an empty image be?"<BR>
Bruce says, "if a ray doesn't hit anything?"<BR>
igor nods.<BR>
Bruce says, "black, I guess"<BR>
igor couldn't find anything in the TASK that stated otherwise...<BR>
Bruce says, "if the user wants sky or something then they should put a blue plane at the back, right?"<BR>
igor supposes that'd work, as the camera is fixed...<BR>
igor works on figuring out the initial rays to cast...<BR>
igor returns.<BR>
Bruce is off to dinner<BR>
igor nods.<BR>
Bruce says, "it's 2:30 now for you.  What's bedtime?"<BR>
Bruce will be here another six or seven hours<BR>
igor dunnos.  When I get tired.  I'm also keeping my g/f company, as she's pulling a cram session for her exam tomorrow...<BR>
Bruce AFK<BR>
You hear the bips of keyclick, the sliding of mice and the hum of computers in the distance as igor fades slowly out of view, heading towards them.<BR>
There are the light bips of keyclick and the sliding of mice as igor fades into view, shoving itself away from the console, which promptly fades away.<BR>
igor glances nervously at the clock.<BR>
igor glances nervously at the clock.<BR>
Bruce returns<BR>
igor says, "Yo."<BR>
igor sighs at andreas' copy & paste error...<BR>
Bruce ready for another session, after food and shower<BR>
igor says, "define method \+ (v1 :: <vector>, v2 :: <vector>) was returning a <number> :-P"<BR>
Bruce says, "Andreas shold be around soon"<BR>
igor nods.<BR>
igor fixed it anyhow.<BR>
igor says, "whee!"<BR>
-----------------------------------igor------------------------------------<BR>
Expected an instance of {the class <function>}, but got #f<BR>
Aborted (core dumped)<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "can we trap those sorts of errors, if they happen on a production run?"<BR>
igor dunnos...<BR>
igor says, "That one was my own darned fault, though..."<BR>
igor says, "I make a local method, but didn't return it."<BR>
igor says, "Is there an 'infinity' symbol I can use?"<BR>
Bruce says, "for what?"<BR>
Bruce says, "you man someting in the charset?"<BR>
igor says, "No..."<BR>
Bruce says, "or you mean like max_real"<BR>
igor nods.<BR>
igor goes with $max_real...<BR>
igor says, "(or is it something else?)"<BR>
Bruce says, "int or float?"<BR>
igor says, "double-float"<BR>
Bruce says, "there's $minimum-integer and $maximum-integer"<BR>
Bruce says, "just use 1e38 or something for infinity"<BR>
Bruce says, "you'll need to rebuild the compiler though :-)"<BR>
igor uses 1.0/0.0 :-)<BR>
Bruce says, "that'll work"<BR>
igor wonders if all the ray-intersection code should go in a new file...<BR>
igor whees as he figures out how to do the ray-intersection stuff cleanly...<BR>
igor says, "'course the math sucks..."<BR>
igor glances nervously at the clock.<BR>
Bruce says, "it'll still be here in the morning..."<BR>
igor grins.<BR>
igor is going to ignore the math for now...<BR>
Bruce says, "coming up for the 15% mark..."<BR>
igor says, "The general idea is that you want the closest intersection of a ray with an object."<BR>
igor says, "But there are all these xformation matrices lying around."<BR>
igor says, "So, transform the ray into your own coordinates, then figure it out..."<BR>
igor glances nervously at the clock.<BR>
igor glances nervously at the clock.<BR>
igor checks everything in.<BR>
none [Guest] has connected.<BR>
igor says, "Hello."<BR>
Bruce says, "hello guest"<BR>
You hear a quiet popping sound; Karl-Heinz_Guest has disconnected.<BR>
igor says, "Oh well..."<BR>
Bruce thinks '12 hours down, 60 to go...'<BR>
igor grins.<BR>
igor says, "Hmm... We've gone from seeing no sphere to only seeing spheres... :-P"<BR>
igor says, "Yes!!!"<BR>
A small swarm of 3x5 index cards arrives, engulfs igor, and carries it away.<BR>
A small swarm of 3x5 index cards blows in and disperses, revealing igor.<BR>
igor pokepokepokepokepokes Bruce.<BR>
Bruce says, "hello"<BR>
igor says, "Success!"<BR>
Bruce says, "yippie!"<BR>
igor says, "I can render spheres."<BR>
igor says, "I can save them as PPMs, too."<BR>
Bruce is about *this* far away from parsing input files...<BR>
igor says, "Cool!"<BR>
igor says, "Right now, I can render spheres anywhere on the screen, although they are not lit at all, yet."<BR>
Bruce says, "if you want to poke me, email me.  there's no beeper or anyting on the MOO, so once the screen saver clicks in I don't see a thing"<BR>
igor nods.<BR>
igor says, "Anyhow, I'm gonna try to catch a bit of sleep now that this works."<BR>
Bruce says, "good plan"<BR>
Bruce winders where Andreas is<BR>
Bruce says, "it should be 1 PM there now"<BR>
Bruce says, "silly question, but if they're not lit, how do they get rendered?"<BR>
igor says, "It sets every ray that hits something to white, any everything else to black."<BR>
Bruce says, "ah.  more like rendering curcles, then ;-)"<BR>
Bruce says, "gawd ... this lexer is up to just over 500 lines."<BR>
Bruce says, "i wish to hell we had an automatic generator :-("<BR>
Bruce pings<BR>
andreas has connected.<BR>
andreas says, "hi"<BR>
igor says, "Good morning."<BR>
andreas has breakfast right now.<BR>
andreas says, "I see we have a lexer and a minimal raytracer?"<BR>
igor nods.<BR>
igor will be going back to sleep very soon now.<BR>
andreas says, "Ok, I try to pick up where you left and add some lighting."<BR>
igor nods.  First step is to write some dedicated Quaternion stuff.<BR>
igor says, "Whereever I've put XXX, I've done something stupid & short-cut-ish in the code."<BR>
igor says, "Also, it looks like the translations might be backwards, as (0, 0.25, 0) moves it downwards."<BR>
andreas doesn't grok quaternions.<BR>
igor says, "The problem is we're using 4-dimensional vectors all over the place, but things like 'A - B' produce the Wrong Thing..."<BR>
igor says, "if A = (1, 0, 0, 1) and B = (0, 1, 0, 1), A-B should = (1, -1, 0, 1), not (1, -1, 0, 0)"<BR>
andreas says, "I see. That's fixable."<BR>
igor says, "Basically, for all operations, homogenize first, then perform them on the first three elements."<BR>
Bruce says, "hello!"<BR>
igor says, "There are a bunch of hacks in there to deal with this problem that'd work much better with a <quaternion> class or something."<BR>
andreas says, "hi bruce"<BR>
igor says, "Is the mailing-list working?  I'm getting no CVS messages, and the messages sent to icfp2000@gwydiondylan.org don't seem to get back to me."<BR>
Bruce says, "me too"<BR>
Bruce says, ".. and the same for gd-hackers"<BR>
andreas says, "sec, I'll check..."<BR>
Bruce says, "lexer is currently lexing correctly, and parsing numbers into the right thing.  The output isn't sensible yet, though ... just debugging for now."<BR>
igor nods.<BR>
Bruce says, "it's also pretty hacky and untidy. I'll fix in the morning"<BR>
Bruce going to go to bed shortly too<BR>
igor nods.<BR>
igor lobs the torch in Andreas' general direction.<BR>
andreas catches the torch.<BR>
Bruce says, "tag team programming .. and Andreas is about to get the tag"<BR>
igor woohoos.  371 / 495 lines of the code in CVS were last touched by me...<BR>
Bruce says, "check again in a couple of minutes..."<BR>
igor grins.<BR>
andreas says, "ah, full disk on the server..."<BR>
igor says, "That'd do it..."<BR>
igor [to andreas]: Perhaps it would be best for you to devote yourself to the interpreter, since that<BR>
igor says, "seems to be the most lacking area, ATM."<BR>
Bruce says, "OK .. do a cvs update now"<BR>
andreas says, "Ok, I see what I can do."<BR>
igor says, "The lexer is apparently mostly done, and the ray-tracing engine is under control."<BR>
igor glances nervously at the clock.<BR>
Bruce says, "ummm ... there isn't much interpreter there at the moment, but I've got it planned out in my head and know how I'm going to do it"<BR>
igor [to Bruce]: Can you 'dump' it to andreas?<BR>
Bruce says, "not before I go to sleep tonight"<BR>
igor nods.<BR>
igor says, "Hmm...  In that case, perhaps more work on the ray-tracer is in order, then..."<BR>
Bruce says, "the interpreter will be working by this time tomorrow"<BR>
Bruce says, "I'd expect that getting recursive ray-tracing and the various shapes and CSg and stuff going is by far the rate limiting factor"<BR>
igor says, "The CSG is going to be annoying, yes..."<BR>
igor says, "We need more intersection algorithms..."<BR>
andreas says, "I suggest we concentrate on tier 1 first."<BR>
Bruce says, "anyway, my stuff is in now .. do an update and do a 'make test'"<BR>
igor says, "The sphere-intersection-thingy, ATM, does not actually calculate the position of intersection, just whether or not there is one."<BR>
igor says, "This is actually useful code, as we need it for bounding-spheres..."<BR>
andreas says, "BTW, our matrices are slow. But that's a thing to fix when everything else works."<BR>
igor nods.<BR>
igor says, "Even the depth = 1 raytracer with no lighting is kinda slow right now."<BR>
Bruce says, "yeah, it takes 21 seconds on my system"<BR>
igor says, "And that's just for a 128x128 image."<BR>
andreas says, "Getting the materials from an interpreter callback makes things interesting."<BR>
Bruce says, "Gabor is asking for something to do..."<BR>
andreas says, "Cool!"<BR>
igor [to andreas]: And that's why the interpreter has to be fast...<BR>
Bruce says, "you guys might want to watch out ... the program currently expects to read stuff from stdin .. so if you don't provide any then it just sits there and waits..."<BR>
andreas says, "noticed that..."<BR>
igor says, "Anyhow, the big idea behind the ray tracer is that rays get transformed into the coordinate-space of the object at each stage."<BR>
igor says, "So, by the time we get around to hit-testing against a primitive, it's always against a unit-object located at the origin..."<BR>
igor says, "The, if we hit something, we transform it back out level-by-level until we get to world coordinates."<BR>
andreas says, "See. The matrix we accumulate at the moment transforms object coordinates to world coordinates. Do you have any code to generate the inverse matrix yet?"<BR>
igor says, "Yep.  Check out obj.dylan"<BR>
andreas says, "This could explain your translation in the wrong direction problem, if not."<BR>
igor says, "suspects left-hand/right-hand coordinate system confusion in the translation issue..."<BR>
igor says, "The scaling factor work fine."<BR>
igor says, "(I can't really tell about rotation, as it's a sphere...)"<BR>
andreas says, "ah, ok. I see."<BR>
Bruce says, "in case anyone is wondering, lexer.dylan is 543 lines out of a total of 1010 in the project at the moment.   I didn't have the time to make it shorter yet..."<BR>
igor says, "Anyhow, intersect-before() is the Big Function for hit-testing."<BR>
igor says, "Dispatch on the first arg for the type of object to test against, then you get pos & ray as vectors in your own coordinate space, and 'distance' which is the distance between the ray's origin and the closest intersection thus far."<BR>
igor says, "It starts at 1.0/0.0, and should be adjusted for each hit found."<BR>
igor says, "The idea is to reduce the surface-evaluation to a bare minimum."<BR>
igor says, "Anyhow, I'll be around in 4-8 hours..."<BR>
igor says, "In the event that you get horribly stuck, email knothead@dartmouth.edu, my g/f and get her to wake me up..."<BR>
Bruce says, "yeah and ditto goes for SMSing me."<BR>
andreas says, "Ok, I see what I can do."<BR>
andreas mediates about converting coordinate spaces back and forth...<BR>
andreas says, "igor: I assume pos is the origin of the ray, and ray it's direction?"<BR>
Bruce is outta here<BR>
andreas says, "good sleep you two..."<BR>
igor nods to andreas.  Exactly.<BR>
igor says, "Both have to be transformed into the next coordinate space in order to have rays work correctly."<BR>
You hear a quiet popping sound; andreas has disconnected.<BR>
andreas has connected.<BR>
igor waves.<BR>
andreas waves back.<BR>
igor says, "How's it going?"<BR>
andreas says, "I haven't written much code yet, but the math knowledge is coming back."<BR>
igor grins.  Cool, cool.<BR>
andreas says, "In representation with a vector of size four, there's a difference between points and vectors."<BR>
igor says, "Did you notice any egregious errors on my part?"<BR>
igor nods.<BR>
andreas says, "vectors have a last element of 0.0, so the vector math works without any special code."<BR>
igor says, "hmm?  No, the last element is typically 1.0..."<BR>
andreas says, "I rewrote your code, but it's still broken, so I won't check it in. Give me half an hour."<BR>
andreas says, "no, the last element is 1.0 for points."<BR>
igor hmms.  OK...<BR>
andreas says, "or any other value except 0.0."<BR>
andreas says, "So the difference between two points is automatically a vector."<BR>
igor says, "Oh, OK..."<BR>
igor was treating all points a vectors, in his code...<BR>
andreas says, "Yes, I'm going through this. Everywhere you have XXX it will magically work..."<BR>
igor says, "That's good..."<BR>
igor says, "Well, the XXX stuff worked, I just had fudge factors in there..."<BR>
andreas says, "Yes, I know ;)."<BR>
andreas says, "I'm just fighting Dylan itself... my initialize method doesn't get called."<BR>
igor says, "Doh..."<BR>
igor says, "Do we have floating-point <simple-object-vectors> ATM, or should we hit Eric up for some?"<BR>
andreas says, "I have no idea, ask Eric. I would appreciate a matrix where the compiler knows that there are only doubles stored, and the size is 4x4."<BR>
andreas says, "Would make us faster by an order of magnitude."<BR>
----------------------------------andreas----------------------------------<BR>
define class <ray> (<object>)<BR>
  slot ray-position;<BR>
  slot ray-direction;<BR>
end class <ray>;<BR>
<BR>
define method initialize(ray :: <ray>, #next next-method, #key position: pos, direction: dir, #all-keys)<BR>
 => ()<BR>
  format-out("Ray generated\n");<BR>
  ray.ray-position = homogenize(pos);<BR>
  ray.ray-direction = normalize(dir);<BR>
end method initialize;<BR>
---------------------------------finished----------------------------------<BR>
andreas says, "What am I doing wrong? initialize doesn't get called..."<BR>
andreas says, "Oh, I see it: = instead of :="<BR>
andreas says, "I also found out why the sphere moved to the wrong direction: y is going upwards in our world, and downwards in adressing the pixmap."<BR>
igor says, "Oh!  (Duh!)  I was just drawing it upside down :-P"<BR>
igor says, "Yeah, my code was starting to get a wee bit messy by about 7:00 EDT or so."<BR>
igor says, "I wanted to get the damn white-circle-in-black-background working, though, so as to make it clear what all my code was doing, and what it was for..."<BR>
igor says, "I got to the point that each modification I made alternated it between "Sphere?  What sphere?" (black image) and "Sphere EVERYWHERE!!!" (white image)"<BR>
igor emailed Eric enquiring about faster matrices...<BR>
andreas says, "I am at this point too. WOuld you mind if I check in the broken version and we go over it together?"<BR>
igor says, "Sure."<BR>
igor says, "The debugging trick that worked well was to put the sphere in the middle, then cast two rays, one into the middle, then one to the upper-left."<BR>
andreas says, "Ok, I've comitted."<BR>
igor says, "Then, instrument the rest of the code to figure out what went wrong..."<BR>
igor updates<BR>
igor says, "Useful matrix fixes..."<BR>
andreas says, "Not all were useful, I just noticed. \+ doesn't need homogenization, because you can only add vectors, and they have a last element of zero."<BR>
andreas says, "On the other hand, \- *does* need it, because it only makes sense for points, and returns a vector."<BR>
igor nods.<BR>
igor says, "Well, it's also useful for two vectors..."<BR>
igor says, "Hmm...  Perhaps you ought to check in homogenize() that v[v.size - 1] != 0.0..."<BR>
andreas says, "Checking for != 0.0 doesn't work very well for floats."<BR>
igor shrugs.  Anyhow...<BR>
igor adds some instrumentation code back in...<BR>
igor says, "The ray-direction really, really wants to be a unit vector in all this stuff, BTW..."<BR>
andreas says, "It gets normalized in the init of <ray>"<BR>
igor says, "OK, but what about when it gets transformed?"<BR>
andreas says, "A new ray is created then. See transform-with-matrix"<BR>
igor says, "OK..."<BR>
igor says, "And your math in intersection-before(m :: <sphere> is messed up..."<BR>
-----------------------------------igor------------------------------------<BR>
  let t_ca = -ray.ray-position * ray.ray-direction;<BR>
  let l_oc_2 = ray.ray-direction * ray.ray-position;<BR>
---------------------------------finished----------------------------------<BR>
andreas says, "yes, i've just seen that."<BR>
andreas says, "second line is broken."<BR>
igor says, "Exactly..."<BR>
igor tries it again.<BR>
igor says, "Appears to be working now..."<BR>
igor tries a full rendering...<BR>
igor says, "  let l_oc_2 = ray.ray-position * ray.ray-position;"<BR>
andreas says, "yes"<BR>
igor says, "Hmm... Still messed up somewhere, though..."<BR>
igor says, "Now I get a black image with a single pixel at the origin lit :-P"<BR>
andreas says, "I see a single white pixel..."<BR>
igor sees the problem.<BR>
igor says, "ray.ray-position is a point, but were taking the dot-product of two of them."<BR>
andreas says, "ah, so this should be"<BR>
----------------------------------andreas----------------------------------<BR>
let foo = ray.ray-position - $origin;<BR>
let l_oc_2 * foo * foo;<BR>
---------------------------------finished----------------------------------<BR>
igor says, "Exactly."<BR>
igor says, "s/*/=/2"<BR>
andreas says, "Hey, we have a sphere again! Still upside-down, though. I'm comitting."<BR>
igor fixes the upside-down problem...<BR>
andreas says, "BTW: I think we should put all surface parameters in an object, and return a function that returns a surface object."<BR>
igor notes that andreas commented out the pretty sickly-yellow test PPM...<BR>
andreas says, "That way we can call the interpreter lazily, and win when casting shadow-rays."<BR>
igor nods.  We may also be able to win by an option to simply return 'does this ray hit?' instead of computing the full point/normal/surface for casting shadow-rays...<BR>
andreas nods.<BR>
igor says, "And, yes, making a surface object that has all the info to call the appropriate surface function canned so that we don't call more than one is a good idea."<BR>
igor says, "How do you do upside-down for-loops?"<BR>
igor says, "for (y from height above 0)"<BR>
igor says, "Do I have to say 'by -1' or something?"<BR>
andreas says, "by -1 will work."<BR>
igor says, "Not that gd runs fast enough to do so, but because we don't have a frame-buffer, we are limited by HD-space, not memory size, BTW :-)"<BR>
igor doesn't think that your <surface> class contains anything resembling the information we want...<BR>
andreas says, "No, that's just the raw data. The intersection-before will return a closure that returns this object. The closure will care about caching."<BR>
igor says, "Perhaps the closure should give us simply a <color> object..."<BR>
andreas says, "No, we need the other parameters as well."<BR>
andreas says, "Can you care about the math in intersection-before? I don't feel so secure with that at the moment."<BR>
igor nods.<BR>
andreas says, "We also need calculation of texture coordinates, btw."<BR>
igor nods.<BR>
andreas says, "I'll implement the color closures meanwhile."<BR>
igor says, "Why don't we have a closure that says "give me your final color given that your normal is this, the ray's coming from here, and you're being lit by these lights"?"<BR>
andreas says, "well, I'm just abstracting the entry into the interpreter here. The contents of <surface> is what the surface function of the GML program returns."<BR>
igor nods.  But we don't need to make one of those until we invoke the interpreter...<BR>
andreas says, "Yes, and we will invoke the interpreter from within the closure, when it is accessed the first time. This way we don't invoke the interpreter unless needed."<BR>
igor says, "OK, good, good."<BR>
andreas goes coding...<BR>
igor says, "I'd like, BTW, to have a keyword arg, shadow-test: (#t or #f) which simply decides whether or not it intersects, and doesn't calculate where or what color or anything."<BR>
andreas says, "ok."<BR>
igor says, "So, the intersect-before function would simply return #f or #t for a shadow function..."<BR>
[igor ]<BR>
igor <- fixing his keyboard...<BR>
igor says, "Better...  My back-space key got stuck..."<BR>
igor says, "And intersect-before for the full color-query will return a point, a normal, and a closure?"<BR>
andreas says, "Right. I'm done with the closure stuff, and checked it it."<BR>
igor says, "Cool."<BR>
igor <- working on planes.<BR>
You hear a quiet popping sound; andreas has disconnected.<BR>
andreas has connected.<BR>
igor hmms.<BR>
igor says, "Is it desirable to have a 'canonical red sphere'?"<BR>
igor says, "(one per surface function)"<BR>
andreas says, "No, I don't think so."<BR>
igor wonders when Gabor will be checking in...<BR>
andreas says, "Do you have feedback that gabor is actually working on something?"<BR>
igor says, "He seems to think he is..."<BR>
igor says, "(working on the interpreter, that is)"<BR>
igor woos.  Planes seem to (sort of) work...<BR>
andreas says, "Do you have an intersection point as well?"<BR>
igor nods.<BR>
igor hasn't done texture coords, though.<BR>
igor says, "It is, however, a kind of dirty yellow..."<BR>
igor is going to take a nap now...<BR>
andreas says, "Ok, I'll be playing with this and try to get texture coordinates working."<BR>
igor nods.<BR>
andreas says, "Did you check in the planes?"<BR>
Bruce pops in<BR>
You hear a quiet popping sound; andreas has disconnected.<BR>
andreas has connected.<BR>
Bruce says, "hello"<BR>
andreas says, "Hi Bruce!"<BR>
Bruce says, "did Gabor's stuff get check in?"<BR>
andreas says, "Didn't see anything yet."<BR>
Bruce says, "he says he doesn'thave cvs access.  But there were attachments to his email"<BR>
andreas says, "You want to cvs update; make test now..."<BR>
Bruce says, "just did .. 30 seconds ago"<BR>
andreas says, "I comitted 15 seconds ago :)"<BR>
Bruce says, "drat"<BR>
Bruce doing it again<BR>
Bruce says, "interesting picture.  What is it?"<BR>
andreas says, "It's a plane with a texture."<BR>
andreas says, "I have callbacks in place where you can directly call the interpreter to evaluate the surface closure."<BR>
You hear a quiet popping sound; igor has disconnected.<BR>
andreas says, "It's even lazy and calls the interpreter only once, and only when needed."<BR>
Bruce says, "wat I see looks like a low wall, green on left, yellow on right, reflecting off the floor, and a thin red thing on top of the left part"<BR>
andreas says, "The red line is a bug. It's when the ray is parallel to the surface. I guess there pops a NaN up somewhere, and we don't cope too well with that""<BR>
igor has connected.<BR>
igor growls.<BR>
igor's Xserver is very sick, ATM.<BR>
igor says, "xview is the only image viewer that doesn't crash it, as opposed to 'display' which does quite promptly..."<BR>
andreas says, "sorry for that one."<BR>
igor says, "Oh well...  You couldn't have known..."<BR>
Bruce says, "ok, so I'm going to take a look at what Gabor sent in email"<BR>
Bruce unpacks it, ftp's to the linux box...<BR>
andreas says, "igor: we have a problem with rays parallel to the surface. See the red line in the image?"<BR>
igor nods.<BR>
andreas says, "That shouldn't be there. One of the coordinates seems to be not a number."<BR>
igor hmms.  If the ray-direction's y coord is 0, then t is NaN<BR>
Bruce tries the factorial 12 example on Gabor's interpreter<BR>
-----------------------------------Bruce-----------------------------------<BR>
/test-compiler<BR>
input : #('{', '/', #"self", '/', #"n", #"n", 2, #"lessi", '{', 1, '}', '{', #"n", 1, #"subi", #"self", #"self", #"apply", #"n", #"muli", '}', #"if", '}', '/', #"fact", 12, #"fact", #"fact", #"apply")<BR>
output: #(479001600)<BR>
---------------------------------finished----------------------------------<BR>
andreas says, "This rocks!"<BR>
Bruce says, "The man did *good*!"<BR>
andreas says, "I can see us reaching the goal."<BR>
Bruce says, "Now I just have to interface this to my lexer and we're ready to rock and roll!"<BR>
Bruce says, "I'm going to try a speed test.  fib(20) or ackerman's function or something..."<BR>
andreas [to igor]: does x-rotate rotate clockwise or counter-clockwise?<BR>
-----------------------------------Bruce-----------------------------------<BR>
OK, so running this...<BR>
OK, so running this...<BR>
<BR>
{ /self /body /n<BR>
   n 0 eqi<BR>
   { }<BR>
   { body apply<BR>
      n 1 subi body self self apply<BR>
   }<BR>
   if<BR>
} /repeat<BR>
<BR>
0<BR>
1000 {<BR>
  1000 {<BR>
    /n n 1 addi<BR>
  } repeat repeat apply<BR>
} repeat repeat apply<BR>
<BR>
.. the program gets up to 13 MB used and takes 34 seconds.<BR>
<BR>
That's around 28,000 iterations per second, or 500,000 primitive operations per second.<BR>
---------------------------------finished----------------------------------<BR>
andreas says, "Wow. I would say this is fast."<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 test-compiler]$ time ./test-compiler<BR>
input : #('{', '/', #"self", '/', #"body", '/', #"n", #"n", 0, #"eqi", '{', '}', '{', #"body", #"apply", #"n", 1, #"subi", #"body", #"self", #"self", #"apply", '}', #"if", '}', '/', #"repeat", 0, 1000, '{', 1000, '{', '/', #"n", #"n", 1, #"addi", '}', #"repeat", #"repeat", #"apply", '}', #"repeat", #"repeat", #"apply")<BR>
output: #(1000000)<BR>
31.38user 0.09system 0:34.55elapsed 91%CPU (0avgtext+0avgdata 0maxresident)k<BR>
0inputs+0outputs (303major+3167minor)pagefaults 0swaps<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "this is of course with no optimization at all, and the interpreter is CONSing like crazy.  It can be made faster, if necessary"<BR>
Bruce says, "hmmm.  Making the inner loop body empty reduces it by 3 seconds"<BR>
Bruce says, "so, it's the recursion of the looping that is using the time"<BR>
Bruce says, "1,000,000 executions of '/n n 1 addi' is taking 3 seconds, so each execution is 3 uS or 2100 clock cycles"<BR>
Bruce says, "the chances are that the pattern callback functions won't have recursion, but just simple conditional code.  They might blow out to 100 uS or so, but your ray tracing is already taking more than 1 mS per pixel anyway."<BR>
andreas says, "That should be fast enough."<BR>
Bruce thinks so<BR>
Bruce says, "OK, I'm going to have breakfast, then interface this to the lexer.  Shoudl be done around 24:00 UTC (20:00 EDT)"<BR>
andreas says, "Way cool. 24 hours after start, and the language will work."<BR>
Bruce says, "umm ... *now* is 24 hours after the start.  But close enough :-)"<BR>
andreas says, "oh, times passes..."<BR>
Bruce absent for breakfast with ever-patient GF<BR>
jon.dyte [Guest] has connected.<BR>
andreas says, "Hi, nice to see you."<BR>
jon.dyte [Guest] says, ""hello""<BR>
jon.dyte [Guest] goes south.<BR>
jon.dyte [Guest] has arrived.<BR>
jon.dyte [Guest] says, ""hello""<BR>
jon.dyte [Guest] goes south.<BR>
jon.dyte [Guest] has arrived.<BR>
You hear a quiet popping sound; Karl-Heinz_Guest has disconnected.<BR>
jon.dyte [Guest] has connected.<BR>
jon.dyte [Guest] goes south.<BR>
jon.dyte [Guest] has arrived.<BR>
You hear a quiet popping sound; Karl-Heinz_Guest has disconnected.<BR>
Bruce back on deck<BR>
igor deidles.<BR>
igor says, "Excellent news about the interpretter..."<BR>
igor hmms...  Perhaps we can perform some "run-time code analysis" by figuring out the minimum number of instructions needed to return a constant surface, then counting the instructions used by the surface function, and, if it's the minimum number, jumping to the conclusion that it is a constant surface?<BR>
igor glances nervously at the clock.<BR>
Bruce says, "I think a constant surface function will be way faster than the rest of the ray tracer *anyway* -- just a few microseconds."<BR>
igor says, "Probably true..."<BR>
igor may have gotten surface coordinates and correct intersection points on spheres working...<BR>
Bruce says, "how do you feel you and Andreas are doing?"<BR>
igor can't tell, tho...<BR>
Bruce says, "got enough time available?"<BR>
igor nods.  We're not even at the half-way mark yet, and we're doing pretty well.   I have all night tonight to work on this now.<BR>
Bruce says, "when did you find time to sleep?"<BR>
igor says, "Between about 3pm and 7:30pm, as well a couple hours here and there earlier..."<BR>
andreas says, "hi igor..."<BR>
Bruce says, "OK, so I'm just thinking what to do next..."<BR>
andreas says, "we have working textures in planes, rudimentary csg-unions, and working translations"<BR>
igor waves to andreas.<BR>
igor says, "I got sphere-intersection-points (maybe) working now..."<BR>
Bruce says, "I just dropped behind my own schedule because a had to meet with a real-estate agent about my house (which is for sale) fo the last hour or so :-("<BR>
igor nods.<BR>
andreas says, "and i'm going to bed now."<BR>
andreas waves.<BR>
Bruce says, "OK, g'night!"<BR>
igor says, "Unfortunately, the current surface for the sphere is black, as is the background, so I had to change it to make-white() to get something useful out of it..."<BR>
You hear a quiet popping sound; andreas has disconnected.<BR>
Bruce says, "make it a nice shade of red of something..."<BR>
igor plans to spend this evening mainly working on lighting and reflection...<BR>
igor says, "How much time do you have this evening, then?"<BR>
Bruce says, "the lexer and interpreter are working, but a) the lexer is uglier than I'd have liked, and b) they aren't bullet-proof against malicious input."<BR>
Bruce says, "me?  I'm free nearly 100% for the next 12 hours"<BR>
igor nods.  Cool...<BR>
Bruce says, "I need to g out and pay an overdue power bill to ensure the computer keeps going, but onther than that ...."<BR>
igor <- gonna go cook dinner now, be back in ~30 minutes.<BR>
Bruce says, "ciao"<BR>
igor returns.<BR>
igor says, "Not that we actually, like, cooked or anything..."<BR>
Bruce says, "I see.   ummm .. did you eat?"<BR>
igor says, "Not yet, but we did buy the necessary food, then decided that we weren't terribly hungry yet..."<BR>
igor says, "Fortunately, broiled chicken is exceptionally easy to make..."<BR>
Bruce says, " oh I don't know ... you should see what I'm planning to have for lunch"<BR>
igor grins.<BR>
igor . o O ( Mmm...  Doritos and Mountain Dew: Breakfast of Champions )<BR>
Bruce says, "tuna in thai green curry, on rice."<BR>
igor grins.<BR>
Bruce says, "rice: throw in rice maker, with water.  Open can of tuna in thai green curry, empty on top of cooked rice."<BR>
igor starts on the lighting work...<BR>
Bruce says, "cool"<BR>
igor says, "OK, ambient lighting works..."<BR>
Bruce says, "so, what's working now?  "<BR>
igor right now you're still limited to rendering one object at a time.<BR>
Bruce says, "how about geometry?  You can find the closest intersecting object for arbitraryly-complex scenes?"<BR>
igor says, "These objects, however can be transformed any which way..."<BR>
igor says, "Nope, I'm going to be working on that as soon as I get basic lighting worked out."<BR>
Bruce says, "oh. ok"<BR>
Bruce says, "obviously, you could just do an intersection test with every object in the scene, put them in a list, sort, and choose the closest one.  That'd work, but wouldn't be efficient"<BR>
Bruce says, "I hope no one's trying to do this in Perl this year"<BR>
igor eeps.<BR>
igor BTW, does have some preliminary 3D rendering verbs in MOOcode...<BR>
igor wonders if some OpenGL hacker will try to come up with identical output not using ray-tracing...<BR>
Bruce says, "what's MOOcode like?"<BR>
igor [to Bruce]: @list #178:description for a quick example...<BR>
Bruce hmmms.  A bit like JavaScript?<BR>
igor doesn't use Javascript...<BR>
igor says, "MOOcode, however, is a surprisingly complete language..."<BR>
Bruce says, "so, who's going to beat us?"<BR>
igor says, "A C hacker, if anyone, or somebody who rewrites POVray..."<BR>
Bruce says, "It would take a C++ god to do this in the time allowed, but it migth be fast when finished"<BR>
Bruce says, "The Lisp and Haskell and ML guys will beat us on the parser and compiler, but lose, I think, on the renderer."<BR>
Bruce says, "hopefully we can profile and tweak our speed towars the end..."<BR>
igor nods.<BR>
Bruce says, "... thus gaining the best of both worlds"<BR>
Bruce is afraid of someone hacking POVray as well.  Does it have procedural textures?  In what language?<BR>
igor says, "It has its own language, so someone could write a translator..."<BR>
igor says, "GMP => POVray, then invoke POVray."<BR>
Bruce says, "is it a full language?"<BR>
igor says, "Then again, POVray is a bit more general-purpose than this renderer, so we might still have a chance speed-wise"<BR>
igor says, "More or less..."<BR>
Bruce says, "POVray has been banged on speed-wise for nearly a decade"<BR>
igor says, "If you are used to it, you can do some pretty amazing things."<BR>
igor says, "Anyhow, getting a correct program might be difficult with that..."<BR>
Bruce wonders if he should go and have a look at it as an insurance policy once we have ours limping<BR>
igor says, "And I don't know how easy it is to manipulate already-build objects..."<BR>
igor says, "POVray's programming language is really designed to simply drop objects into the scene..."<BR>
Bruce says, "the way to do i would be an Acrobat Distiller-like thing"<BR>
Bruce says, "run our interpreter and have the graphics primitives just emit straight-line code"<BR>
igor nods.<BR>
igor shrugs.  If we lose, we lose, and we get a real-world app other than the compiler to optimize for...<BR>
Bruce says, "PostScript is a turing-power language.  PDF is just a list of drawing primitives"<BR>
igor says, "(And since I want to use Dylan to write OpenGL code, eventually...)"<BR>
igor says, "Besides, we'll still win the Judges prize guaranteed if someone else wins via POVray..."<BR>
igor says, "(And that means I still get to go to the conference :-)..."<BR>
Bruce grins<BR>
Bruce is a bit far away to go to the conference .. I don't think they'll pay for air tickets<BR>
Bruce says, "yeeeha!  You can now run the program as an interactive interpreter!"<BR>
Bruce says, "whatever you type on stdin is lexed, parsed, and executed"<BR>
igor says, "Cool!"<BR>
igor says, "Are you a student, though?"<BR>
Bruce says, "no"<BR>
Bruce says, "I'm not convinced that the use of the term "student" in their isn't an oversight"<BR>
Bruce says, "er, "in their web page"<BR>
-----------------------------------igor------------------------------------<BR>
We especially encourage students to enter the contest.<BR>
(We even have special prizes reserved for possible student winners; see below.)<BR>
---------------------------------finished----------------------------------<BR>
igor says, "From the Team Composition section."<BR>
igor says, "Anyhow, the NZ->CA airfare is probably prohibitive anyhow..."<BR>
igor calls the 'infinite directional light' class <star>...<BR>
Bruce says, "it's not *that* bad -- about $900 most of the time"<BR>
igor nods.<BR>
Bruce says, "umm .. that's for CA the state or west coast CA such as Vancouver.  East coast is maybe $200 more return."<BR>
igor nods.<BR>
igor says, "Montreal is definitely East coast..."<BR>
Bruce says, "later this week I'm hoping to be made an offer to work in the US (Chicago)"<BR>
igor says, "Woo."<BR>
Bruce says, "I've been happy as a contractor for a few years, but feel it might be time to get a job for a year or two ... and if I'm going to do that then I may as well go where the money is good"<BR>
Bruce says, "... er, I mean where there are greter challenges and the chance to grow my career  (just in case prospective employersare listening :-)"<BR>
Bruce says, "do you want to try joining the interpreter and the renderer, or are you happier continuing to build your world models by hand for now?"<BR>
igor returns.<BR>
igor [used 25075 ticks, 0.069818 seconds]<BR>
Bruce wonders what<BR>
igor says, "Hmm?"<BR>
Bruce says, "igor [used 25075 ticks, 0.069818 seconds]"<BR>
igor says, "Oh.  Sorry...  I right-clicked accidently, thus pasting a mess of stuff into this window."<BR>
igor says, "er, middle-clicked"<BR>
Bruce says, "do you want to try joining the interpreter and the renderer, or are you happier continuing to build your world models by hand for now"<BR>
igor says, "Every eval you issue on MOO Canada gives you the number of primitive instructions and the microseconds it took to execute..."<BR>
igor says, "Might as well..."<BR>
Bruce says, "how closely do your primitives follow the language specs?"<BR>
igor says, "BTW, we can probably use gimp or something to subtract one image from another to determine the differences..."<BR>
Bruce says, "probably.  If they're both in that format it wouldn't take much to write a little program to do it."<BR>
igor doesn't really know.  I used the language specs more of a guide to tell me what the functions would be used for...<BR>
Bruce says, "I'm going to print the latest copy of the specs and go sit ina corne with it for a while"<BR>
igor grins.<BR>
igor tags a bunch of the base classes as 'abstract' for performance and correctness...<BR>
You hear a quiet popping sound; Bruce has disconnected.<BR>
Bruce has connected.<BR>
igor waves.<BR>
Bruce says, "yo"<BR>
igor cleans up the bugs in his lighting code.<BR>
Bruce says, "good good good"<BR>
Bruce is wondering how much work to put into bullet-proofing the interpreter against invalid programs<BR>
igor says, "Well, can it wait?"<BR>
Bruce is confident that it's OK for well-forme programs already<BR>
Bruce says, "yes it can wait, if there's something more useful to do"<BR>
Bruce says, "do you need help with the ray tracer, or do you and Andreas habve it under control?"<BR>
igor says, "Making the primitives to allow the interpreter to drive the ray-tracer will be a good next step."<BR>
igor says, "I'll be back in a few minutes."<BR>
igor back.<BR>
Bruce says, "are you in a position to use the procedural textures now?"<BR>
igor says, "Sort of...  Andreas was worrying about that, so perhaps it'd be easier to coordinate that part with him."<BR>
Bruce nods<BR>
igor says, "I'd be all good with making only red objects for a bit, though..."<BR>
Bruce says, "ok, a hookup between interpreter and renderer is what I'll do next"<BR>
Bruce says, "have you done a cvs update recently?"<BR>
igor says, "Cool.  Tomorrow, I can prolly convince my g/f to help by writing test programs..."<BR>
igor says, "Reasonably recently, yeah..."<BR>
Bruce says, "does your version print the factorial program and results?"<BR>
igor nods.<BR>
Bruce says, "... and it reads it form ../examples/fatorial.gml?"<BR>
igor nods.<BR>
Bruce says, "OK"<BR>
Bruce says, "so this would work then..."<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 <BR>
3 4 lessi {"yes"}{"no"}if<BR>
lexed : #(3, 4, #"lessi", '{', "yes", '}', '{', "no", '}', #"if")<BR>
<BR>
output: #("yes")<BR>
---------------------------------finished----------------------------------<BR>
igor says, "Moment..."<BR>
-----------------------------------igor------------------------------------<BR>
secret-lab:~/src/ICFP2000/src$ ./icfp2000 <BR>
3 4 lessi {"yes"}{"no"}if<BR>
lexed : #(3, 4, #"lessi", '{', "yes", '}', '{', "no", '}', #"if")<BR>
<BR>
output: #("yes")<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "cool :-)"<BR>
igor appears to have diffuse lighting almost working...<BR>
igor wonders if all surfaces have two sides to them...<BR>
igor says, "Woohoo!"<BR>
igor says, "We have diffuse lighting :-)"<BR>
Bruce says, "woooo hoooo"<BR>
Bruce says, "try this n celebration"<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 <BR>
{/self /n /b /a a n 0 eqi {}{b b a addi n 1 subi self self apply}if}/fib<BR>
0 1 20 fib fib apply<BR>
---------------------------------finished----------------------------------<BR>
-----------------------------------igor------------------------------------<BR>
output: #(6765, 4181, 2584, 1597, 987, 610, 377, 233, 144, 89, 55, 34, 21, 13, 8, 5, 3, 2, 1, 1, 0, 6765, 4181, 2584, 1597, 987, 610, 377, 233, 144, 89, 55, 34, 21, 13, 8, 5, 3, 2, 1, 1, 0)<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "hmmm is thee an operator to convert int to fp?"<BR>
Bruce says, "yes -- 'real'"<BR>
Bruce says, "what do you think anout the range of integers?  We could use bignums, just for fun."<BR>
Bruce says, "Wouldn't even slow us down noticeably"<BR>
igor says, "Probably not...  Do we have a number class that automatically upgrades?"<BR>
Bruce says, "no -- just make *all* ints bignums"<BR>
igor dunnos.<BR>
Bruce says, "well, it's something we can turn on at the last minute, if it doens't affect the speed."<BR>
igor is fully checked-in.<BR>
igor says, "(almost, rather)"<BR>
Bruce says, "I'm runing your latest piccy now"<BR>
igor says, "Might want to try once more..."<BR>
igor says, "I forgot icfp2000.dylan..."<BR>
igor says, "We need to add Gabor to the credits..."<BR>
Bruce says, "yes we do"<BR>
igor says, "We should also add Eric, and possibly my girlfriend, as they are also in a position to cash in on the free conference trip..."<BR>
Bruce says, "O guess we just put everyone's names on every file"<BR>
Bruce says, "oooh"<BR>
Bruce says, "that's *much* faster than the previous version: 20s vs 1:20"<BR>
Bruce says, ".. or is it jst the smaller object?"<BR>
igor cut it down to a 128x128 PPM<BR>
Bruce says, "ah.  So, it's a red ball illuminated from above"<BR>
igor says, "With a bit of ambient light as well."<BR>
Bruce says, "right.  You can just see the bottom of the ball"<BR>
Bruce says, "actually, I thought I might be imnagining that, but edge-detect puts an outline right around the bottom"<BR>
igor grins.<BR>
igor says, "It has 20% ambient white light..."<BR>
Bruce says, "I'm using 'xv', btw."<BR>
igor goes for a tad more phong..<BR>
igor doesn't use xv on philosophical reasons...  (Not free...)<BR>
Bruce says, "I think you're allowed to evaluate it for a litle while .. starting yesterday"<BR>
igor grins.  Right, but ee and (soon) eye-of-gnome work better anyhow.<BR>
igor says, "What's the 'raised-to-the' operator/function in Dylan?"<BR>
igor ums... Why doesn't that work for floats?<BR>
igor says, "Ah...  I see.  We only support integer exponents thus far..."<BR>
igor wonders if that's enough...<BR>
igor says, "Nope..."<BR>
igor acks!<BR>
igor says, "We have the functions, they are just commented out of trancendental.dylan..."<BR>
Bruce says, "you want to raise to a float power?"<BR>
Bruce says, "what power?"<BR>
Bruce says, "if you've got ln and exp then you can do it yourself no problems"<BR>
Bruce says, "a^b = exp(ln(a)*b)"<BR>
igor uses that...<BR>
Bruce says, "what power did you need?  And for what?"<BR>
Bruce says, "it's *real* unusual to need a non-int exponent.  And 99% of those that are just need sqrt() * an integer power"<BR>
Bruce says, "(i.e. it's sqrt(a^b) where b is an int"<BR>
igor nods.  Yes, well... here's a case...<BR>
igor says, "The Phong exponent can be anything..."<BR>
Bruce pulls F&vD off the shelf<BR>
igor logs it in the bug tracker.<BR>
igor says, "Convenient that all three of us have that book, eh?"<BR>
Bruce says, "doesn't everyone?"<BR>
Bruce says, "I bet Eric and Gabor do too"<BR>
igor says, "Probably not Eric, actually..."<BR>
igor says, "He's not much of a graphics hacker..."<BR>
Bruce says, "You got Knuth?"<BR>
igor says, "Volume 1-2 2nd-ed, vol 3 1st-ed"<BR>
Bruce says, "thought so.  Bet the others do too"<BR>
igor says, "Eric definitely has Knuth."<BR>
igor wonders why this doesn't parse...<BR>
Bruce says, "so are you currently a student?"<BR>
igor says, "Not technically..."<BR>
Bruce wonders is an explanation is forthcoming<BR>
igor managed to flunk out of Dartmouth, having spent far too much time not working on his classes...<BR>
igor plans to finish up his degree elsewhere.<BR>
Bruce says, "which degree did you flunk out of?"<BR>
igor says, "CS w/music minor"<BR>
Bruce says, "I'm a failed MSc myself..."<BR>
-----------------------------------igor------------------------------------<BR>
define method \^ (b :: <double-float>, x :: <real>)<BR>
 => (y :: <double-float>)<BR>
  exp(log(b)*x);<BR>
end method;<BR>
---------------------------------finished----------------------------------<BR>
igor says, "WTF is wrong with that?"<BR>
Bruce says, "try some whitespace around operators"<BR>
igor says, "Hmm... Good point..."<BR>
Bruce says, "that'll *certainly* be stopping it from working"<BR>
igor keeps forgetting that.  Works now.<BR>
igor says, "Well, it looks like specular stuff is starting to work..."<BR>
igor says, "It may be time to think about rendering > 1 object (<gasp!>)"<BR>
Bruce says, "coooool"<BR>
Bruce just fixed a bug in Gabor's "clampf" implementation<BR>
Bruce says, "and about to fix the trig functions (shoudl be degrees not radians)"<BR>
igor says, "Seems to work..."<BR>
igor grins.<BR>
igor says, "All my functions do take radians, so someone's gonna have to convert 'em somewhere..."<BR>
igor figured the earlier it happened, the faster...<BR>
Bruce says, "and we need type checks all *though* it.  "2 3 addf" should print a diagnostic and exit(1)"<BR>
igor nods.<BR>
Bruce says, "actually, at the moment that *does* get diagnosed:"<BR>
-----------------------------------Bruce-----------------------------------<BR>
bruce@k7 src]$ ./icfp2000 <BR>
2 3 addf<BR>
Expected an instance of {the class <float>}, but got 3<BR>
Aborted (core dumped)<BR>
---------------------------------finished----------------------------------<BR>
igor grins...  You could always just catch those...<BR>
Bruce says, "other than the core-dump it's *puuuurfect*"<BR>
igor says, "Tht"<BR>
igor says, "er...  That's a Dylan exception, which is eminently catchable"<BR>
Bruce says, "any idea of the class?"<BR>
igor says, "That being said, I don't know how to *do* it..."<BR>
igor says, "Lets add that to the todo list, then bother Andreas..."<BR>
A small swarm of 3x5 index cards arrives, engulfs igor, and carries it away.<BR>
A small swarm of 3x5 index cards blows in and disperses, revealing igor.<BR>
igor clears done/mostly-done items from the todo list.<BR>
igor scratches his head.  I guess <csg-union> is our way of displaying > 1 object at a time, eh?<BR>
Bruce says, "that's how 'ts done, yes"<BR>
igor says, "Andreas moved some of that stuff around while I wasn't looking..."<BR>
Bruce there's the minor detail of whether both items are trying to occupy th same region of space or not, but that's fundamentally it.<BR>
igor nods.<BR>
igor says, "Naturally.  However, with a union, we only care which is in front at that particular place..."<BR>
Bruce nods<BR>
Bruce says, "difference is a bit nasty -- you've got to compute the intersection with the *back* of the subtracted object, not the front.  And then pretend that you actually hit the other object"<BR>
igor isn't even going to think about those until he gets to them...<BR>
Bruce says, "what's the name of pi?"<BR>
igor says, "$double-pi"<BR>
Bruce says, "ahhhhh .. that's better"<BR>
-----------------------------------Bruce-----------------------------------<BR>
Gabor has these macros:<BR>
Gabor has these macros:<BR>
<BR>
define unary-primitive acos(<float>) end;<BR>
<BR>
And so on for other functions.  Too bad about the conversions.<BR>
So.... I made it:<BR>
<BR>
define unary-primitive acos(<float>, compose(curry(\*, 180 / $double-pi), acos)) end;<BR>
---------------------------------finished----------------------------------<BR>
igor grins.<BR>
Bruce says, "this is the *functional* programing contest, no?"<BR>
igor . o O ( Screw functional programs, I just want programs that function... )<BR>
Bruce says, "crap -- that does generic dispatch all over the place :-("<BR>
igor says, "Doh..."<BR>
igor scratches his head at this latest image...<BR>
igor sighs.<BR>
igor says, "Andreas merrily made new objects without setting them up right :-P"<BR>
igor says, "(hence, none of them got textures...)"<BR>
Bruce says, "how are you on macros?  How do you dfeat hygiene?"<BR>
igor is really lousy with macros.<BR>
igor says, "Generally, I solve the problem by going to Eric and explaining what I'm trying to do, and some weird way of doing it, and he says, "no, no, you should use a macro" and codes it up for me ;-)"<BR>
igor says, "Rendering multiple objects now happens."<BR>
igor says, "How useful: Error: Name mismatch: ordinary word ``red-texture'' isn't ordinary word ``blue-texture''"<BR>
igor says, "Y'know, somehow I feel we could have recovered from this error, and just left it as a warning..."<BR>
igor says, "Woohoo.  The depth-testing worked the first time :-)"<BR>
igor says, "So, I just need shadows and reflections, and I'll have a complete Tier-I ray-tracer"<BR>
Bruce says, "re macros..."<BR>
Bruce says, "what I wanted was what turns out to be "reverse un-hygiene".  Which isn't suported, I don't think"<BR>
igor has no clue about macros...<BR>
Bruce says, "there are a whole lot of places where you currently have to do "method(f) 4 * f end" etc in a macro call"<BR>
igor . o O ( curry(\*, 4) )<BR>
Bruce says, "and I wanted to instead just go "4 * f" in the macro call and have the macro body expand to the right thing.  But you get 'f is not declared'"<BR>
Bruce says, "never mind"<BR>
Bruce says, "are you checked in?"<BR>
igor says, "More or less, yeah..."<BR>
igor [to Bruce]: What are you working on, currently?<BR>
Bruce says, "right now I'm bugfixing in the interpreter"<BR>
igor says, "Good, good..."<BR>
igor's working on shadows.<BR>
igor says, "This thing really needs to get faster..."<BR>
Bruce says, "just fixed a problem with -ve literals, problems with sin/cos/asin/acos and a problem with 'real' (wanted a <float> argument for some reason)"<BR>
Bruce says, "I could do some profiling, if you wanted"<BR>
igor says, "Well, maybe not quite yet..."<BR>
Bruce agrees<BR>
igor says, "scratches his head."<BR>
igor says, "OK, I've got pointilism shadows now..."<BR>
Bruce says, "acne?"<BR>
igor sends Bruce the sample.<BR>
Bruce says, "like this?"<BR>
Bruce shares a URL...<BR>
  <<A HREF="http://www.cs.bell-labs.com/who/jhr/icfp/images/spheres-w-acne.jpg" TARGET="_blank">http://www.cs.bell-labs.com/who/jhr/icfp/images/spheres-w-acne.jpg</A>>.<BR>
igor says, "An extreme case, yeah..."<BR>
igor says, "Right... That problem."<BR>
igor says, "Yes, that makes a lot of sense..."<BR>
Bruce says, "easily fixed..."<BR>
Bruce shares a URL...<BR>
  <<A HREF="http://www.cs.bell-labs.com/who/jhr/icfp/task.htm#sec:acne" TARGET="_blank">http://www.cs.bell-labs.com/who/jhr/icfp/task.htm#sec:acne</A>>.<BR>
igor nods.<BR>
Bruce has the image now.  Looks like the same pronlem...<BR>
igor says, "Yeah.  Because I'm using a small image (the sphere is 0.3 units in radius), it's made worse."<BR>
igor adds a 0.01-unit fudge factor.<BR>
Bruce says, "other that that, it's looks *great*!"<BR>
Bruce says, "use 1e-20 or something"<BR>
igor says, "This problem, as it turns out, is even worse in OpenGL, as you'll lose entire polygon chunks on your shadows if one corner dips below the floor."<BR>
igor says, "Hence, there's a glOffset() function that moves stuff a tad towards the viewer to avoid this."<BR>
igor says, "It's worse, too, as z-buffer precision is much less than float precision..."<BR>
Bruce nods<BR>
igor says, "Er, glPolygonOffset, actually."<BR>
Bruce btw's -- you can't use "1e-20" in d2c because of the parsing bug (until you update)<BR>
igor was about to mention that, too...<BR>
igor says, "And rebuild d2c, which I don't feel like doing, ATM..."<BR>
Bruce says, "but 0.000000000000000000001 will work"<BR>
igor's using 0.000000000001<BR>
Bruce says, "near enough"<BR>
igor says, "(1e-12)"<BR>
igor tests once more before committing.<BR>
Bruce says, "did you loko at any of the papers referenced at the end of the task spec?"<BR>
igor says, "Nope."<BR>
igor did notice the 'acne' bit mentioned in the task, though...<BR>
Bruce says, "maybe if we get it actually working in time :-)"<BR>
Bruce says, "let me know when you're checked in, so I can try it"<BR>
igor says, "OK, update and look at the pretty picture..."<BR>
igor glances nervously at the clock.<BR>
Bruce says, "oooh .. nice."<BR>
Bruce says, "took nearly 90 seconds, mind you"<BR>
igor says, "Idn't dat perty?"<BR>
igor wonders where all the time is going...<BR>
igor says, "Perhaps optimizing sooner rather than later would be a win, as it'd speed up the edit-compile-test cycle significantly..."<BR>
Bruce says, "yeah -- you can't make the images infinitely small..."<BR>
igor says, "suspects it is approximately 8 zillion bounds-checks on matrices and vectors, actually..."<BR>
igor says, "(and type-checks, too)"<BR>
Bruce says, "none of those things are particuarly slow -- it's the GF dispatches that kill things"<BR>
igor says, "Right..."<BR>
igor says, "It's taking over 2.5 minutes for me :-P"<BR>
Bruce says, "you keep working on features -- I'll take a look at performance"<BR>
Bruce says, "I just did it again, and timed it this time ... 89.38 user time, 97 elapsed"<BR>
Bruce has SETigoing in the background<BR>
igor says, "Is it the GF that happens as we look up a number in a vector (which we know is doubles) but get back an <object>?"<BR>
Bruce says, "you're on a PIII 450?"<BR>
igor says, "Overclocked to 500, but yeah..."<BR>
igor has 897.84 bogomips...<BR>
Bruce says, "the lookup doens't cause a GF, but any arithmetic you do on the resulting value will."<BR>
Bruce says, "Just do 'let v :: <double-float> = array[i]' and you're sweet"<BR>
igor says, "Exactly."<BR>
Bruce says, "the typecheck will cost a couple of cheap integer instructions, and then you'll get inlined C arithmetic instead of GF dispatches"<BR>
igor says, "OK, where does this go, then?"<BR>
Bruce says, "let me take a lok through your stuff.."<BR>
Bruce says, "you keep pushing on, since you know what you're doing..."<BR>
igor says, "Should we make a subclass of <matrix> and <vector> to cover the 4D-double-floats case?  <transform-matrix> and <quaternion>"<BR>
igor moves onto reflections, then...<BR>
igor says, "(THIS'll slow things down righteously...)"<BR>
igor reduces the resolution to 64x64<BR>
Bruce says, "in all honesty, if it was me I'd use a custom class with every element as it's own slot, and expand all the *. + etc by hand"<BR>
igor nods.  That mightn't be a bad idea.<BR>
igor says, "If you're not busy, try putting the wedge into matrix.dylan, and, when it works, we can go around changing everything to use it..."<BR>
Bruce says, "roger, wilco"<BR>
igor grins.<BR>
Bruce says, "shouldn't be too many client changes"<BR>
igor says, "That's good to know.  We will need to change all the 'vector(foo)' to 'quaterion(foo)', though..."<BR>
Bruce is off to dinner for a few minutes<BR>
igor says, "If you could make the place-holder classes (inheriting from <vector> and <matrix>), then I'll start using 'em as I go along"<BR>
igor says, "Oh, OK.  I'll try to make reflections work, then."<BR>
Bruce says, "do you know gabor's email?"<BR>
igor hmms.<BR>
igor says, "gabor68@yahoo.com"<BR>
Bruce says, "yeah I knew that one .. oh well I'll try it..."<BR>
andreas has connected.<BR>
andreas says, "morning..."<BR>
Bruce says, "Hey andreas!"<BR>
Bruce says, "coming up to the halfway mark...."<BR>
andreas says, "what's the state?"<BR>
Bruce says, "it reads text files, lexes, interprets"<BR>
Bruce says, "igor has pretty good ray tracing going "<BR>
Bruce says, "he's working on reflections at the moment"<BR>
andreas says, "sounds very good!"<BR>
Bruce says, "Gabor has been checking a couple of small changes in the last few minutes, can't contact him though"<BR>
andreas says, "I won't be able to do much today and tomorrow, I have paid work to do."<BR>
Bruce says, "rats"<BR>
andreas says, "But I will look into the stuff this evening for a few hours."<BR>
Bruce says, "if you can releive Igor that would be good.  You two know more about the raytracing part"<BR>
andreas says, "Boy, are our matrices slow."<BR>
Bruce says, "yes they are."<BR>
Bruce says, "I was planning to take an efficiency lok at things pretty soon"<BR>
igor returns.<BR>
igor growls at his reflections not working.<BR>
andreas says, "The rendering part looks good so far."<BR>
igor took a break to watch some baseball.<BR>
andreas [to igor]: I will not be able to help you much today, the job and stuff...<BR>
igor glances nervously at the clock.<BR>
andreas [to igor]: But I will be back this evening for a few hours.<BR>
igor [to andreas]: <nod>  K.  Tier-I rendering is almost working, Tier-II stuff should be pretty easy, but the CSG may be a beatch...<BR>
andreas says, "Yes, I've already though about the CSG stuff. It would require a different structure for intersection code. So we should aim for Tier-II."<BR>
andreas me takes a shower now and goes to work...<BR>
igor says, "K."<BR>
andreas says, "later..."<BR>
You hear a quiet popping sound; andreas has disconnected.<BR>
Bruce says, "Igor, can you tell me the next time you're going to take a break for a while .. and get checked in?"<BR>
igor says, "Oh, ok..."<BR>
Bruce says, "I'll take the chance to go through the matrix/vector stuff with a fire-hose"<BR>
igor nods.<BR>
Bruce says, "do you want different types for points and vectors, or is the same one OK?"<BR>
igor says, "The same one is great."<BR>
Bruce says, "4th item for a point is always 1, right?  And for vector is 0?"<BR>
igor says, "(x, y, z, 0.0) is a vector, and (x, y, z, 1.0) is a point."<BR>
igor says, "It's not *always* one..."<BR>
igor says, "Some transforms will change that."<BR>
Bruce says, "only if it's normalised"<BR>
igor says, "homogenize() will adjust it appropriately."<BR>
Karl-Heinz_Guest has connected.<BR>
Bruce says, "do you index into them in your code much?"<BR>
>> Karl-Heinz_Guest is now known as gabor_[Guest].<BR>
Bruce says, ".. or are you mostly using the defined operators and functions?"<BR>
igor says, "(x, y, z, w) = (x*w, y*w, z*w, 1.0)"<BR>
jon.dyte [Guest] has connected.<BR>
igor says, "Mostly I use operators, but I do index a bit."<BR>
Bruce says, "Gabor!"<BR>
igor says, "If you wanted to make it "foo.y-component" or something, it wouldn't be the end of the world..."<BR>
Bruce says, "if they were available as .x, .y, .z, and .w insteade would that be OK?"<BR>
igor says, "(w, BTW, is the standard name for that component)"<BR>
Bruce knows<BR>
igor says, "Yep.  Although .x, .y, .z and .w kinda polutes the namespace there, eh?"<BR>
jon.dyte [Guest] goes south.<BR>
Bruce says, "you always index with constants?"<BR>
jon.dyte [Guest] has arrived.<BR>
igor says, "Yes."<BR>
Bruce says, "no prob then"<BR>
igor is going to catch a couple-hour nap...<BR>
Bruce says, "you checked in?????"<BR>
igor says, "Not yet, I'll do so."<BR>
Bruce says, "thanks :-)"<BR>
You hear a quiet popping sound; Dieter_Guest has disconnected.<BR>
gabor_[Guest] says, "man, how can I speak? HELP!"<BR>
igor says, "say <whatever>"<BR>
gabor_[Guest] says, "got it"<BR>
igor says, "Alternatively, use the " character instead of say."<BR>
Bruce says, "hello!"<BR>
igor says, " "foo => say foo"<BR>
gabor_[Guest] says, "what is "normal"?"<BR>
igor says, "normal?"<BR>
Bruce says, "quote is less typing"<BR>
gabor_[Guest] says, "the radio button on the right"<BR>
igor is fully checked in.<BR>
gabor_[Guest] says, "is <whatever> an instantiable type :-)"<BR>
Bruce says, "are you using the java client, Gabor?"<BR>
gabor_[Guest] says, "yes"<BR>
Bruce says, "there's a button on the right that says "say""<BR>
Bruce says, "ahh "normal" means you can type commands. "say" means it puts "say" automatically and you can only say thing, not do things."<BR>
Bruce says, "other commands:  look   look TODO  "<BR>
Bruce says, "here's a fun thing..."<BR>
gabor_[Guest] says, "OK getting serious, the <point> class in the engine has to be synched with the other your class for this purpose"<BR>
Bruce shares a URL...<BR>
  <<A HREF="http://www.apple.com" TARGET="_blank">http://www.apple.com</A>>.<BR>
Bruce says, "true"<BR>
gabor_[Guest] says, "my next machine :-)"<BR>
Bruce says, "I'm just going through the rendering engine tidying up the types at the moment"<BR>
Bruce says, "we'll synch with the interpreter later"<BR>
gabor_[Guest] says, "OK"<BR>
Bruce says, "nice job there, btw.  small and tidy, if a bit slow in places..."<BR>
Bruce says, "looks straight out of parts of SICP"<BR>
gabor_[Guest] says, "what is slow?"<BR>
Bruce says, "well, overall it seems to do abhout 500,000 instructions per ceond on my 700 MHz box.  That's Apple ][ speed.  Or, 20 or 30 times slower than Perl."<BR>
Bruce says, "OTOH, it's a lot faster than the raytracer right now..."<BR>
gabor_[Guest] says, "It does not generate machine code, but I think it is the fastest you can get with portable dylan"<BR>
igor says, "And, of course, only the texture-rendering bits need to run fast..."<BR>
gabor_[Guest] says, "that is your job :-)"<BR>
Bruce says, "Well, I think if you hand-expanded the arithmetic operator macros it would be faste, because so many of them require an extra layer of closures"<BR>
igor says, "Nope...  That's your problem.  I promise to never call them any more than necessary, though..."<BR>
Bruce says, "anyway .. fantastic job, and very quickly produced.  I wish I'd done half as good a job on the lexer"<BR>
Bruce says, "I thought I could save time by stealing bits from d2c, but the environments turned out to be just tooo different to make that a good idea in the end :-("<BR>
Bruce says, "So, how much time do you have available now?"<BR>
Bruce says, "Andreas is at work, and Igor is going to bed.  So it's you and me right now."<BR>
gabor_[Guest] says, "I'll look into the fast arithmetics. Do you think it is a bottleneck?"<BR>
igor says, "I'd say simply making the interpretter talk to the renderer would be a good thing to do first."<BR>
gabor_[Guest] says, "I am at work too. My boss won love this :-("<BR>
Bruce says, "Where do you live, Gabor?"<BR>
igor says, "Also, making the renderer go faster would be a good idea..."<BR>
gabor_[Guest] says, "I can work from 19:00 GMT to 1:00 GMT"<BR>
gabor_[Guest] says, "Germany"<BR>
Bruce says, "I'm playing with speed on the renderer while Igor sleeps..."<BR>
Bruce says, "so you've got 4 hours..."<BR>
Bruce says, "btw -- the halfway point of the contest just now passed"<BR>
igor says, "Think we're halfway done?"<BR>
Bruce says, "I think we're looking GOOOD"<BR>
gabor_[Guest] says, "interpretter talk to the renderer  <== this is why the graphics primitives are for."<BR>
igor [to gabor_[Guest]]: Do they work yet?<BR>
gabor_[Guest] says, "Give me the interface!"<BR>
Bruce says, "I agree that would be a good part for Gabor to work on.  It's necessary, and he knows more about the interpreter internals."<BR>
Bruce says, "I think you'll need to rearrange the modules a little bit, so the interpreter can import things from the renderer"<BR>
gabor_[Guest] says, "OK we need strings too, bruce, your lexer delivers them as strings?"<BR>
Bruce says, "yes"<BR>
igor says, "So, can Gabor work on that, with Bruce's assistance in figuring out how to hook the renderer up properly?"<BR>
Bruce says, "nothing ever happens to strings -- no operators for them."<BR>
Bruce says, ":the ONLY use is as the filename argument"<BR>
igor says, "And, as a background task, Bruce can work on making matrices fly."<BR>
Bruce says, "Gabor, try running the program and you can enter a program on stdin"<BR>
igor says, "And I'll be back in about 5 or 6 hours to try to make the rest of the renderer work."<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 <BR>
3 4 lessi {"yes"}{"no"}if<BR>
lexed : #(3, 4, #"lessi", '{', "yes", '}', '{', "no", '}', #"if")<BR>
<BR>
output: #("yes")<BR>
---------------------------------finished----------------------------------<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 <BR>
{/self /n /b /a a n 0 eqi {}{b b a addi n 1 subi self self apply}if}/fib<BR>
0 1 20 fib fib apply<BR>
lexed : #('{', '/', #"self", '/', #"n", '/', #"b", '/', #"a", #"a", #"n", 0, #"eqi", '{', '}', '{', #"b", #"b", #"a", #"addi", #"n", 1, #"subi", #"self", #"self", #"apply", '}', #"if", '}', '/', #"fib", 0, 1, 20, #"fib", #"fib", #"apply")<BR>
<BR>
output: #(6765, 4181, 2584, 1597, 987, 610, 377, 233, 144, 89, 55, 34, 21, 13, 8, 5, 3, 2, 1, 1, 0)<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "something we need to work on is diagnostics"<BR>
Bruce says, "the judges are very very particular that we accept programs according to the spec, and issue diagnostics for non-conforming ones"<BR>
Bruce says, "so, for example, numbers can be 1234 or -1234 but NOT +1234"<BR>
gabor_[Guest] says, "diagnostics should be done with report-condition in a block around invocation of the compiler"<BR>
Bruce says, "1.023e23  or 1.023e-23, but NOT 1.023e+23"<BR>
Bruce says, "at the moment there are several different things that happen: explicit calls of "error()", message-not-understoods, and "expected <type> nbut got <type>""<BR>
Bruce says, "Can we catch all of those?  I'm not too hot on that aspect"<BR>
Bruce says, "things like addi must report if they are used on floats, and addf must report if it is used on ints."<BR>
gabor_[Guest] says, "hey that is good messages! catching <simple-error> gives you all of them generated with error(<string>,...)"<BR>
gabor_[Guest] says, "and that is INHO all"<BR>
gabor_[Guest] says, "addi etc. reports that already as type errors"<BR>
Bruce says, "I don't know if they are going to test our reaction to invalid programs, but based on the past years I think they will."<BR>
gabor_[Guest] says, "I think so. But we check almost all implicitly now."<BR>
Bruce says, "I think we're pretty close, and where we're not it won't take much to fix it."<BR>
Bruce says, "we need to have some sort of diagnostic on stdout or stderr, and we need to exit(1), so the driver script can detect it"<BR>
gabor_[Guest] says, "I cannot test, because stdin does not work in my mac setup. Please try "hello" as input to the GML"<BR>
Bruce says, ".. the main thing is that someone has to go through and test all sorts of errors out"<BR>
gabor_[Guest] says, "I have never seen strings"<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 <BR>
"hello"<BR>
lexed : #("hello")<BR>
<BR>
output: #("hello")<BR>
<BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "no need to go thru. It will just catch the errors. Relax"<BR>
gabor_[Guest] says, "Thanks tat is nice"<BR>
Bruce says, "another thing which I wanted to ask you ..."<BR>
You hear a quiet popping sound; igor has disconnected.<BR>
Bruce says, "... we need to stop the user from rebinding the operators and true/false etc"<BR>
gabor_[Guest] says, "can you do that?"<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 <BR>
123 /true true<BR>
lexed : #(123, '/', #"true", #"true")<BR>
<BR>
output: #(#t)<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "it doesn't actually get rebound, but we need to diagnose it"<BR>
gabor_[Guest] says, "pity"<BR>
gabor_[Guest] says, "OK will do."<BR>
gabor_[Guest] says, "Have to work now :-("<BR>
Bruce says, "OK :-)"<BR>
gabor_[Guest] says, "but will look at this list, just not often."<BR>
Bruce says, "can you stay online and just check what's happening occasionally?"<BR>
Bruce says, "where shoudl I email you if I have a question?"<BR>
Bruce says, "Do you have a SMS-capable phone?"<BR>
You hear a quiet popping sound; Bruce has disconnected.<BR>
Bruce has connected.<BR>
Bruce says, "darn -- modem disconnected"<BR>
gabor_[Guest] says, "the moo client is running, no phone, gabor@mac.com"<BR>
Bruce says, "OK"<BR>
Bruce says, "if you want to see what has been said here, yo can do "read idle_chat""<BR>
Bruce says, "... that shows the contents of the pretty little tape icon you can see in the java client"<BR>
gabor_[Guest] says, "see no tape"<BR>
Bruce says, "is here still the apple.com page?"<BR>
Bruce says, "if so, type 'look', or press the 'look' button at the top of the window"<BR>
gabor_[Guest] says, "I have jim with a tape"<BR>
Bruce says, "right.  I called the tape recorder "jim" for no particular reason"<BR>
Horst_Guest has connected.<BR>
You hear a quiet popping sound; Karl-Heinz_Guest has disconnected.<BR>
>> Horst_Guest is now known as gabor_[Guest].<BR>
gabor_[Guest] says, "my boss dropped a fuse... the whole office was down"<BR>
gabor_[Guest] says, "what happened in the meanwhile?"<BR>
Bruce says, "not much"<BR>
Bruce says, "I'm busy hand-rolling a <vector3D> and <transform> class"<BR>
Bruce says, "(wiht the aid of a little perl for the tedious bits)"<BR>
gabor_[Guest] says, "checked in engine. should now disallow rebinding of reserveds, but still allow rebinding otherwise. Cannot check here, would you be so kind?"<BR>
Bruce says, "uuuuh .. I'll have to check out a new directory .. not in buildable state here at the mo..."<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 <BR>
10 /x {x} /p 7 /x p apply<BR>
cannot rebind reserved word 'x'<BR>
Aborted (core dumped)<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "old version worked"<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ~/ICFP2000/ICFP2000/src/icfp2000 <BR>
10 /x {x} /p 7 /x p apply<BR>
lexed : #(10, '/', #"x", '{', #"x", '}', '/', #"p", 7, '/', #"x", #"p", #"apply")<BR>
<BR>
output: #(10)<BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "in line 100 change 1 to 2 and try again"<BR>
gabor_[Guest] says, "<A HREF="http://www.cs.cornell.edu/icfp/" TARGET="_blank">http://www.cs.cornell.edu/icfp/</A> is dead?"<BR>
Bruce says, "that works"<BR>
gabor_[Guest] says, "also the rebinding of reserveds?"<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 <BR>
10 /x {x} /p 7 /x p apply<BR>
lexed : #(10, '/', #"x", '{', #"x", '}', '/', #"p", 7, '/', #"x", #"p", #"apply")<BR>
<BR>
output: #(10)<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "hmmm: directory listing denied"<BR>
gabor_[Guest] says, "me too"<BR>
Bruce says, "interesting techinque you have to detect reserved words!"<BR>
Bruce says, "might be a bit slow, but it's only at compile time, so who cares, right?"<BR>
gabor_[Guest] says, "yes. this way you do not have to keep the list twice!"<BR>
gabor_[Guest] says, "does it work?"<BR>
Bruce says, "whic applicable method did you forget?"<BR>
Bruce says, "yes it works"<BR>
gabor_[Guest] says, "no idea... move to 1 and add "=%", sorted-... to the error statement"<BR>
gabor_[Guest] says, "then check in the version with 2 without the added diagnostics"<BR>
Bruce says, "it's been checked in for two minutes now"<BR>
gabor_[Guest] says, "fine"<BR>
Bruce says, ":-) :-)"<BR>
Bruce says, "ahh .. I see"<BR>
Bruce says, "just reading the source, there's the one that hoovers up a list of tokens e.g. literals etc"<BR>
Bruce says, ".. and then there's the one that takes a symbol and looks it up in the env"<BR>
Bruce says, "..and then there's the one for that particular singleton token"<BR>
gabor_[Guest] says, "line number of the first one?"<BR>
Bruce says, "67"<BR>
Bruce says, "2nd is 89"<BR>
gabor_[Guest] says, "got it :-)"<BR>
gabor_[Guest] says, "should know my own code..."<BR>
Bruce says, "there's a whole *lot* of consing of pairs going on in that stuff"<BR>
Bruce says, "did you see where I did a loop that executed 1,000,000 times, adding one to the top of the stack each time .. and the program got up to 13 MB of RAM used"<BR>
gabor_[Guest] says, "for specialized <symbol>s there will always be one more applicable then for a vanilla one. This saves us fron breaking if somebody inserts an extra method. I put this in. Can you verify?"<BR>
Bruce says, "I agree, analytically"<BR>
jon.dyte [Guest] has connected.<BR>
jon.dyte [Guest] glances nervously at the clock.<BR>
Bruce says, ".. of course you're screwed if anyone ever takes the 'apply' oprator away..."<BR>
Bruce says, "do you know postscript?"<BR>
Bruce says, "there, functions automatically execute, and you load the closure onto the stack by putting a symbol for the name onto the stack and calling "load""<BR>
gabor_[Guest] says, "It conses one if the stack grows one. We have GC. Btw I will build in a compile-time optimization that operates on literal tokens and tries to reduce stuff like "2 3 addi" to be a ctv. Also "3 addi" will be partially evaluated. This will be tonights work after the graphics is integrated. Never done such stuff before, but on Apple Dylan PPC I have fast turnaround times :-)"<BR>
Bruce says, "You're workin in the technology release!!"<BR>
Bruce says, "I've got that loaded on the 8500 (that's I'm typing this on), but haven't tried it recently"<BR>
gabor_[Guest] says, "Hey if somebody does that, the compiler is screwed anyway!"<BR>
Bruce says, "any chance we could compile (in memory) to x86 machine code?  :-)"<BR>
gabor_[Guest] says, "It works fine on my PowerBook G3 (old) only if you use no macros. The reason why Math-prims is an extra file ;-)"<BR>
gabor_[Guest] says, "No way (intel outside)"<BR>
Bruce says, "OK, how about PPC machine code?"<BR>
Bruce says, "we're already in fully CPS style, right?"<BR>
gabor_[Guest] says, "If you expand all those macros manually, perhaps."<BR>
gabor_[Guest] says, "CPS style d2c or GML compiler?"<BR>
Bruce says, "GML"<BR>
Bruce says, "Another possibility ... coudl you compile to Scheme?"<BR>
Bruce says, "Thee are scheme compilers on the test machine"<BR>
Bruce says, "it'd be cool if we could install d2c on the contest machine and use machine-generated Dylan..."<BR>
Bruce says, "So what is yout turn-around time on the Dylan TR?"<BR>
gabor_[Guest] says, "3 seconds"<BR>
Bruce says, "cool"<BR>
Bruce says, "it's taking 25 seconds to build on the 700 MHz athlon here, using d2c"<BR>
gabor_[Guest] says, "The bottleneck will be the rendering. We should concentrate on that"<BR>
Bruce says, "on most images, I agree"<BR>
Bruce says, "I expect most texture functions to take 5 uS - 100 uS"<BR>
gabor_[Guest] says, "wait for the optimizing compiler and see..."<BR>
Bruce says, "The rendering is well over 1 mS per pixel without that"<BR>
Bruce says, "... so it makes virtually no difference"<BR>
Bruce says, "HOWEVER ... I'm *sure* the judges will throw something with an incredibly complicated texture function at it"<BR>
Bruce says, "... just to see what happens"<BR>
Bruce says, "there will also be incredibly long machine-generated files.  Perhaps several MB in source text size"<BR>
Bruce says, ".. and almost certainly some *huge* opportunities for compile-time evaluation"<BR>
gabor_[Guest] says, "I already have good ideas for the partial evaluator"<BR>
Bruce says, "excellent :-)"<BR>
gabor_[Guest] says, "did my last checkin work?"<BR>
Bruce says, "I'm sure there will b tests designed to make the compiler the bottleneck"<BR>
Bruce says, "whichj one is that?  With c-a-m("apply")??  Yes"<BR>
gabor_[Guest] says, "OK"<BR>
Bruce says, "mmm .. I"m starting to get sleeepy"<BR>
gabor_[Guest] says, "We want to win, eh? ;-)"<BR>
Bruce says, "00:22 tuesday here"<BR>
Bruce says, "we want to win?  YES"<BR>
gabor_[Guest] says, "Do not write anything hairy then, just dull stuff"<BR>
Bruce says, "for bug avoidance?"<BR>
gabor_[Guest] says, "of course"<BR>
Bruce says, "how do you rate our chances?"<BR>
gabor_[Guest] says, "PE will give us some compile-time type checking."<BR>
gabor_[Guest] says, "If it depends on me we win. I guess Andreas and Jeff are top-notch too. So there is a chance"<BR>
Bruce says, "I'm glad we're not trying to use Perl for this.  (Previous years have had entries writen in Perl)"<BR>
Bruce says, "I'm glad I'm not using C or C++ or Java"<BR>
Bruce says, "the smalltalk and CL and ML guys will be developing as fast as or faster than us (better and more mature envs), but they may run slower -- especially if we use some declarations carefully"<BR>
You hear a quiet popping sound; Karl-Heinz_Guest has disconnected.<BR>
gabor_[Guest] says, "a) dito, b) we would need 3 years, c) they have a chance too"<BR>
Bruce says, "well, this *is* called the *Functional* programing contest"<BR>
Bruce says, "what do we need three years for?  IDE/env/compiler maturity?"<BR>
gabor_[Guest] says, "developing this icfp in C or C++"<BR>
Bruce says, "oh"<BR>
Bruce says, "what strikes me is that this year everyone will basically need all the time.  There are no 1-hour solutions"<BR>
Bruce says, "previous years, you could put together a correct, but trivial, solution in an hour or two"<BR>
gabor_[Guest] says, "they had too much to make corrections for in the last years ;-)"<BR>
gabor_[Guest] says, "I am using no single assignment in my code"<BR>
gabor_[Guest] says, "the binary-primitive etc. macros will help a lot with PE."<BR>
gabor_[Guest] says, "implementing one case will give me all"<BR>
Bruce says, "look at the sort of crud I'm writing at the moment..."<BR>
-----------------------------------Bruce-----------------------------------<BR>
define method \* (m :: <transform>, v :: <vector3D>)<BR>
 => mult-vector :: <vector3D>;<BR>
  vector3D(m.v00 * v.x + m.v01 * v.y + m.v02 * v.z + m.v03 * v.w,<BR>
           m.v10 * v.x + m.v11 * v.y + m.v12 * v.z + m.v13 * v.w,<BR>
           m.v20 * v.x + m.v21 * v.y + m.v22 * v.z + m.v23 * v.w,<BR>
           m.v30 * v.x + m.v31 * v.y + m.v32 * v.z + m.v33 * v.w);<BR>
end method;<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "be lots of grunt typing if it wasn't for computers..."<BR>
-----------------------------------Bruce-----------------------------------<BR>
#!/usr/bin/perl<BR>
<BR>
$flds[0] = "x";<BR>
$flds[1] = "y";<BR>
$flds[2] = "z";<BR>
$flds[3] = "w";<BR>
<BR>
for ($i=0; $i<4; ++$i){<BR>
    for ($j=0; $j<4; ++$j){<BR>
        printf "m.v${i}${j} * v.${flds[$j]} + ";<BR>
<BR>
    }<BR>
    printf "\n";<BR>
}<BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "how about macros?"<BR>
Bruce says, "that's *exactly* what I was about to ask you."<BR>
Bruce says, "How hard to use a macro iunstead?"<BR>
gabor_[Guest] says, "easy define macro scalar4mult { scalar4mult(?matrix:expression, ?vector:expression, ?accessor:name) } => { matrix.?accessor ## "00" * ?vector.x + matrix.?accessor ## "01" * ?vector.y + matrix.?accessor ## "02" * ?vector.z + matrix.?accessor ## "03" * ?vector.w } end macro;"<BR>
gabor_[Guest] says, "usage scalar4mult(m,v,v)"<BR>
Bruce says, "that just does one result, right?  You need four"<BR>
Bruce says, "now do the transpose for v * m instead of m * v"<BR>
gabor_[Guest] says, "just one. Try it, then take the expression an parameterize it to get a new macro."<BR>
gabor_[Guest] says, "when inpace tansposing you have to be _very_ careful. better dont do that. I know no algorithm"<BR>
Bruce says, "for the v * m you need to paramaterize the 00 01 02 03 more"<BR>
Bruce says, "it's like this:"<BR>
-----------------------------------Bruce-----------------------------------<BR>
define method \* (v :: <vector3D>, m :: <transform>)<BR>
 => mult-vector :: <vector3D>;<BR>
  vector3D(m.v00 * v.x + m.v10 * v.y + m.v20 * v.z + m.v30 * v.w,<BR>
           m.v01 * v.x + m.v11 * v.y + m.v21 * v.z + m.v31 * v.w,<BR>
           m.v02 * v.x + m.v12 * v.y + m.v22 * v.z + m.v32 * v.w,<BR>
           m.v03 * v.x + m.v13 * v.y + m.v23 * v.z + m.v33 * v.w);<BR>
end method;<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "took all of 2 seconds to adjust the Perl to make that."<BR>
Bruce says, "actually, testing showed I got it wrong the first time :-)"<BR>
gabor_[Guest] says, "define macro scalar4mult { scalar4mult(?matrix:expression,"<BR>
gabor_[Guest] says, "usage scalar4mult(m,v,v0), usage scalar4mult(m,v,v1), usage scalar4mult(m,v,v2), usage scalar4mult(m,v,v3)"<BR>
gabor_[Guest] says, "got garbled a bit..."<BR>
Bruce says, "that's OK"<BR>
Bruce says, "just compiled the code I posted and looked at the C and it's luverly.  It'll be *much* master than what Igor and Andreas were using before"<BR>
Bruce says, "er, much faster"<BR>
Bruce says, "to put in blocks of stuff, type '@PASTE', then follow instructions"<BR>
gabor_[Guest] says, "@paste"<BR>
-------------------------------gabor_[Guest]-------------------------------<BR>
line1<BR>
line2<BR>
line3<BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "works :-)"<BR>
Bruce says, "I'm only 24 hours ahead of you on MOOing"<BR>
Bruce says, "Andreas and Igor are both 5-year veterans and Wizards"<BR>
Bruce says, "it's actually a completely programmable OO environment"<BR>
Bruce says, "aparently..."<BR>
gabor_[Guest] says, "Still working?"<BR>
Bruce says, "hi"<BR>
Bruce says, "just about finished by major <matrix> and <vector> to dedicated classes revamp"<BR>
Bruce says, ".. or, at least, fjust about finished the editing and ready to try to compile..."<BR>
Bruce says, "well, it compiles fine ... but I'm missing a <transform> * <transform> operator"<BR>
gabor_[Guest] says, "can you write it?"<BR>
Bruce says, "of course!"<BR>
Bruce says, "it's just a matrix multiplication"<BR>
-----------------------------------Bruce-----------------------------------<BR>
    for (i from 0 below rows1)<BR>
      for (j from 0 below columns2)<BR>
        for (k from 0 below columns1)<BR>
          temp-mat[i,j] := temp-mat[i,j] + matrix1[i,k] * matrix2[k,j];<BR>
        end for;<BR>
      end for;<BR>
    end for;<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "... except that I can't index into a <transform>, so I have to unroll the loops"<BR>
-----------------------------------Bruce-----------------------------------<BR>
  r.v00 := a.v00 * b.v00 + a.v01 * b.v10 + a.v02 * b.v20 + a.v03 * b.v30;<BR>
  r.v01 := a.v00 * b.v01 + a.v01 * b.v11 + a.v02 * b.v21 + a.v03 * b.v31;<BR>
  r.v02 := a.v00 * b.v02 + a.v01 * b.v12 + a.v02 * b.v22 + a.v03 * b.v32;<BR>
  r.v03 := a.v00 * b.v03 + a.v01 * b.v13 + a.v02 * b.v23 + a.v03 * b.v33;<BR>
  r.v10 := a.v10 * b.v00 + a.v11 * b.v10 + a.v12 * b.v20 + a.v13 * b.v30;<BR>
  r.v11 := a.v10 * b.v01 + a.v11 * b.v11 + a.v12 * b.v21 + a.v13 * b.v31;<BR>
  r.v12 := a.v10 * b.v02 + a.v11 * b.v12 + a.v12 * b.v22 + a.v13 * b.v32;<BR>
  r.v13 := a.v10 * b.v03 + a.v11 * b.v13 + a.v12 * b.v23 + a.v13 * b.v33;<BR>
  r.v20 := a.v20 * b.v00 + a.v21 * b.v10 + a.v22 * b.v20 + a.v23 * b.v30;<BR>
  r.v21 := a.v20 * b.v01 + a.v21 * b.v11 + a.v22 * b.v21 + a.v23 * b.v31;<BR>
  r.v22 := a.v20 * b.v02 + a.v21 * b.v12 + a.v22 * b.v22 + a.v23 * b.v32;<BR>
  r.v23 := a.v20 * b.v03 + a.v21 * b.v13 + a.v22 * b.v23 + a.v23 * b.v33;<BR>
  r.v30 := a.v30 * b.v00 + a.v31 * b.v10 + a.v32 * b.v20 + a.v33 * b.v30;<BR>
  r.v31 := a.v30 * b.v01 + a.v31 * b.v11 + a.v32 * b.v21 + a.v33 * b.v31;<BR>
  r.v32 := a.v30 * b.v02 + a.v31 * b.v12 + a.v32 * b.v22 + a.v33 * b.v32;<BR>
  r.v33 := a.v30 * b.v03 + a.v31 * b.v13 + a.v32 * b.v23 + a.v33 * b.v33;<BR>
---------------------------------finished----------------------------------<BR>
igor has connected.<BR>
Bruce says, "hi Igor!"<BR>
igor waves.<BR>
Bruce says, "I should be *this* close to beig done with your code"<BR>
igor says, "So, do we have Fast&Furious rendering enabled?  :-)"<BR>
Bruce says, "OK, so where is it you pass a vector to something that wants a collection?"<BR>
igor says, "Well, there's the csg-union..."<BR>
igor says, "And I'd like to have a vector of lights."<BR>
igor says, "Other than that, though, I think I'm all good..."<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 </dev/null<BR>
lexed : #()<BR>
<BR>
output: #()<BR>
<BR>
Expected an instance of {the class <collection>}, but got {an instance of <vector3D>}<BR>
Aborted (core dumped)<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "the vector of lights is a real vector -- it can be any length"<BR>
igor says, "Are you missing a whatever[2] index somewhere?"<BR>
Bruce says, "same goes for the CDG thjingie, although I suspect you'd be better off limiting that to length 2"<BR>
Bruce says, "i just check in -- check it out and have a look"<BR>
Bruce says, "er, I *have* just checked in"<BR>
igor hmms.<BR>
Bruce says, "ah ha!  I just spotted something in ntersection.dylan"<BR>
igor says, "That's good, as I hadn't really gotten farther than "emacs &", actually..."<BR>
Bruce says, "there are a bunch of indexing into vector things there that I missed"<BR>
igor nods.<BR>
Bruce says, "just a moment..."<BR>
Bruce is compilig<BR>
Bruce says, "check out the new code in matrix.dylan"<BR>
Bruce says, "FUCK ME DEAD!!!"<BR>
Bruce says, "it's gone from 38 seconds to 1 second!"<BR>
igor says, "AWESOME!!!"<BR>
Bruce says, "... even better, it still works :-)"<BR>
igor says, "That's really, really excelleng!"<BR>
igor says, "er, excellent"<BR>
Bruce says, "it's checked in"<BR>
igor says, "Cool."<BR>
igor <- compiling.<BR>
igor grins.  We're back to waiting for d2c again, instead of our own program...<BR>
Bruce says, "Gabor is using the Apple Technology Release to do his development"<BR>
Bruce says, "on his PowerBook he's getting 3 second turn-around times"<BR>
igor says, "Nifty!"<BR>
Bruce says, "can you confirm that it works?"<BR>
-----------------------------------igor------------------------------------<BR>
real    0m2.049s<BR>
user    0m1.870s<BR>
sys     0m0.050s<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "and the image is correct?"<BR>
igor says, "As correct as when I left it..."<BR>
Bruce says, "YES!!!!!!"<BR>
Bruce says, "damn good timing, too.  Did you sleep well?"<BR>
igor says, "Very, very nicely done."<BR>
igor hands out the cigars.<BR>
igor says, "Yep."<BR>
igor says, "OK, now that the renderer is fast, we really need to hook the interpretter into it so that I can avoid needing to recompile the whole program everytime I want to move a plane around or something..."<BR>
Bruce says, "yes.  except.  I need to sleep now."<BR>
igor grins.<BR>
gabor_[Guest] says, "that is why I am for"<BR>
igor says, "OK, so gabor and I will get that done next."<BR>
igor says, "Then I'll go back to working on the ray-tracer."<BR>
Bruce says, "OK"<BR>
gabor_[Guest] says, "look into graphicspimitives"<BR>
igor says, "20 seconds to render a 256x256 image on my system."<BR>
Bruce says, "feel free to rip all that slow <vector> and <matrix> shit out of matrix.dylan.  You don't need it now. :-)"<BR>
Bruce says, "just cruise with <vector3D> and <transform>"<BR>
igor says, "(and act which requires ~100 ray-casts)"<BR>
igor says, "er, 100,000"<BR>
igor nods.  Excellent.<BR>
gabor_[Guest] says, "put <vector3D> in Engine.dylan replacing <point>?"<BR>
igor says, "Well, vector3D is actually a 4-dimensional vector, which might make things a bit confusing..."<BR>
Bruce says, "make one from the other as necessary, bunging a 1.0 on the end..."<BR>
Bruce says, "... or calling "homogonize" as the ccase may be"<BR>
igor schleps all the <matrix> stuff into a Big Block o' Comments<BR>
gabor_[Guest] says, "have to do elsething now, one of you?"<BR>
igor [to gabor_[Guest]]: Just a sec...  Let me clean this up first...<BR>
Bruce says, "ICFP homepage is back up again"<BR>
igor [to gabor_[Guest]]: OK, what's up?<BR>
gabor_[Guest] says, "lets implant <vector3D> into the compiler"<BR>
igor says, "OK...  Perhaps it'd be best for me to start by sticking the appropriate function calls into the graphics-primitive() macro..."<BR>
gabor_[Guest] says, "no, just override the primitive you want, just in the style of #"if""<BR>
igor scratches his head.<BR>
gabor_[Guest] says, "look at compile-one(token == #"if", ...)"<BR>
gabor_[Guest] says, "in Engine.dylan"<BR>
gabor_[Guest] says, "the inner method gets passed the top of the stack and returns the modified stack to the continuation that has been compiled before"<BR>
igor says, "Ah..."<BR>
igor says, "So does that graphics-primitive() macro work at all?"<BR>
gabor_[Guest] says, "not yet. It is just a placeholder. We will see from the usage patterns how it has to be used."<BR>
igor nods.<BR>
gabor_[Guest] says, "do not forget to comment out the placeholder you want to implement"<BR>
igor says, "What's the type for an array?"<BR>
gabor_[Guest] says, "I opt for "define graphics-primitive plane(left :: <type>, right, other :: <integer>) make(<plane>) end plane;""<BR>
gabor_[Guest] says, "after we have something working, I add the macro"<BR>
igor is writing out "render"...<BR>
gabor_[Guest] says, "cool. what are the parameters?"<BR>
Bruce says, "OK, chaps, it's coming up for 0400 local time and I am outta here.  Expect me back around noon....  (20:00 EDT, 24:00 UTC)"<BR>
igor grins and waves.<BR>
igor [to Bruce]: Thanks for the speed...<BR>
Bruce is catching some zzzzzzzz<BR>
gabor_[Guest] says, "by Bruce"<BR>
gabor_[Guest] says, "I meant BYE"<BR>
-----------------------------------igor------------------------------------<BR>
define method compile-one(token == #"render", more-tokens :: <list>) => (closure :: <function>, remaining :: <list>);<BR>
  let (cont, remaining) = more-tokens.compile-GML;<BR>
  values(<BR>
         method(stack :: <pair>, env :: <function>) => new-stack :: <list>;<BR>
           let (amb :: <point>, rest :: <pair>) = values(stack.head, stack.tail);<BR>
           let (lights :: <array>, rest :: <pair>) = values(rest.head, rest.tail);<BR>
           let (obj :: <obj>, rest :: <pair>) = values(rest.head, rest.tail);<BR>
           let (depth :: <integer>, rest :: <pair>) = values(rest.head, rest.tail);<BR>
           let (fov :: <fp>, rest :: <pair>) = values(rest.head, rest.tail);<BR>
   let (wid :: <integer>, rest :: <pair>) = values(rest.head, rest.tail);<BR>
   let (ht :: <integer>, rest :: <pair>) = values(rest.head, rest.tail);<BR>
   let (file :: <string>, rest :: <list>) = values(rest.head, rest.tail);<BR>
<BR>
   let amb-color = make(<color>, red: amb.x, green: amb.y, blue: amb.z);<BR>
<BR>
           render-image(obj, depth, file, amb-color, lights, wid, ht, fov);<BR>
         end method,<BR>
         remaining)<BR>
end;<BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "after render-image write: cont(rest, env)"<BR>
igor nods.<BR>
gabor_[Guest] says, "now try to test it with a small program"<BR>
gabor_[Guest] says, "GML program"<BR>
igor nods.<BR>
gabor_[Guest] says, "maybe you have to implement "cube" too"<BR>
igor has only gotten spheres and planes working, as yet...<BR>
igor says, "Hmm...  What would generate these args:"<BR>
igor hmms.  Yeah, I do need to make sphere happen first here, eh?<BR>
gabor_[Guest] says, "a sphere than. no pops this time, but cont(pair(new-sphere, stack), env)"<BR>
igor will ignore the fact that sphere requires a surface function.<BR>
igor says, "OK..."<BR>
jon.dyte [Guest] has connected.<BR>
igor says, "How do I make an empty array?"<BR>
igor says, "Ah.  []"<BR>
igor says, "no symbol #"sphere" in environment ?"<BR>
gabor_[Guest] says, "this is it: comment out dummy and specialize compile-one on it"<BR>
igor already did so, though:<BR>
gabor_[Guest] says, "Hmmm. It should say "Error: primitive undefined""<BR>
-----------------------------------igor------------------------------------<BR>
define method compile-one(token == #"sphere", more-tokens :: <list>) <BR>
 => (closure :: <function>, remaining :: <list>);<BR>
  let (cont, remaining) = more-tokens.compile-GML;<BR>
  values(<BR>
 method(stack :: <pair>, env :: <function>) => (new-stack :: <list>)<BR>
     // XXX: need to retrieve surface function here!<BR>
     let new-sphere = make(<sphere>);<BR>
     new-sphere.surface-interpreter-entry := red-texture;<BR>
     cont(pair(new-sphere, stack), env);<BR>
 end method,<BR>
 remaining)<BR>
end;<BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "looks good"<BR>
gabor_[Guest] says, "what does it say on cube? also no symbol #"cube" in environment?"<BR>
gabor_[Guest] says, "then something is wrong"<BR>
igor hasn't tried cube yet.<BR>
igor says, "For one thing, I haven't implemented cube yet in the renderer..."<BR>
gabor_[Guest] says, "it should say error!"<BR>
You hear a quiet popping sound; Karl-Heinz_Guest has disconnected.<BR>
igor says, "Ah...  Got it..."<BR>
gabor_[Guest] says, "I am almost ready with the macro :-)"<BR>
igor says, "It was messing up because graphics-primitives wasn't in the lid."<BR>
igor says, "hmm... How do we bridge the gap between the GML-compiler module and the renderer module?"<BR>
gabor_[Guest] says, "perhaps do a forward export in the engine module?"<BR>
gabor_[Guest] says, "that gets filled in the importing module?"<BR>
igor begins the process of beating the ray-tracer back into its own module...<BR>
gabor_[Guest] says, "you can use the create clause in the module definition if that helps"<BR>
andreas has connected.<BR>
andreas says, "Hi!"<BR>
igor says, "Good morning."<BR>
andreas says, "Boy, is the raytracer fast!"<BR>
andreas says, "The new matrix code is impressive."<BR>
igor thanks Bruce profusely for that one...<BR>
andreas says, "One thing I noticed:"<BR>
----------------------------------andreas----------------------------------<BR>
define method negative(v :: <vector3D>)<BR>
 => (negation :: <vector3D>);<BR>
  vector3D(-v.x, -v.y, -v.z, -v.w);<BR>
end method;<BR>
---------------------------------finished----------------------------------<BR>
igor says, "Oops!"<BR>
igor says, "-v.w shouldn't be there..."<BR>
igor says, "Mind you, you oughtn't be negating points anyhow..."<BR>
andreas says, "Yes, that were my thoughts as well."<BR>
andreas says, "Next thing, the challengs says we should use double-floats, but we use single-floats everywhere."<BR>
igor . o O ( $origin - point + $origin )<BR>
igor says, "Well, actually that got (mostly) fixed..."<BR>
igor says, "with <fp>"<BR>
igor notes that <fp> should go in a more useful module...<BR>
andreas says, "Yes, but our constants are all single-float. We have to write 0.0d0 instead of 0.0 everywhere."<BR>
igor . o O ( Doh! )<BR>
andreas says, "Oh yes, and point + $origin isn`t allowed either..."<BR>
igor says, "Yes, but ($origin - point) + $origin is..."<BR>
andreas says, "True. I think if I had to rewrite all this, I would make points and vectors separate types."<BR>
igor actually likes them combined...<BR>
andreas says, "Anyways, I`m still at work and not supposed to be here. Just wanted to let you know that I`m impressed by the progress. I`ll be back later this evening..."<BR>
andreas waves.<BR>
You hear a quiet popping sound; andreas has disconnected.<BR>
gabor_[Guest] [to ]: igor<BR>
igor says, "hmm?"<BR>
gabor_[Guest] says, "check out graphics prims. you will see some sugar there"<BR>
igor says, "sec..."<BR>
gabor_[Guest] says, "the arrows point to the top of the stack..."<BR>
gabor_[Guest] says, "there is a cleaned-up version now"<BR>
gabor_[Guest] says, "now I am writing the zero-param primitives"<BR>
gabor_[Guest] [to igor]: all is right<BR>
gabor_[Guest] says, "?"<BR>
igor returns.<BR>
igor has all finished separating things out into modules.<BR>
gabor_[Guest] says, "nullaries also checked in"<BR>
gabor_[Guest] says, "if you say it works, I begin with the optimizing compiler"<BR>
igor says, "Just a moment..."<BR>
igor rebuilds.<BR>
igor forgot to put the args in reverse order in render...<BR>
gabor_[Guest] says, "use the same order as in the task.pdf"<BR>
igor says, "No...  because 'filename' is at the top of the stack, I need to pop it off first."<BR>
gabor_[Guest] says, "the macro already pops it for you"<BR>
igor hasn't rewrote it to use the macro yet...  I'm still trying to make it work manually...<BR>
gabor_[Guest] says, "you should have no access to the stack in the body!"<BR>
igor says, "er, rewritten"<BR>
igor says, "What type are arrays/lists in the GMT system?"<BR>
gabor_[Guest] says, "array = <simple-object-vector>"<BR>
igor nods.<BR>
igor sees the problem.<BR>
igor says, "OK, it works without the macros..."<BR>
igor adjusts this to use macros...<BR>
igor says, "Very nice macro, BTW..."<BR>
igor has yet to discover the Zen of dylan macros...<BR>
igor says, "Certainly seems to work..."<BR>
igor says, "Cool.  I like it."<BR>
gabor_[Guest] says, "fine, I like them too :-)"<BR>
igor hmms.  How do you determine whether to push the result onto the stack or not?<BR>
gabor_[Guest] says, "now you should be on your way."<BR>
gabor_[Guest] says, "always push the result of the block"<BR>
gabor_[Guest] says, "if you need non-resultant ones, we can do so."<BR>
igor says, "OK, I'll just make sure that my code returns () where appropriate."<BR>
gabor_[Guest] says, "I guess you need them :-)"<BR>
igor says, "Well, 'render' has no result."<BR>
gabor_[Guest] says, "that will not work. That means implicit #f"<BR>
igor says, "Doh..."<BR>
gabor_[Guest] says, "I am at work implementing"<BR>
igor says, "That's the only one, though."<BR>
igor gets his reorganization checked in...<BR>
gabor_[Guest] says, "it is render, isnt it?"<BR>
igor says, "Yes."<BR>
-----------------------------------igor------------------------------------<BR>
define graphics-primitive render(     amb :: <point> <BR>
   => lights :: <vector><BR>
   => obj :: <obj><BR>
   => depth :: <integer><BR>
   => fov :: <fp><BR>
   => wid :: <integer><BR>
   => ht :: <integer><BR>
   => file :: <string>)<BR>
  let amb-color = make(<color>, red: amb.x, green: amb.y, blue: amb.z);<BR>
<BR>
  let fov-radians = fov * $double-pi / 180.0;<BR>
<BR>
  render-image(obj, depth, file, amb-color, lights, wid,<BR>
       ht, fov);<BR>
end graphics-primitive render;<BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "consumers checked in"<BR>
igor nods.<BR>
gabor_[Guest] says, "define graphics-primitive render(     amb :: <point> "<BR>
igor nods.  Got it.<BR>
gabor_[Guest] says, "how do I paste?"<BR>
igor says, "@paste"<BR>
gabor_[Guest] says, "OH, I wrot $paste"<BR>
igor says, "The ; should be optional after the => (), eh?"<BR>
igor adjusts the macro accordingly.<BR>
-------------------------------gabor_[Guest]-------------------------------<BR>
define graphics-primitive render(     amb :: <point> <BR>
   => lights :: <vector><BR>
   => obj :: <obj><BR>
   => depth :: <integer><BR>
   => fov :: <fp><BR>
   => wid :: <integer><BR>
   => ht :: <integer><BR>
   => file :: <string>) => ();<BR>
  let amb-color = make(<color>, red: amb.x, green: amb.y, blue: amb.z);<BR>
<BR>
  let fov-radians = fov * $double-pi / 180.0;<BR>
<BR>
  render-image(obj, depth, file, amb-color, lights, wid,<BR>
       ht, fov);<BR>
end graphics-primitive render;<BR>
---------------------------------finished----------------------------------<BR>
igor wonders why it no longer works when he puts a ; now... :-P<BR>
igor says, "Exactly what I have now."<BR>
gabor_[Guest] says, "semis are needed in normal methods too, so leave them in"<BR>
igor says, "Not in Gwydion Dylan (or Fun-O) they aren't..."<BR>
gabor_[Guest] says, "you can write an auxiliary pattern..."<BR>
gabor_[Guest] says, "having two versions"<BR>
igor just didn't understand why the ; wasn't treated as part of the body...<BR>
igor shrugs.  I don't actually *care* all that much<BR>
igor says, "OK, I'll wire up the rest of the renderer to the interpretter..."<BR>
igor says, "Perhaps the surface-function rig should be the next step."<BR>
gabor_[Guest] says, "you get a function as <function> accepting a stack and resulting a new stack (stacks are <list>s)"<BR>
igor says, "Do functions work properly?"<BR>
gabor_[Guest] says, "you probably want to pass the function args in. "<BR>
gabor_[Guest] says, "I hope so!"<BR>
gabor_[Guest] says, "#"if" uses them already"<BR>
igor says, "Good, good :-)"<BR>
gabor_[Guest] says, "#"apply" too :-)"<BR>
igor hmms.<BR>
igor turn on debugging...<BR>
jon.dyte [Guest] has connected.<BR>
gabor_[Guest] says, "there should be nothing to debug :-)"<BR>
igor says, "Yes, well..."<BR>
igor keeps getting an 'expected exactly 2 args, got 4' error...<BR>
igor says, "Appears to come from compile-one somewhere..."<BR>
igor sighs at lex-gml taking a src :: <stream> arg, then ignoring it and using *standard-input* :-P<BR>
gabor_[Guest] says, "still a problem?"<BR>
igor says, "Hmm... it actually seems to come from ray_tracerZmake_surface_closure..."<BR>
igor says, "Ah..."<BR>
jon.dyte [Guest] q<BR>
You hear a quiet popping sound; Karl-Heinz_Guest has disconnected.<BR>
igor says, "OK, return-color (in color.dylan) expects to call the surface closure like so:"<BR>
igor says, "interpreter-entry(surface-id, u, v);"<BR>
igor says, "(and it wants 4 resultant values)"<BR>
igor says, "Hmm... Or maybe that's not it..."<BR>
igor tries something else...<BR>
igor turns off the surface-texturing for a sec, and tries again.<BR>
igor says, "Yep.  OK..."<BR>
igor says, "Hard-coding the function works, but using the provided function fails."<BR>
jon.dyte [Guest] has connected.<BR>
igor says, "(hard coding to blue-texture, say)"<BR>
igor glances nervously at the clock.<BR>
jon.dyte [Guest] says, ""Hi ; how do you check out the comp src ? cvs co <some-name-here>?""<BR>
gabor_[Guest] says, "du you call the function you popped from the stack?"<BR>
gabor_[Guest] says, "Andreas can tell you in an hour"<BR>
igor nods.  I imagine I give it the wrong args, though...<BR>
jon.dyte [Guest] says, "ok,""<BR>
igor [to jon.dyte [Guest]]: cvs -d':pserver:user@berlin.ccs.de:/home/cvsroot' co ICFP2000<BR>
gabor_[Guest] says, "pass it a stack: "list(last-arg, prev-arg, front-arg)""<BR>
igor tries that...<BR>
igor says, "What will I get back?"<BR>
igor says, "Another list, eh?"<BR>
gabor_[Guest] says, "a stack with the results"<BR>
jon.dyte [Guest] glances nervously at the clock.<BR>
-----------------------------------igor------------------------------------<BR>
      let return-stack = interpreter-entry(list(v, u, surface-id));<BR>
<BR>
      let (phong, return-stack) = cont(return-stack);<BR>
      let (specular, return-stack) = cont(return-stack);<BR>
      let (diffusion, return-stack) = cont(return-stack);<BR>
      let (color, return-stack) = cont(return-stack);<BR>
---------------------------------finished----------------------------------<BR>
igor says, "Will that work?"<BR>
gabor_[Guest] says, "no"<BR>
igor says, "How should I be doing that, then?"<BR>
gabor_[Guest] says, "from the primitive you call your renderer function, yes?"<BR>
gabor_[Guest] says, "you have to pass another function to the renderer?"<BR>
gabor_[Guest] says, "that will be called with four args, returning one?"<BR>
igor says, "During the rendering process, several candidate points may be found.  We only need to calculate the color of the closest one, so this returns a closure to call,"<BR>
gabor_[Guest] says, "then pass "method(one, two, three, four) pair(list(one, two, three, four).popped-function, #() end method" to the renderer"<BR>
gabor_[Guest] says, "show me the render primitive"<BR>
igor says, "I want to be able to do this:"<BR>
igor says, "let (color, diffusion, specular, phong) = surface-function(arg1, arg2, arg3)"<BR>
gabor_[Guest] says, "from where do you call that surface-function"<BR>
gabor_[Guest] says, "?"<BR>
igor says, "It gets called from the return-color function in color.dylan, which uses it to build a <surface> object, which it returns to tracer, a local method of get-tracer."<BR>
gabor_[Guest] says, "how do you write it in GML?"<BR>
gabor_[Guest] says, "I fear we are talking about different things here..."<BR>
-----------------------------------igor------------------------------------<BR>
1.0 1.0 1.0 point     % White ambient light<BR>
[]                    % No other lights<BR>
<BR>
{ 1.0 0.0 0.0 point   % Red surface<BR>
  1.0                 % Full diffusion coef<BR>
  0.0                 % No specular<BR>
  0.0                 % No phong, either<BR>
} sphere <BR>
1                     % depth<BR>
90.0                  % FOV<BR>
256                   % width<BR>
256                   % height<BR>
"result.ppm"          % filename<BR>
render<BR>
---------------------------------finished----------------------------------<BR>
igor says, "the function just before 'sphere' is what I need."<BR>
igor notes that that function should probably pop off three args, first...<BR>
igor says, "OK, this is better:"<BR>
gabor_[Guest] says, "OK, it pushes three, then makes a point. then again pushes three so there are four"<BR>
-----------------------------------igor------------------------------------<BR>
{ /u /v /face         % ignore the args<BR>
  1.0 0.0 0.0 point   % Red surface<BR>
  1.0      % Full diffusion coef<BR>
  0.0      % No specular<BR>
  0.0      % No phong, either<BR>
} sphere <BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "takes trhee, leaves four"<BR>
igor nods.<BR>
igor needs to be able to call that from within color.dylan<BR>
gabor_[Guest] says, "then pass "method(one, two, three) let (r1, r2, r3, r4) = list(one, two, three).popped-function; list(r1, r2, r3, r4) end method" to the renderer"<BR>
gabor_[Guest] says, "this will make a perfect surface-function"<BR>
gabor_[Guest] says, "you can decorate it with type-checks"<BR>
gabor_[Guest] says, "err, declarations"<BR>
igor grins.<BR>
gabor_[Guest] says, "works now?"<BR>
igor hmms.<BR>
igor tries to track down the next problem...<BR>
igor gets:<BR>
-----------------------------------igor------------------------------------<BR>
No applicable methods in call of {the <generic-function> *} when given arguments:<BR>
  #[#f, {an instance of <color>}]<BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "you try to multiply #f with a color?"<BR>
igor says, "Apparently.  I'm not sure where the #f is coming from, though..."<BR>
gabor_[Guest] says, "maybe we should write a packer-unpacker macro for the impedance matching"<BR>
gabor_[Guest] says, "from arg-oriented to stack oriented"<BR>
igor says, "Ah... there's the problem."<BR>
-----------------------------------igor------------------------------------<BR>
      let (color, diffusion, specular, phong) = interpreter-entry(list(v, u, surface-id));<BR>
<BR>
      format-out("Got %=, %=, %=, %=\n", color, diffusion, specular,<BR>
 phong);<BR>
      force-output(*standard-output*);<BR>
<BR>
=><BR>
Got #(0.0d0, 0.0d0, 1.0d0, {<point> instance}), #f, #f, #f<BR>
---------------------------------finished----------------------------------<BR>
igor says, "It returns a list...  I need it to return multiple values, or take apart the list to get the elements."<BR>
gabor_[Guest] says, "just return a <sphere> from the primitive!"<BR>
igor says, "no, no...  This isn't when building the sphere..."<BR>
igor says, "This when calling the surface function that goes into the sphere"<BR>
gabor_[Guest] says, "take apart the list by "let (r1, r2, r3, r4) = apply(values, the-result-stack);""<BR>
igor notes that the 'color' bit is not going to work until the engine is converted to speak <vector3D>s...<BR>
You hear a quiet popping sound; Karl-Heinz_Guest has disconnected.<BR>
igor tries it again.<BR>
gabor_[Guest] says, "you have to normalize the vector3d before passing it to a color!"<BR>
igor says, "Homogenize, yes..."<BR>
igor says, "So, other than lights and colors, what are points used for?"<BR>
gabor_[Guest] says, "only if w!=1.0"<BR>
gabor_[Guest] says, "err, w ~== 1.0"<BR>
gabor_[Guest] says, "or is Homogenize inline?"<BR>
gabor_[Guest] says, "should be"<BR>
igor shrugs.<BR>
gabor_[Guest] says, "for specifying positions -- dunno"<BR>
gabor_[Guest] says, "seems to work..."<BR>
igor tries yet again...<BR>
igor thinks he's almost gotten it...<BR>
igor yays.  No more crashing :-)<BR>
igor says, "Yay!  It works :-)"<BR>
igor writes some transform-y stuff so he can actually get more than a Big Screen of Red...<BR>
gabor_[Guest] says, "tell me what pattern occures often when packaging/unpackaging!"<BR>
igor really only has to do that once...<BR>
igor says, "And it's not that bad, even: let (phong, specular, diffusion, color) = apply(values, interpreter-entry(list(v, u, surface-id)));"<BR>
gabor_[Guest] says, "it will appear more ofthen ;-)"<BR>
igor says, "Why?"<BR>
igor says, "I only have one place where I callback to the interpreter..."<BR>
gabor_[Guest] says, "you sure?"<BR>
igor says, "Yay!!!  I now have a red circle sitting in the middle of the screen :-)"<BR>
gabor_[Guest] says, "do you think it makes sense to memoize the values returned by that color function? Or do you only call it once?"<BR>
igor says, "It's already being done."<BR>
igor says, "(and I should only call it once, anyhow)"<BR>
igor just checked a whole mess o' stuff in.<BR>
gabor_[Guest] [to igor]: I think I need sleep.<BR>
igor grins.<BR>
gabor_[Guest] says, "all is OK?"<BR>
igor says, "OK, I'll see you in a bit."<BR>
igor nods.<BR>
igor's working on reflection, ATM.<BR>
igor says, "Want to see a picture or something?"<BR>
gabor_[Guest] says, "do you have an url?"<BR>
igor says, "Just a sec..."<BR>
gabor_[Guest] says, "the GML optimizer is almost ready. The simplifier works smoothly."<BR>
igor says, "Cool!"<BR>
gabor_[Guest] says, "the partial evaluator is todo."<BR>
igor says, "<A HREF="http://secret-lab.dartmouth.edu/~igor/test.pnm" TARGET="_blank">http://secret-lab.dartmouth.edu/~igor/test.pnm</A>"<BR>
-----------------------------------igor------------------------------------<BR>
{ /v /u /face         % ignore the args<BR>
  0.0 0.0 1.0 point   % color<BR>
  1.0      % Full diffusion coef<BR>
  0.0      % No specular<BR>
  0.0      % No phong, either<BR>
} /red<BR>
<BR>
{ /v /u /face         % ignore the args<BR>
  1.0 0.0 0.0 point   % color<BR>
  1.0      % Full diffusion coef<BR>
  0.0      % No specular<BR>
  0.0      % No phong, either<BR>
} /blue<BR>
<BR>
red sphere 0.3 uscale /s<BR>
blue plane 0.0 -0.5 0.0 translate /p<BR>
<BR>
0.0 -1.0 0.0 point    % straight down<BR>
1.0 1.0 1.0 point     % white<BR>
light /sun<BR>
<BR>
0.5 0.5 0.5 point     % dim ambient light<BR>
[ sun ]       <BR>
s p union<BR>
1       % depth<BR>
90.0      % FOV<BR>
256      % width<BR>
256      % height<BR>
"result.ppm"      % filename<BR>
render<BR>
---------------------------------finished----------------------------------<BR>
In the distance you hear someone's alarm clock going off.<BR>
Horst_Guest undergoes a wrenching personality shift.<BR>
You hear a quiet popping sound; Horst_Guest has disconnected.<BR>
Karl-Heinz_Guest has connected.<BR>
>> Karl-Heinz_Guest is now known as gabor_[Guest].<BR>
igor [to gabor_[Guest]]: Can you view PNMs?<BR>
igor says, "(and did you get that URL?)"<BR>
gabor_[Guest] says, "I flew out"<BR>
gabor_[Guest] says, "please again."<BR>
igor says, "<A HREF="http://secret-lab.dartmouth.edu/~igor/test.pnm" TARGET="_blank">http://secret-lab.dartmouth.edu/~igor/test.pnm</A>"<BR>
igor says, "I can @paste the code that produced it..."<BR>
-----------------------------------igor------------------------------------<BR>
{ /v /u /face         % ignore the args<BR>
  0.0 0.0 1.0 point   % color<BR>
  1.0      % Full diffusion coef<BR>
  0.0      % No specular<BR>
  0.0      % No phong, either<BR>
} /red<BR>
<BR>
{ /v /u /face         % ignore the args<BR>
  1.0 0.0 0.0 point   % color<BR>
  1.0      % Full diffusion coef<BR>
  0.0      % No specular<BR>
  0.0      % No phong, either<BR>
} /blue<BR>
<BR>
red sphere 0.3 uscale /s<BR>
blue plane 0.0 -0.5 0.0 translate /p<BR>
<BR>
0.0 -1.0 0.0 point    % straight down<BR>
1.0 1.0 1.0 point     % white<BR>
light /sun<BR>
<BR>
0.5 0.5 0.5 point     % dim ambient light<BR>
[ sun ]       <BR>
s p union<BR>
1       % depth<BR>
90.0      % FOV<BR>
256      % width<BR>
256      % height<BR>
"result.ppm"      % filename<BR>
render<BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "obviously cannot. Gif?"<BR>
igor says, "24h left in the contest..."<BR>
igor says, "K."<BR>
igor says, "<A HREF="http://secret-lab.dartmouth.edu/~igor/test.gif" TARGET="_blank">http://secret-lab.dartmouth.edu/~igor/test.gif</A>"<BR>
gabor_[Guest] this is marvellous!<BR>
igor says, "Isn't it pretty?"<BR>
igor says, "Now I need to make it reflect..."<BR>
gabor_[Guest] says, "fantastic!"<BR>
igor says, "Then I can start working on all the little extra features..."<BR>
gabor_[Guest] says, "how much of tier1 do we have now?"<BR>
igor says, "Everything but reflections, I believe..."<BR>
igor says, "(and proper error handling)"<BR>
gabor_[Guest] says, "does rebinding of a graphics primitive work "false /cylinder"?"<BR>
igor hmms.<BR>
gabor_[Guest] says, "it should result in a compiler error"<BR>
-----------------------------------igor------------------------------------<BR>
secret-lab:~/src/ICFP2000/src$ ./icfp2000 -<BR>
false /cylinder<BR>
false /sphere<BR>
cannot rebind reserved word 'cylinder'<BR>
Aborted (core dumped)<BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "tat is perfect. we have to call report-condition on the <simple-error> (use block) set status to 1!"<BR>
gabor_[Guest] says, "please do it now, otherwise we forget it!!!"<BR>
igor scratches his head.<BR>
igor adds it to the 'todo' list instead, and lets Bruce worry about it when he wakes up...<BR>
jon.dyte [Guest] has connected.<BR>
gabor_[Guest] says, "who is jon.dyte"<BR>
igor dunnos.<BR>
gabor_[Guest] says, "see you tomorrow"<BR>
igor waves.<BR>
You hear a quiet popping sound; Karl-Heinz_Guest has disconnected.<BR>
You hear a quiet popping sound; Paul_Guest has disconnected.<BR>
Bruce is rubbing his eyes and yawning<BR>
igor says, "Good morning..."<BR>
igor glances nervously at the clock.<BR>
Bruce says, "into the last 24 hours we go"<BR>
Bruce says, "I've got 9 pages of your guys conversation here to read (printed)"<BR>
Bruce says, ".. and I jjust looked at a .gif on your web pages."<BR>
igor grins.<BR>
Bruce says, "checked out the source"<BR>
Bruce says, "wow!  main is small now"<BR>
igor says, "We got the interpretter bolted onto the renderer quie nicely now..."<BR>
Bruce fixes checkout conflicts<BR>
Bruce says, "hmm.  make test fails"<BR>
Bruce says, "No element 0 in #[]"<BR>
igor says, "Oh, I'll check in the fix for that..."<BR>
Bruce OK.  I'll just take a couple of minutes to read the idle_chat<BR>
igor nods.<BR>
igor says, "OK, try now..."<BR>
Bruce says, "that works"<BR>
Bruce says, "but it's just a b;ack ball on a black plane with a blue background"<BR>
igor says, "hmm?"<BR>
igor says, "Ah, right..."<BR>
igor says, "What gml file are you using?"<BR>
Bruce says, "I'm ust doing 'make test'"<BR>
igor says, "Ah..."<BR>
Bruce says, "... whch hsan't changed since I last saw it"<BR>
igor says, "That doesn't really do anything useful anymore..."<BR>
Bruce says, "so what does?"<BR>
igor says, "OK, update, then try "./icfp2000 test-render.gml""<BR>
igor says, "(or update again and 'make test')"<BR>
Bruce says, "so lets put that in the makefile??"<BR>
igor just did.<BR>
Bruce says, "OK ... red ball, blue surface.  LIght is behind and above the ball -- prolly 30 deg up"<BR>
igor says, "Nope, light is directly above ball, actually..."<BR>
Bruce says, "can't be"<BR>
Bruce says, "unless the gamma is all screwed up"<BR>
igor says, "The plane is at y=-.5, the ball is 0.3 radius, at the origin."<BR>
igor says, "The light is pointing in the (0, -1, 0) direction (straight down)"<BR>
Bruce says, "must be a dim light, or something. Only a sliver at the top of the ball is bright"<BR>
igor says, "The sphere has a low diffusion coef."<BR>
igor was trying to tweak the specular stuff....<BR>
Bruce says, "Oh, OK."<BR>
Bruce says, "Niiice, anyway"<BR>
Bruce says, ".. and it's taking 177 uS per pixel on my machine!!!  5600 pixels/second"<BR>
igor says, "We need 3 things to be fully Tier-I compliant."<BR>
Bruce says, "that's actually even slightly faster than when I went to bed (was 4000 pix/sec then)"<BR>
igor says, "#1 Reflection"<BR>
igor says, "#2 Specular highlights"<BR>
igor says, "#3 Proper error handling in both the parser and the runtime."<BR>
A small swarm of 3x5 index cards arrives, engulfs igor, and carries it away.<BR>
A small swarm of 3x5 index cards blows in and disperses, revealing igor.<BR>
A small swarm of 3x5 index cards arrives, engulfs igor, and carries it away.<BR>
A small swarm of 3x5 index cards blows in and disperses, revealing igor.<BR>
Bruce says, "no one updated negative(<vector>)??"<BR>
Bruce says, "I'll just make w -ve, not the rest.  faster than changing the others :-)"<BR>
Bruce says, "should really also sep vector and point.  "<BR>
igor says, "No, I rather like them combined, actually..."<BR>
-----------------------------------Bruce-----------------------------------<BR>
pt + vec -> pt<BR>
vec + vec -> vec<BR>
pt + pt -> ERROR<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, ".. and the corresponding subtractions"<BR>
igor says, "Well, perhaps a quick check to make sure at least one of the ws in the operation is 0.0..."<BR>
igor says, "As for -ion, why shouldn't they all be valid?"<BR>
Bruce hmmms<BR>
igor says, "pt - pt -> vector..."<BR>
Bruce says, "vec - pt doesn't make sense"<BR>
igor but pt - vec does...<BR>
Bruce says, "he you tried it on the example programs?"<BR>
igor says, "No, not yet..."<BR>
Bruce says, "spheres.gml looks promising"<BR>
igor watches it crunch...<BR>
Bruce says, "uh oh -- we've got the same file for spheres and spheres2.  My bad..."<BR>
igor nods.<BR>
igor hmms.  They're the wrong sizes...<BR>
Bruce is download the new and corrected .gmls and .ppms<BR>
igor nods.<BR>
igor hmms...<BR>
Bruce says, ".. over 56K modem and cvs'ing them back via 56K modem :-)"<BR>
igor says, "Their spheres and mine seem pretty much identical, but theirs are bigger for some reason..."<BR>
Bruce says, "our image is showing *much* wider angle"<BR>
Bruce says, ".. theirs just shows a little of the shadow, ours shows lots"<BR>
Bruce says, "our shadows are a little darker, too, I think"<BR>
igor nods.<BR>
Bruce says, "the shadow brightness won't matter, if the positioning is the same"<BR>
Bruce says, "It's a FOV problem"<BR>
igor nods.<BR>
Bruce attempts to convert example .ppms to binary in the cvs<BR>
igor grins.<BR>
Bruce says, "my cvs update crashed trying to diff two big image files :-("<BR>
Bruce says, ", er, 'cvs commit'"<BR>
igor says, "Why not just remove the images and view them on the web page, eh?"<BR>
igor says, "Uh-oh..."<BR>
igor says, "Andreas is out of disk space again..."<BR>
Bruce says, "I thought it would be better for us to have local copies so we can do programmed compares..."<BR>
igor nods.<BR>
Bruce says, "also, the web page ones are jpegs which may differ slightly"<BR>
igor nods.<BR>
igor says, "I'll BRB>"<BR>
Bruce says, "oh SIT.  No space on device"<BR>
Bruce says, "SHIT"<BR>
Bruce says, "I'll page andreas"<BR>
Bruce says, "Andreas will be here shortly"<BR>
andreas has connected.<BR>
Bruce says, "hi!"<BR>
andreas says, "Hi..."<BR>
Bruce says, "my bad.  I was checking in some more sample .ppms"<BR>
andreas says, "I did a checkin, and it had no problem..."<BR>
Bruce says, "I didn't know we had no disk!"<BR>
Bruce says, "how much is free?"<BR>
andreas says, "According to df, just over a gigabyte."<BR>
Bruce says, "trying again"<BR>
Bruce says, "again.  Unable to write, file reflect.ppm.   No space left on device"<BR>
Bruce says, "I've got 25.5 GB free here"<BR>
andreas says, "Hm..."<BR>
andreas says, "This is not a disk space problem. But I have no idea what it is."<BR>
andreas says, "Ah, I see. Capacity in /tmp"<BR>
Bruce says, "that'd do it"<BR>
andreas says, "Try again please..."<BR>
Bruce says, "tries again"<BR>
Bruce says, "it worked"<BR>
Bruce says, "how much space in /tmp now?"<BR>
andreas says, "3.5 MB."<BR>
Bruce says, "not much"<BR>
andreas says, "The problem is that cvs uses /tmp instead of /var/tmp, as it should. The latter has plenty of space."<BR>
Bruce says, "is it full, or just small?"<BR>
Bruce says, "can you symlink it?"<BR>
andreas says, "It's the 32MB root partition."<BR>
andreas says, "The admin will kill me if I make /tmp on the root file system a link."<BR>
andreas says, "That makes recovery from single-user-mode much harder."<BR>
Bruce says, "can we convince cvs to use another place?"<BR>
andreas says, "Thinking about that..."<BR>
andreas says, "The 3.5 MB limit is per file, BTW, not for the sum of all files."<BR>
Bruce says, "try setting $TMPDIR"<BR>
Bruce says, "or the -T flag to cvs"<BR>
igor returns.<BR>
andreas says, "Ok, should be fixed."<BR>
Bruce says, "Igor: did you resolve the FOV thing?"<BR>
igor says, "Not yet..."<BR>
Bruce says, "could it be that you're using the specified angle either side of the center, instead of in total?"<BR>
Bruce says, "i.e. try halving it, then do whatever you're already doing"<BR>
igor nods.<BR>
Bruce says, "as a quick hack test"<BR>
igor tries a couple of tests...<BR>
andreas wished that he could have helped this day, but the work kept him busy.<BR>
igor nods.<BR>
igor says, "Are we going to see you at all tomorrow?"<BR>
Bruce says, "it's OK, Andreas, we're getting there..."<BR>
Bruce says, "... except for CSG :-("<BR>
Bruce says, "24 hours to go and we're down to minor stuff"... except for CSG :-("<BR>
andreas says, "I Try to tune in some hours before the end..."<BR>
andreas says, "Way cool."<BR>
andreas says, "Did you measure the time per pixel with the new matrix code?"<BR>
Bruce says, "I get 177 uS hre"<BR>
Bruce says, "5600 pixels per second"<BR>
Bruce says, ".. on igor's test image, at least"<BR>
igor says, "Of course, that's highly dependant on the complexity of the test image, as well as how many objects have a non-0 specular component."<BR>
Bruce says, "the sample spheres.gml takes about 30 seconds.  WOuld have been 15 minutes before :-("<BR>
andreas says, "The csg-union can still be optimized. I'd expect the transformation matrix to be the identity matrix in a lot of cases, as csg-unions are used like cons cells."<BR>
Bruce says, "it'll be slower when more features are implemented, but looking good"<BR>
igor nods.<BR>
andreas says, "Set a flag for matrix-untouched somewhere."<BR>
Bruce says, "igor, have you taken on board that there will only ever be two items in the union, not a full list?"<BR>
Bruce says, "makes CSG difference etc at least *possible*"<BR>
igor says, "I plan, for one thing, to take  "obj1 obj2 union obj3 union" and group them into one <csg-union> if the first union's matrix is the identiy matrix"<BR>
Bruce says, "I wouldn't"<BR>
Bruce says, "you'll turn your trivial hit testing from a tree into a list"<BR>
Bruce says, "taking the time from O(log(n)) to O(n)"<BR>
Bruce says, "I'm assuming here that the CSG-union itself has a bounds sphere, calculateds form the component ones?"<BR>
igor says, "Nope"<BR>
igor says, "I just check one, then the other..."<BR>
Bruce says, "we shoudl change that"<BR>
igor nods.<BR>
igor says, "Later."<BR>
igor says, "After reflection & specular stuff work as specified..."<BR>
Bruce says, "we're counting a bit on the scene building things in a hierachical way, but if it does then we shouldnt' go and destroy that"<BR>
Bruce says, "right.  It's ust an optomization"<BR>
igor nods.<BR>
Bruce says, "but a BIG one"<BR>
Bruce says, "but in the meantime *don't* collapse the structure"<BR>
igor says, "OK..."<BR>
andreas says, "Ok, I'll go to bed now..."<BR>
Bruce says, "for your test cases at the moment it won't matter at all, but I'm expecting to get thrown some *huge* machine-generated scenes"<BR>
andreas winks.<BR>
igor nods.<BR>
Bruce says, "g'night Andreas.  And thanks!"<BR>
igor waves to Andreas.  See ya!<BR>
You hear a quiet popping sound; andreas has disconnected.<BR>
Bruce says, "potential problem for Gabor as well: d2c doens't eliminate tail-calls, so the interpreter will chew through stack like crazy"<BR>
Bruce says, "it's the way it calls cont(...) all the time"<BR>
igor nods.<BR>
Bruce says, "that's the thing I'm the most afriad of at the moment"<BR>
igor thinks the interpreter is doing just fine for speed, really...<BR>
Bruce says, "the speed is fine, yes"<BR>
Bruce says, "but we might depend on the test machine having plenty of swap, i we get hirrible input files"<BR>
igor says, "So, currently I have 'let world-width = 2.0 * tan(fov / 2.0);'"<BR>
igor says, "Removing the 2.0 * bit makes it too big, as does making / 4.0"<BR>
igor says, "OK, so here's my logic..."<BR>
igor says, "Oh, wait a sec..."<BR>
igor says, "Right...  So we want to draw unit-long rays coming from $eye-pos, K?"<BR>
Bruce says, "Igor, I'm going to go and have a shower, and have coffee and breakfast.  I'll ook at it then if you havn't ah-ha'd.  But we need reflections :-)"<BR>
igor nods.<BR>
Bruce back on deck<BR>
Bruce thinks: if negative(<vector3D>) is wrong, then so is scalar product, yes?  If you multiply all components, including w, then it's the same number?<BR>
Bruce <- just copied what was there before, didn't check that it was *correct*<BR>
Bruce comments out negative(<vector3D>) and finds tht it really is used, so puts it back, corected<BR>
Bruce says, ".. and finds that vector3d * float is used too"<BR>
Bruce says, "OK, I think this stuff is all screwed up .. ixing"<BR>
Bruce says, ",er, fixing"<BR>
Bruce says, "we shoudl have some tautologies on the vector math, or something"<BR>
igor says, ":returns."<BR>
Bruce says, "Houston, w have a problem"<BR>
igor says, "hmm?"<BR>
Bruce says, "the vector3D primitives normalize, homogenize and magnitude were screwed"<BR>
Bruce says, "totally"<BR>
Bruce says, "I don't know where the formaulas came from, but I duplicated what was there when I changed it last night"<BR>
Bruce says, "but now the renderer is broken :-("<BR>
igor says, "Doh..."<BR>
Bruce says, "check it out"<BR>
Bruce says, "woo .. www.ccc.de just disappeared and came back"<BR>
Bruce says, "just as a sanity check .. theres *are* homogenious coordinates, right?"<BR>
Bruce says, "the actual point is x/w, y/w, z/w?"<BR>
igor nods.<BR>
igor says, "However, before any math is done, you'd better homogenize them..."<BR>
igor says, "wait...  isn't it x*w, y*w, z*w?"<BR>
Bruce says, "nominally, yes.  But you can usually avoid it"<BR>
igor nods.<BR>
Bruce says, "Check out this and tell me what's wrong with it:"<BR>
Bruce shares a URL...<BR>
  <<A HREF="http://www.ccc.de/cgi-bin/cvsweb/ICFP2000/src/matrix.dylan.diff?r1=1.14&r2=1.15" TARGET="_blank">http://www.ccc.de/cgi-bin/cvsweb/ICFP2000/src/matrix.dylan.diff?r1=1.14&r2=1.15</A>>.<BR>
Bruce check out F&vD, P249<BR>
Bruce hhmmms<BR>
Bruce says, "are you there?"<BR>
igor returns.<BR>
Bruce says, "am I full of it, or am I right?"<BR>
Bruce says, "[1, 2, 3, 4] is a vector"<BR>
igor suspects that, perhaps, an error should be returned on \* if either w != 0.0...<BR>
Bruce says, "it means the same as [0.25, 0.5, 0.75, 1.0]"<BR>
igor thought it meant [4, 8, 12, 1]...<BR>
Bruce says, ".. and this is called homogenizing it, right?"<BR>
Bruce says, "hmmm .. well it doesn't matter as long as everyone agrees..."<BR>
Bruce says, ".. except possibly in how often you get to do divisions instead of mult"<BR>
igor hmms.<BR>
igor says, "Nope, you're right..."<BR>
Bruce says, "well .. even the old code did / to homogenize"<BR>
Bruce says, "ah .. maybe I shouldn't be homogenizing in *"<BR>
Bruce says, "that's only for vectors, not points, right?"<BR>
Bruce says, ".. and vectors have w = 0?"<BR>
igor nods.<BR>
Bruce says, "ok, that's wont' work then"<BR>
igor mentioned that possibility a little above...<BR>
Bruce says, "one mo..."<BR>
Bruce says, "so he did"<BR>
Bruce says, "but I didn't understand that comment at the time"<BR>
igor grins.<BR>
Bruce says, "no change"<BR>
igor adds a error message...<BR>
Bruce says, "we're talking about dot product, aren't we?"<BR>
igor nods.<BR>
Bruce says, "ok, the way it was befoe, it would be multiplying the two w's together and adding them, but they were zero so it was OK"<BR>
igor takes out the extra math...<BR>
-----------------------------------igor------------------------------------<BR>
define method \* (v1 :: <vector3D>, v2 :: <vector3D>)<BR>
 => (dot-product :: <fp>);<BR>
  if (v1.w ~= 0.0 | v2.w ~= 0.0)<BR>
    error("Attempt to take a dot product involving a point!");<BR>
  end if;<BR>
  v1.x * v2.x + v1.y * v2.y + v1.z * v2.z;<BR>
end method;<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "so, I've commented out the division, but it doens't fix things"<BR>
Bruce says, "we *really* should use different types for vectors and points :-)"<BR>
igor says, "I s'pose we could..."<BR>
igor says, "But, you'll have to make many of the same things work with both."<BR>
Bruce says, "how about multiplying vector by scalar"<BR>
igor says, "(such as matrix multiplying)"<BR>
igor says, "OK, so what if we had <3D-point> and <3D-vector>  Would we win?"<BR>
Bruce says, "I think so :-)"<BR>
Bruce says, "do you do that points or vectors by scalars?"<BR>
Bruce says, "the old code multiplied all the components, which leaves vectors unchanged, since a/b == (a*n)/(b*n)"<BR>
Bruce says, "the new code maks the vector n times longer"<BR>
Bruce says, "this comes down to the same question as the negative() function, which you guys discussed when I wa asleep"<BR>
igor says, "doesn't parse: do you do that points or vectors by scalars?"<BR>
igor says, "You can't multiply points by scalars..."<BR>
-----------------------------------igor------------------------------------<BR>
define class <3D-vector> (<object>)<BR>
  slot x :: <fp>, required-init-keyword: x:;<BR>
  slot y :: <fp>, required-init-keyword: y:;<BR>
  slot z :: <fp>, required-init-keyword: z:;<BR>
end;<BR>
<BR>
define class <3D-point> (<object>)<BR>
  slot x :: <fp>, required-init-keyword: x:;<BR>
  slot y :: <fp>, required-init-keyword: y:;<BR>
  slot z :: <fp>, required-init-keyword: z:;<BR>
  slot w :: <fp>, required-init-keyword: w:;<BR>
end;<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "you never multiply points by scalars?  So it doesn't matter what happens if w is nonzero, then"<BR>
igor nods.<BR>
Bruce says, "and if w is zero then it doesn't matter whether you multiply it by n or keep it how it was..."<BR>
Bruce says, ".. so the old and new code are equiv"<BR>
Bruce says, "so you cna'yt take the negative of a point either"<BR>
igor is busy splitting 'em up...<BR>
igor says, "Do we still need as(class == <3D-vector>, v :: <vector>) ?"<BR>
Bruce says, "ah ha!  I think I have it!"<BR>
igor says, "Oh?"<BR>
Bruce says, "not really -- only if you don't want to call vector3D(a, b, c, d)"<BR>
Bruce says, "in negative()"<BR>
igor is happy calling 'point3D(a, b, c, d)', but 'vector(a, b, c)'<BR>
Bruce says, "... since it's equal to x/w, y/w, z/w you have a choice of negating x/y/z or just w."<BR>
Bruce says, ".. except for a vector w is 0"<BR>
Bruce says, ".. and negative is being calle dona point, too!"<BR>
igor says, "Whee..."<BR>
Bruce says, "and negative means * -1, right?"<BR>
igor nods.<BR>
Bruce says, "now we're getting the "dot product of points" error happening"<BR>
Bruce says, "ther eis major confusion going on somewhere"<BR>
Bruce says, "I *really* wish error() produced a traceback"<BR>
Bruce says, "now I'm getting scalar product of a point..."<BR>
igor nods.<BR>
Bruce says, "magnitude of a vector and magnitude of a poit shoudl be quite different calculations"<BR>
igor says, "Magnitude of a point makes no sense."<BR>
igor says, "You should say magnitude(point1 - point2)"<BR>
igor says, "(where point2 can be $origin, perhaps)"<BR>
igor says, "Does "Vector * Matrix""<BR>
igor says, "actually make sense?"<BR>
Bruce says, "ves .. , if it's a rotation matrix, for example"<BR>
igor says, "Since vectors are actually 4-digit column vectors, a 4x1 matrix cannot multiply into a 4x4 matrix"<BR>
igor says, "It's not commutable..."<BR>
Bruce says, "Ok"<BR>
Bruce says, ".. you'd need to transpose the vector"<BR>
Bruce says, "maybe pts are column vectors and vectors are row vectors?"<BR>
Bruce says, "or the reverse?"<BR>
igor doesn't think so.<BR>
Bruce says, "aaaarrrggggghhhhhhh"<BR>
Bruce shows frustration<BR>
-----------------------------------igor------------------------------------<BR>
define method \* (m :: <transform>, v :: <3D-point>)<BR>
 => mult-point :: <3D-point>;<BR>
  point3D(m.v00 * v.x + m.v01 * v.y + m.v02 * v.z + m.v03 * v.w,<BR>
   m.v10 * v.x + m.v11 * v.y + m.v12 * v.z + m.v13 * v.w,<BR>
   m.v20 * v.x + m.v21 * v.y + m.v22 * v.z + m.v23 * v.w,<BR>
   m.v30 * v.x + m.v31 * v.y + m.v32 * v.z + m.v33 * v.w);<BR>
end method;<BR>
<BR>
define method \* (m :: <transform>, v :: <3D-vector>)<BR>
 => mult-vector :: <3D-vector>;<BR>
  point3D(m.v00 * v.x + m.v01 * v.y + m.v02 * v.z + m.v03,<BR>
 m.v10 * v.x + m.v11 * v.y + m.v12 * v.z + m.v13,<BR>
 m.v20 * v.x + m.v21 * v.y + m.v22 * v.z + m.v23,<BR>
 m.v30 * v.x + m.v31 * v.y + m.v32 * v.z + m.v33) - $origin;<BR>
end method;<BR>
---------------------------------finished----------------------------------<BR>
igor says, "How 'bout those for our new matrix mult functions..."<BR>
Bruce says, "well you'd just put the - 1.0 on w in the call to point3D, rather than doing an expensive subtract"<BR>
Bruce says, "no, thatr's no quite right"<BR>
Bruce says, "what's frustrating is that you wee producing nice-looking pictures before"<BR>
igor grins.<BR>
Bruce says, ".. and we thought it was usta little problem with FOV"<BR>
Bruce says, ".. and I thoight, no maybe it's a problem with normalizing vectors or something."<BR>
igor says, "However, this might solve my reflection/specular highlight/FOV confusion..."<BR>
Bruce says, "zegactly"<BR>
-----------------------------------igor------------------------------------<BR>
define method \- (v1 :: <3D-point>, v2 :: <3D-point>)<BR>
 => (difference :: <3D-vector>);<BR>
  let w1 = v1.w;<BR>
  let w2 = v2.w;<BR>
  if (w1 = 1.0 && w2 = 1.0)<BR>
    vector3D(v1.x - v1.2, v1.y - v2.y, v1.z  - v2.z);<BR>
  else<BR>
    vector3D(v1.x / w1 - v1.2 / w2, v1.y / w1 - v2.y / w2, v1.z  / w1 - v2.z / w2);<BR>
  end if;<BR>
end method;<BR>
---------------------------------finished----------------------------------<BR>
igor says, "Should 'point + vector' be commutative?"<BR>
Bruce says, "that doesn't look right"<BR>
igor says, "What doesn't?"<BR>
Bruce says, " .. you certainly can't depend on anyting being exactly 1.0"<BR>
igor says, "Well, I can hope, can't I..."<BR>
Bruce says, ".. unless you homogenize first"<BR>
igor says, "It's more of an 'if both happen to be homogenized, then use this, otherwise do it the slow way'..."<BR>
Bruce says, "you're just trying to avoid doing a division, but you'd gt the same result?"<BR>
igor nods.<BR>
Bruce says, "OK"<BR>
Bruce says, "y'know, I'm starting to think that it migth be better to store 1/w in the vector instead of w"<BR>
Bruce says, ".. and I'm feeling a sense of deja-vu"<BR>
igor grins.<BR>
igor says, "We'd have to invert it on every matrix mult..."<BR>
Bruce says, ".. from about 16 or 17 years ago when I actually studied this stuff"<BR>
igor says, "(and invert it back later...)"<BR>
Bruce says, "Damn - I have to go  take Anastasia to her singing lesson.  Be back in 45 mins"<BR>
Bruce says, "carry on and I'll check your work when I get back :-)"<BR>
igor nods.<BR>
Bruce says, "i'll be sittin gin the car for 30 of those minutes dong nothing -- I'll take pencil and paper"<BR>
igor grins.<BR>
Bruce <- AFK<BR>
Bruce <- back<BR>
Bruce <- has it all figured out<BR>
igor says, "Oh?"<BR>
igor commits all of his stuff...<BR>
igor says, "I'm trying to figure out one problem here still, but the rest seems OK..."<BR>
Bruce says, "the question is why do you have these 4-coordinate things""<BR>
igor says, "So that stuff translates properly when you toss it through a matrix."<BR>
Bruce says, "is it for notational convenience, so you don't need several similar functions for everything?""<BR>
Bruce says, "or is it to turn divides into multiplies and go faster?""<BR>
Bruce says, ".. or both?"<BR>
Bruce says, "if it's just so you can use the same matrix multiply function then, yeah, you need a 0 on the end of a vector and a 1 on the end of a point""<BR>
igor says, "No, actually, as it turns out you always want a 1 at the end of a vector."<BR>
igor says, "You just don't want a 1 whenever you're doing anything *except* transforming a vector."<BR>
Bruce says, "if there's a 1 at the end of a vector then i will pick up the translation component of the matrix.  Which is bad"<BR>
igor says, "No it isn't."<BR>
Bruce says, "why not?  Vectors have a direction and length, but not a position"<BR>
igor says, "No, when you transform a vector, you're moving the end of it."<BR>
igor says, "so, a translation just moves it over a little."<BR>
igor says, "(the end, that is)"<BR>
igor found the FOV problem, BTW...<BR>
Bruce says, "if you do that then you lose associativity"<BR>
igor says, "I went to all the trouble of converting fov to radians, then called render-image() with the fov still in degrees :-P"<BR>
Bruce says, "oops"<BR>
Bruce says, "befoe, you were saying that yo can tell the difference between a vector and a point by whether w was zero?"<BR>
igor hmms.  berlin.ccc is unreachable again...<BR>
Bruce says, "it's OK from here"<BR>
igor says, "Back again..."<BR>
igor says, "Yaaay!  Pretty pictures are here again!"<BR>
igor says, "OK, so there's some minor issues with hit-testing planes..."<BR>
igor says, "OK, update and take a look..."<BR>
Bruce checking out<BR>
Bruce com0iling<BR>
igor doesn't know what's up with the weird plane warpage...<BR>
Bruce says, "oh ..; so it's *not* a red ball above a BIG blue ball"<BR>
igor says, "No."<BR>
igor says, "(would be nice if it were, tho...)"<BR>
Bruce says, "neither of spheres.gml and spheres2.gml works"<BR>
Bruce says, ".. they used to"<BR>
igor nods.<BR>
Bruce says, "(blank image)"<BR>
igor says, "Hmm... That's unfortunate..."<BR>
Bruce says, "well, the vector stuff looks right, reading through point now"<BR>
igor mildly suspects that we are casting the wrong rays...<BR>
Bruce says, "checking something..."<BR>
Bruce says, "it was *soo* close before"<BR>
igor grins.<BR>
igor says, "It's actually prett close now..."<BR>
Bruce says, "I'd lobe to know what would happen if you went back to a previous version and just changed the FOV degree/radian screwup"<BR>
igor grins.<BR>
igor says, "Yeah, we're casting bad rays here, it looks like..."<BR>
Bruce says, "that blue thing is a finite-sized plane?"<BR>
igor says, "Nope, it's supposed to be infinite..."<BR>
Bruce says, "this looks like a *reeeaaallly* wide angle fish-eye lens"<BR>
igor says, "That's exactly what's happening..."<BR>
Bruce says, "are you sure about your FOV conversion?"<BR>
igor says, "change red sphere 0.3 uscal to red sphere 0.3 uscale -0.25 -0.25 0.0 translate and you'll see..."<BR>
igor says, "OK, could this be the problem: Are we not getting an even distribution of rays in render-image?"<BR>
igor says, "i.e., are we getting more rays in the middle, and fewer on the outside?"<BR>
Bruce says, "I'm looking at that"<BR>
Bruce says, "the FOV is getting converted correctly..."<BR>
Bruce says, "(verified using format-out)"<BR>
igor nods.<BR>
Bruce says, "what are the zxes here?"<BR>
Bruce says, "axes"<BR>
igor says, "What do you mean?"<BR>
Bruce says, "+x is ?  +y is ?  +z is ?"<BR>
igor says, "+x is to the right, +y is up, +z is into the screen."<BR>
Bruce says, "OK"<BR>
Bruce says, "thought Z might be towards the camera..."<BR>
Bruce says, "and the camera and the image plane are where?"<BR>
igor says, "The camera's at (0, 0, -1)"<BR>
igor says, "looking directly down the Z axis."<BR>
igor's not sure about the image plane, though...<BR>
Bruce says, "mage is at z=0?"<BR>
Bruce says, "image is at z=0?"<BR>
igor says, "Check the spec..."<BR>
Bruce says, "well, it's traversing the right places on the image plane..."<BR>
igor says, "Are, perhaps, the rays getting transformed in a bogus manner by the matrix math?"<BR>
igor says, "(when moving them into the coord. space of the targets, that is)"<BR>
Bruce says, "well, yes, somewhere.  but at what point?"<BR>
igor nods.<BR>
Bruce says, "the stuff in matrix.dylan all looks right to me.  So it's the way it's being used, then..."<BR>
Bruce says, "checking the ray being generated..."<BR>
Bruce says, "oh, for a debugger better than format-out..."<BR>
Bruce says, "argh, no print(ray) primitive"<BR>
igor hmms.<BR>
igor says, "Perhaps it'"<BR>
igor says, "is in"<BR>
igor says, "transform-with-matrix"<BR>
igor says, "OK, so if you have a ray pointing at a sphere in the middle."<BR>
igor says, "If the sphere moves to the left, that's equivalent to the ray moving to the right."<BR>
igor says, "But, the ray should still point in the same direction."<BR>
igor says, "But, currently, we move both the ray and its direction..."<BR>
Bruce says, "right....."<BR>
igor says, "Yeah baby...!"<BR>
igor comments out that part and gets: <A HREF="http://secret-lab.dartmouth.edu/~igor/spheres.ppm" TARGET="_blank">http://secret-lab.dartmouth.edu/~igor/spheres.ppm</A><BR>
igor says, "Lighting is fucked, but the geometry is correct."<BR>
Bruce says, "trying it..."<BR>
Bruce says, "yes!"<BR>
Bruce says, "but much better :-)"<BR>
igor says, "OK, but what about this case:"<BR>
Bruce says, "I've got the sphere at -0.25, 0.25, 0 and it's loking a little distorted."<BR>
igor says, "That's a perspective distortion, I think..."<BR>
igor says, "Try spheres.gml, and you'll see it's exactly where it's supposed to be."<BR>
Bruce says, "just need to recompile .. I got 10 MB of debug output on that run, and poor old 'less' had to absorb it"<BR>
igor grins.<BR>
Bruce says, "spheres.gml looks *exactly* right now!"<BR>
Bruce says, "ok, wrong lighting..."<BR>
igor says, "And it's not pixel-for-pixel, but it's doing pretty darned well."<BR>
igor says, "OK, so now consider this case:"<BR>
Bruce says, "actually, it's no *ambient* lighting.  the star is fine"<BR>
Bruce says, "hmmm .. the far ball is smoother than the near one..."<BR>
igor says, "you have an up-arrow.  You rotate it 90 degrees, so it's now a left arrow."<BR>
Bruce says, "yes.  so?"<BR>
igor says, "This is equivalent to moving the viewer to the left side of the arrow, and turning his head right to look at the arrow once more."<BR>
igor says, "So, in this case, the direction-of-viewing does change."<BR>
igor says, "What should we do, therefore?  We want the rotations, but not the translations..."<BR>
Bruce says, "for vectors, that's right"<BR>
Bruce says, "that's why the last component is zero"<BR>
igor nods.  OK, that kinda makes sense...<BR>
Bruce says, "OK, carry one.  how much time did we just waste?"<BR>
igor grins.<BR>
-----------------------------------igor------------------------------------<BR>
define method \* (m :: <transform>, v :: <3D-vector>)<BR>
 => mult-vector :: <3D-vector>;<BR>
  point3D(m.v00 * v.x + m.v01 * v.y + m.v02 * v.z,<BR>
 m.v10 * v.x + m.v11 * v.y + m.v12 * v.z,<BR>
 m.v20 * v.x + m.v21 * v.y + m.v22 * v.z,<BR>
 m.v30 * v.x + m.v31 * v.y + m.v32 * v.z) - $origin;<BR>
end method;<BR>
---------------------------------finished----------------------------------<BR>
igor says, "Right?"<BR>
Bruce says, "No, I still don't think so"<BR>
Bruce says, "nuke the whole last line and make it a vector3d not a point constructor"<BR>
igor tries it.<BR>
igor says, "YESS!!!!"<BR>
igor says, "Perfect output!"<BR>
igor says, "The example spheres.ppm is almost pixel-for-pixel what we have now :-)"<BR>
Bruce says, "colours as well?"<BR>
igor says, "Yep."<BR>
igor says, "All the lighting is exactly right."<BR>
Bruce says, "cool -- check in!"<BR>
igor says, "Checked in."<BR>
Bruce says, "OK"<BR>
igor says, "It's not pixel-perfect, but it's darned close."<BR>
igor says, "(I think our sphere is either a touch bigger or a touch higher on the screen than theirs)"<BR>
igor says, "Some gimp work taking the difference may turn up something, though."<BR>
Bruce says, "well, we could do to add 0.5 to the pixel positions we're tracing through, to go through the middle of the pixel"<BR>
igor says, "Hmm... not a bad idea..."<BR>
igor says, "That, to my eye, is precisely correct."<BR>
igor fires up the Gimp...<BR>
Bruce says, "the new fib.gml test looks puuurfect too!"<BR>
igor says, "Cool!"<BR>
igor says, "Now all we need is reflections :-P"<BR>
Bruce says, "and CSG"<BR>
igor says, "That, too."<BR>
Bruce I might see if I can figure that out.  Or maybe cubes etc<BR>
igor says, "If you feel mathematically inspired, cubes & cones & cylinders might be nice..."<BR>
igor says, "For something easy, <flashlight>s and <firefly>s"<BR>
Bruce off to read the rules again<BR>
A small swarm of 3x5 index cards arrives, engulfs igor, and carries it away.<BR>
A small swarm of 3x5 index cards blows in and disperses, revealing igor.<BR>
igor glances nervously at the clock.<BR>
A small swarm of 3x5 index cards arrives, engulfs igor, and carries it away.<BR>
A small swarm of 3x5 index cards blows in and disperses, revealing igor.<BR>
A small swarm of 3x5 index cards arrives, engulfs igor, and carries it away.<BR>
A small swarm of 3x5 index cards blows in and disperses, revealing igor.<BR>
igor gets 1707 rays/second for spheres.gmt<BR>
igor says, "er gml."<BR>
igor is all checked in & stuff.<BR>
Karl-Heinz_Guest has connected.<BR>
>> Karl-Heinz_Guest is now known as gabor_[Guest].<BR>
igor [to gabor_[Guest]]: Good morning!<BR>
gabor_[Guest] says, "Hey! still awake!"<BR>
igor [to gabor_[Guest]]: We're now rendering some of the sample images with near-pixel-perfection :-)<BR>
gabor_[Guest] says, "any gifs to see?"<BR>
igor says, "Sure...  Sec..."<BR>
gabor_[Guest] says, "Hiw is the GML compiler doing? Any bugs found?"<BR>
igor says, "None that we've found."<BR>
igor says, "The lexer/compiler/interpretter still need error handling, however..."<BR>
gabor_[Guest] says, "what is in the TODO should be enogh? right?"<BR>
igor dunnos.<BR>
gabor_[Guest] says, "Bruce?"<BR>
gabor_[Guest] says, "Andreas? Did he come back yesterday?"<BR>
igor says, "He stopped by and fixed a problem with the CVS server, but not too much else..."<BR>
igor says, "'cvs annotate | grep andreas | wc' indicates that he's down to 77 lines of code :-)"<BR>
gabor_[Guest] says, "is this good or bad news?"<BR>
igor says, "<A HREF="http://secret-lab.dartmouth.edu/~igor/fib.gif" TARGET="_blank">http://secret-lab.dartmouth.edu/~igor/fib.gif</A>"<BR>
igor says, "Neither, really...  It just means that we've moved around & adjusted just about everything he did..."<BR>
gabor_[Guest] says, "Is the front sphere really egg-shaped?"<BR>
igor says, "That's exactly how it's supposed to look."<BR>
gabor_[Guest] says, "Great!"<BR>
gabor_[Guest] says, "Where is bruce?"<BR>
igor says, "(a bit of perspective shearing)"<BR>
igor says, "He's around..."<BR>
gabor_[Guest] says, "Good, because I have some testing for him regarding compiler opimizations."<BR>
gabor_[Guest] says, "First I check in the simplifier and later the day the partial evaluator."<BR>
igor says, "Yay!"<BR>
gabor_[Guest] says, "I am at work now, so I cannot test much."<BR>
igor [to gabor_[Guest]]: Want an account on my machine from which to play with this stuff?<BR>
gabor_[Guest] says, "Bruce has to test every sample in the pdf. I'll write up the todo."<BR>
gabor_[Guest] says, "I am a mac guy :-) cannot use telnet"<BR>
igor grins.<BR>
gabor_[Guest] says, "After my checkin, the compiler is persona non-grata until it has passed the testsuite."<BR>
Bruce pops in<BR>
igor will let Bruce and Gabor work out that...<BR>
gabor_[Guest] says, "However the algorithm is so simple that it either fails miserably or works out of the box"<BR>
gabor_[Guest] says, "Hi Bruce!"<BR>
Bruce says, "what can I do for you?"<BR>
Bruce swallows panadol<BR>
gabor_[Guest] says, "In some minutes I check in the simplifier, with the partial evaluator following later this day."<BR>
gabor_[Guest] says, "Please run all the test-suite"<BR>
igor [to gabor_[Guest]]: Can you use a branch?<BR>
gabor_[Guest] says, "If you do not have other stuff to do first"<BR>
Bruce says, "hey!  I'm a mac guy too!  I'm typing this on an 8500 right now"<BR>
igor grins.<BR>
gabor_[Guest] grins.<BR>
gabor_[Guest] says, "Branch would be good"<BR>
igor has actually bootstrapped d2c on a PowerMac 6100/66 running MkLinux before...<BR>
Bruce says, "has 8500/G3 and Athlon monitors side by side"<BR>
igor says, "(that's mindy-bootstrapped...)"<BR>
Bruce shudders<BR>
igor says, "It took about a week, and was 'nice'd down so I could do other stuff at the same time..."<BR>
gabor_[Guest] says, "You guys are great!"<BR>
gabor_[Guest] says, "How do I check in on a branch with MacCVS Pro?"<BR>
igor has no clue...<BR>
Bruce says, "me either."<BR>
Bruce says, "is there a way to make a <stream> from a string?"<BR>
Bruce says, "If so then I can make a little test module that has pairs like #("1 2 3 4 muli addi", #(1, 14))"<BR>
Bruce says, ".. or even #("1 2 3 4 muli addi", "1 14") and run the interpreter on both."<BR>
Bruce thinks shoulda just had the damn lexer lex from a string, but too late now<BR>
igor [to Bruce]: What would you categorize as your "current project"?<BR>
gabor_[Guest] says, "try to make a primitive that does this"<BR>
Bruce says, "ummm .. I'm thinking about CSG.  I know how to do it too :-)"<BR>
igor says, "Cool..."<BR>
gabor_[Guest] says, "what is that?"<BR>
igor says, "BTW, since we three are here..."<BR>
igor says, "First off, what would y'all say to making this a GPL'd program when we're done..."<BR>
Bruce says, "the intersect and difference operators in the language"<BR>
igor says, "Currently it's freeware..."<BR>
Bruce says, "why?"<BR>
Bruce says, "you think someone would want to improve it and sell it?"<BR>
igor says, "Hey, weirder things have happened..."<BR>
Bruce says, "how am I supposed to live for the next year if I can't sell it?"<BR>
Bruce says, ":-) :-)"<BR>
igor says, "Oh, you can sell it, you just can't stop people from making copies..."<BR>
Bruce says, "here's my question: what would best serve to advance Dylan into common use?"<BR>
igor says, "The other thing is the prize money, should we win any...  Should we divide it up, or keep it to help cover any Gwydion-Dylan related expenses?"<BR>
gabor_[Guest] says, "Winning this contest would help dylan much"<BR>
Bruce says, "that's why we're here..."<BR>
gabor_[Guest] says, "win first"<BR>
Bruce says, "I think we're entering as individuals, rather than as the gd team"<BR>
Bruce says, "... if some of the fun-o guys want to pitch in they're welcome to.  or their customers..."<BR>
Bruce says, "and no on e has taken a blow-torch to Eric or TRE or Rob or the others..."<BR>
igor . o O ( define method get-counter() let count = 0; local method count() count := count + 1; end; end;  count = get-counter();  for (c in *chickens*) if (~c.hatched) count() end if; end for; )<BR>
Bruce says, "I saw we use the prize money to finance getting teammembers to a party :-)"<BR>
Bruce says, "you brought it up, dude"<BR>
igor says, "True, true..."<BR>
Bruce back to work...<BR>
igor says, "I suppose this is something to think about after we win, then :-)"<BR>
Bruce says, "yep.  No opposition in principle, let's just say"<BR>
Bruce says, "and I'm going to disappear for an hour to rest my eyes and kick this headache"<BR>
igor nods.  Fair 'nuff.<BR>
igor says, "I'll try to have reflections working by then, then..."<BR>
gabor_[Guest] says, "cannot check in new todo!"<BR>
igor [to gabor_[Guest]]: Hmm?<BR>
igor's been keeping track of stuff-to-do with the 'todo list' here in the MOO.<BR>
igor says, "use 'add "do something" to todo'"<BR>
gabor_[Guest] says, "add "do we need <vector> in Engine.dylan?" to todo"<BR>
gabor_[Guest] says, "OK got it"<BR>
igor says, "Actually, converting Engine.dylan to speak <3D-point>s mightn't be such a bad idea."<BR>
gabor_[Guest] says, "Absolutely"<BR>
igor says, "Additionally, if the partial-evaluator works nicely, if we can detect a 'surface function', then we should do the conversion from point => color there, if possible"<BR>
igor says, "Since colors are likely to be constant..."<BR>
igor shrugs.<BR>
gabor_[Guest] [to igor]: can you do the transition to <3D-point> with w == 1 away from <point>?<BR>
gabor_[Guest] says, "Who else uses <point>?"<BR>
igor says, "Nobody."<BR>
gabor_[Guest] says, "how do you specify lights then?"<BR>
igor says, "Oh...  I see..."<BR>
gabor_[Guest] says, "this is crucial!"<BR>
igor says, "OK.  points are used internally to the language, and to specify light direction and position and color."<BR>
igor says, "And I believe that is all."<BR>
gabor_[Guest] says, "so you ignore them now when coming from the interpreter?"<BR>
igor wasn't entirely clear in his last sentence.<BR>
igor says, "They are used for light colors, but also for surface colors and ambient color (in the render function)"<BR>
gabor_[Guest] says, "so commenting out <point> would hurt you?"<BR>
igor says, "Not until it gets replaced, yes."<BR>
gabor_[Guest] says, "I cannot access the CVS Server!! HELP!"<BR>
igor says, "hmm... try again..."<BR>
gabor_[Guest] says, "OK"<BR>
Bruce pings<BR>
igor yos.<BR>
igor <- still working on reflection :-P<BR>
Bruce says, "OK"<BR>
Bruce says, "Coming up to the 12 hour mark."<BR>
igor nods.<BR>
Bruce says, "I don't think we're going to make tier 2 & 3"<BR>
igor says, "Tier II is easy, if we get tier I done..."<BR>
Bruce says, "that's true"<BR>
Bruce says, "What version of the docs are you working from?"<BR>
igor says, "The first version..."<BR>
igor says, "(but I've been making corrections to my print-out)"<BR>
Bruce says, "you shoudl grab 1.18"<BR>
You hear a quiet popping sound; Bruce has disconnected.<BR>
Bruce has connected.<BR>
igor thwaks his head loudly.<BR>
igor says, "Reflection was working perfectly."<BR>
Bruce says, "whassup?"<BR>
igor says, "Unfortunately, Instead of:"<BR>
Bruce says, "... bu you had surfaces with no reflection?"<BR>
-----------------------------------igor------------------------------------<BR>
  reflection-color := tracer(reflected-ray, depth - 1);<BR>
<BR>
I had<BR>
reflection-color = tracer(reflected-ray, depth - 1);<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "oops"<BR>
Bruce says, "that really is worth a warning"<BR>
igor tries again.<BR>
igor says, "Discarding the value of an '=' considered harmful..."<BR>
Bruce says, "my ISP just booted me off for exceeding their "3 hour connection limit""<BR>
igor grins.<BR>
igor says, "Yeeehaw..."<BR>
Bruce says, "I was on for 23 hours, so that's OK"<BR>
igor says, "heh..."<BR>
Bruce says, "they only *actually* kick you off if your particular modem pool gets full"<BR>
Bruce says, ".. and it's 9pm"<BR>
igor . o O ( cron job? )<BR>
igor [to Bruce]: Update and go nuts :-)<BR>
igor [to gabor_[Guest]]: <A HREF="http://secret-lab.dartmouth.edu/~igor/spheres2.gif" TARGET="_blank">http://secret-lab.dartmouth.edu/~igor/spheres2.gif</A><BR>
A small swarm of 3x5 index cards arrives, engulfs igor, and carries it away.<BR>
A small swarm of 3x5 index cards blows in and disperses, revealing igor.<BR>
Bruce says, "YES!"<BR>
igor says, "Idn't dat kewl?"<BR>
Bruce says, "Well done!"<BR>
igor says, "Thanks."<BR>
igor tries out reflect.gml<BR>
Bruce assumes here that igor didn't just copy the image from the contest site...<BR>
igor hmms...  What's wrong with reflect.gml...<BR>
Bruce says, "wow, interesting"<BR>
Bruce says, "i get major banded circles on the .. uh .. 'ky'"<BR>
Bruce says, "sky"<BR>
igor nods.<BR>
Bruce says, "and everything's in differen places than in the sample image"<BR>
igor says, "except the big blob on the right..."<BR>
igor says, "So is this an example of incorrect reflection vectors, or is something *really* funky going on here?"<BR>
igor finds the problem...<BR>
Bruce says, "cool"<BR>
igor says, "rotate[xyz] weren't converting deg->rads"<BR>
Bruce says, "so that's tier 1 complete, finished, wrapped up, as far as the renderer goes?"<BR>
igor says, "So, the mirror was in dramatically the wrong place."<BR>
igor says, "Pretty much..."<BR>
igor starts it crunching on reflect.gml<BR>
igor says, "Oh, a bit of optimization wouldn't be a bad idea, either..."<BR>
igor shrugs.<BR>
igor says, "However, for anything but speed, we're doing well, and speed isn't too bad either."<BR>
igor hmms.  That's odd...<BR>
Bruce says, "speed doesn't even come into it until the 3rd phase of judging"<BR>
igor says, "There's a "halo" in my new reflect.ppm image..."<BR>
Bruce says, "there's plenty of chance to crap out for crashes or wrong images before that"<BR>
igor checks in so you can take a look.<BR>
Bruce says, "I didn't pick up anythig on the update"<BR>
igor says, "OK, update now."<BR>
Bruce says, "ok got it that time"<BR>
Bruce says, "we're much bighter than them"<BR>
igor says, "Ah...  I was rotating the mirror around wrong... or something..."<BR>
Bruce says, "what is the mirror?"<BR>
igor says, "A big plane"<BR>
Bruce says, "yeah, but where in the picture is it?"<BR>
igor says, "at z = 6"<BR>
Bruce says, "I don't understand what I'm looking at"<BR>
igor fixes the problem by making planes properly double-sided.<BR>
igor says, "(i.e., returning the normal pointing towards the viewer)"<BR>
igor says, "Nope... Still looks halo-y"<BR>
Bruce says, "there are some cool little closures and stuff in this sample source file (reflect.gml)"<BR>
igor nods.<BR>
igor flips the direction we rotate in, on the assumption that that's what's bogus...<BR>
igor glances nervously at the clock.<BR>
gabor_[Guest] [to Bruce]: checking in simplifier. To use it, put Optimizer.dylan into .lid<BR>
Bruce says, "yes, I'd do that.  Planes are supposed to be one-sided."<BR>
igor says, "Are they?"<BR>
igor says, "Where does it say that?"<BR>
Bruce looks<BR>
Bruce says, "p9"<BR>
igor doesn't see it...<BR>
Bruce says, "'inside' the plane is -ve y.  So if a -90 rotation turns it to face us, +ve z must be going to +ve y"<BR>
gabor_[Guest] says, "checked in. Please do not update to engine 1.9 until it is verified"<BR>
igor hmms.  Still messed up :-P<BR>
Bruce says, "formally, the plane is the half-space y <= 0"<BR>
Bruce quotes<BR>
Bruce says, "you want me to do something, Gabor?"<BR>
Bruce says, "doesn't compile, gabor.  Cna't find optimize-compile-GML"<BR>
igor says, "So, should you 'see through' a plane that's facing away from you?"<BR>
Bruce says, "I don't know.  I think it's supposed to be a solid block"<BR>
gabor_[Guest] says, "did you put optimizer into the lid?"<BR>
Bruce says, "so if it's facing away from you then you're *in* it"<BR>
Bruce says, "no, Gaboir.  Did you?"<BR>
gabor_[Guest] says, "no"<BR>
gabor_[Guest] says, "please do"<BR>
Bruce OKs.<BR>
gabor_[Guest] [to Bruce]: the simplifier ct-evaluates stuff like "2 3 addi 4 addi"<BR>
Bruce says, "cool"<BR>
Bruce says, "Gabor, I think we're probably about fast enough on the compiler."<BR>
Bruce says, "we might b bette off to implement some more stuff in this last 12 hours"<BR>
Bruce says, "optimizer can't find false-or"<BR>
Bruce says, "where does that live?"<BR>
igor says, "extensions?"<BR>
gabor_[Guest] says, "yep"<BR>
gabor_[Guest] says, "addi is not yet optimized, only negi, try that first, "42 negi negi""<BR>
Bruce says, "got it"<BR>
gabor_[Guest] says, "adding addi next"<BR>
gabor_[Guest] [to Bruce]: does it work?<BR>
-----------------------------------Bruce-----------------------------------<BR>
bruce@k7 src]$ ./icfp2000 -<BR>
42 negi negi<BR>
It is ambiguous which of these methods is most specific:<BR>
  #(, )<BR>
{the <method> optimizable-two{<integer>, singleton(#"negi"), <list>}}{the <method> optimizable-two{<object>, <object>, <pair>}}Aborted (core dumped)<BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "this is true"<BR>
Bruce says, "because the pair is more specific than list?"<BR>
gabor_[Guest] says, "did not get this with AD TR"<BR>
gabor_[Guest] says, "you are right"<BR>
Bruce says, "so list in both places or pair in both places would fix it?"<BR>
Bruce says, "you're trying to avoid getting #() n the second case< I assume?"<BR>
Bruce says, "adding an <integer> negi pair method that calls next-method would work too"<BR>
gabor_[Guest] says, "grab cvs"<BR>
Bruce says, "or am i full of it on specificity?"<BR>
gabor_[Guest] says, "I have checked in a fix"<BR>
gabor_[Guest] says, "negi can have #() as more"<BR>
gabor_[Guest] says, "tell me if it works"<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 -<BR>
42 negi negi<BR>
It is ambiguous which of these methods is most specific:<BR>
  #(, )<BR>
{the <method> optimizable-two{<integer>, singleton(#"negi"), <list>}}{the <method> optimizable-two{<object>, <object>, <pair>}}Aborted (core dumped)<BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "thinking..."<BR>
Bruce says, "why isn't <pair> more specific than <list>.  That should work"<BR>
gabor_[Guest] says, "<pair> _is_ more specific than <list>"<BR>
Bruce says, "arrrghh"<BR>
Bruce says, "it's the next-method call that's is fakling!"<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 -<BR>
42 negi negi<BR>
lexed : #(42, #"negi", #"negi")<BR>
<BR>
output: #(42)<BR>
<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "I was right"<BR>
gabor_[Guest] says, "what did you do?"<BR>
Bruce says, "removed the call to next-method() an just duplicated the code"<BR>
Bruce says, "it's checked in"<BR>
gabor_[Guest] says, "got it"<BR>
Bruce says, "it was the next-method call that was ambiguous"<BR>
Bruce says, "the body is small enough that it's not worth factoring it out..."<BR>
Bruce says, "could use type-union(<pair>, <list>) ??"<BR>
gabor_[Guest] says, "it will be different for addi :-)"<BR>
gabor_[Guest] says, "should use"<BR>
gabor_[Guest] says, "try it"<BR>
Bruce says, "or does the pair not add anything to it?"<BR>
Bruce says, "interesting case"<BR>
Bruce says, "btw, can you wrap your code a little narrower?"<BR>
Bruce says, "like about 2/3 of where you do"<BR>
gabor_[Guest] says, "use not now"<BR>
gabor_[Guest] says, "not now"<BR>
Bruce says, "??"<BR>
gabor_[Guest] says, "do not use type-union for now"<BR>
gabor_[Guest] says, "I will do wrapping later (5 minutes before ... :-)"<BR>
Bruce says, "i tried it -- it didn't work anyway"<BR>
Bruce says, "p.s. whhy are we reading a gilename from the command line instead o reading from stdin?  the requirements say to read from stdin"<BR>
igor says, "They'll both work, but gdb/dig doesn't deal well with stuff coming from stdin"<BR>
gabor_[Guest] says, "can you fix it?"<BR>
Bruce says, "sure.  We can also leave it until the last minute if there's an advantage now"<BR>
gabor_[Guest] says, "put it in the todo"<BR>
gabor_[Guest] [to Bruce]: at least we kow that the simplifier gets invoked<BR>
Bruce says, "true -- but how do we know if it actually gets optimized?"<BR>
Bruce says, "well, I suppose it has to"<BR>
Bruce says, " but how can we tell in general?"<BR>
Bruce says, "Gabor -- there is an issue I've been wondering about..."<BR>
Bruce says, "d2c doesn't do tail-call elimination"<BR>
igor says, "Therefore huge programs will blow the stack..."<BR>
Bruce says, "are you actually returning from functions from time to time, or do you call cont(foo) all the time?"<BR>
igor says, "Fortunately for us, though, with debugging turned off, I think we get a fair amount of tail-call elimination from gcc..."<BR>
igor says, "Point lights seem to work."<BR>
Bruce says, "I don't know if there actually is a problem or not"<BR>
Bruce says, "I just watched a run, doig "fib.gml" which took 74 seconds, and stayed constant at 3280 KB for 90% of that time"<BR>
Bruce says, "but, otoh, I made one run blow out to 13 MB yesterday"<BR>
Bruce says, "... an still growing when it finished"<BR>
gabor_[Guest] says, "lets hope GCC optimizes enough tail calls, also the {} and [] do not increase stack."<BR>
gabor_[Guest] says, "The simplifier will also remove some depth"<BR>
gabor_[Guest] says, ""are you actually returning from functions from time to time, or"<BR>
gabor_[Guest] says, "I call cont all the time"<BR>
Bruce says, "interesting that it's not growing in rendering situations, then"<BR>
igor says, "Well, in rendering situations, the interpreter is kicked to live and returns pretty quickly..."<BR>
Bruce says, "but isn't the renderer called form the interpreter?"<BR>
Bruce is it a new interpreter for each pixel?<BR>
igor [to Bruce]: Sort of, yeah.<BR>
igor says, "I build up a 3-element stack, then invoke the interpretter."<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 <BR>
{/me me me apply} /loop loop loop apply<BR>
Segmentation fault (core dumped)<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "*instantly*"<BR>
gabor_[Guest] says, "you mean we should add tail-rec opt?"<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 -                         <BR>
{/me /n n 1 addi me me apply} /loop  0 loop loop apply<BR>
Segmentation fault (core dumped)<BR>
---------------------------------finished----------------------------------<BR>
igor says, "You should probably keep something to sense stack overflows..."<BR>
gabor_[Guest] says, "added to my todo"<BR>
igor has spotlights working, but not attenuating (yet)<BR>
gabor_[Guest] [to Bruce]: grab engine and optimizer!<BR>
gabor_[Guest] says, "in module def"<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 -<BR>
{/me /n n 2 lessi {1}{n 1 subi me me apply n 2 subi me me apply addi} if} /fib<BR>
30 fib fib apply<BR>
lexed : #('{', '/', #"me", '/', #"n", #"n", 2, #"lessi", '{', 1, '}', '{', #"n", 1, #"subi", #"me", #"me", #"apply", #"n", 2, #"subi", #"me", #"me", #"apply", #"addi", '}', #"if", '}', '/', #"fib", 30, #"fib", #"fib", #"apply")<BR>
<BR>
output: #(1346269)<BR>
<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "stayed constant mem at 3104 KB"<BR>
Bruce says, "so I think we're OK.  You must have changed something :-)"<BR>
gabor_[Guest] says, "err, in module definition add (temporarily) "use format-out, rename: {format-out => debug-print};"<BR>
gabor_[Guest] says, "Got the cvs?"<BR>
Bruce says, "yes"<BR>
gabor_[Guest] says, "does it compile?"<BR>
Bruce says, "it doesn't like the yen symbols in debug-print call"<BR>
gabor_[Guest] says, "change it to #"<BR>
gabor_[Guest] says, "it is bullet on the mac"<BR>
gabor_[Guest] says, "got a mug of tea..."<BR>
gabor_[Guest] says, "... I only slept 3 hrs last night"<BR>
Bruce says, "somethig wacky in the -exports .. ust a sec"<BR>
Bruce says, "mee too :-("<BR>
gabor_[Guest] says, "... but getting better."<BR>
Bruce says, "argh -- forgot the colon after "rename""<BR>
Bruce says, "OK, how do I test this?"<BR>
Bruce says, "jezuz -- what a lot of output"<BR>
gabor_[Guest] says, "write "1 2 addi""<BR>
gabor_[Guest] says, "then "1 { 41 addi } apply""<BR>
gabor_[Guest] says, "the most important thing is that things simplified once should never come back :-)"<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 -<BR>
2 3 addi<BR>
entering optimize-all: #(2, 3, #"addi") suppress: #f<BR>
entering optimize-all: #(3, #"addi") suppress: #t<BR>
entering optimize-all: #(#"addi") suppress: #t<BR>
optimizable-one returned: #(#"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(3, #"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(5) #f<BR>
optimizing more<BR>
entering optimize-all: #(5) suppress: #f<BR>
optimizable-one returned: #(5) #f<BR>
returning them<BR>
lexed : #(2, 3, #"addi")<BR>
<BR>
output: #(5)<BR>
---------------------------------finished----------------------------------<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 -<BR>
1 { 41 addi } apply<BR>
It is ambiguous which of these methods is most specific:<BR>
  #(, )<BR>
{the <method> optimizable-two{<integer>, singleton(#"addi"), <list>, singleton(#f)}}{the <method> optimizable-two{<object>, <object>, <pair>, <boolean>}}Aborted (core dumped)<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "same old problem again"<BR>
igor says, "Yay!  Spotlights work perfectly."<BR>
gabor_[Guest] says, "This is optimizable-two"<BR>
Bruce says, "yes, but same *sort* of pronlem"<BR>
igor says, "It even avoids testing shadow rays when the spotlight's 'light cone' doesn't cover the point..."<BR>
gabor_[Guest] says, "add a specialization with {integer, #"addi", <pair>} for optimizable-two"<BR>
igor commits the spotlights.<BR>
gabor_[Guest] says, "copying {integer, #"addi", <list>}"<BR>
Bruce says, "what's the commented out bit?"<BR>
gabor_[Guest] says, "dont worry"<BR>
Bruce says, "quick & dirty cloning..."<BR>
A small swarm of 3x5 index cards arrives, engulfs igor, and carries it away.<BR>
A small swarm of 3x5 index cards blows in and disperses, revealing igor.<BR>
A small swarm of 3x5 index cards arrives, engulfs igor, and carries it away.<BR>
A small swarm of 3x5 index cards blows in and disperses, revealing igor.<BR>
gabor_[Guest] says, "never mind this will come from macros!"<BR>
igor says, "OK... Cones, cylinders, and CSG is all that's left in the renderer..."<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 -1 { 41 addi } apply<BR>
<BR>
entering optimize-all: #(1, '{', 41, #"addi", '}', #"apply") suppress: #f<BR>
entering optimize-all: #('{', 41, #"addi", '}', #"apply") suppress: #t<BR>
entering optimize-all: #(41, #"addi", '}', #"apply") suppress: #t<BR>
entering optimize-all: #(#"addi", '}', #"apply") suppress: #t<BR>
entering optimize-all: #('}', #"apply") suppress: #t<BR>
entering optimize-all: #(#"apply") suppress: #t<BR>
optimizable-one returned: #(#"apply") #f<BR>
returning them<BR>
optimizable-one returned: #('}', #"apply") #f<BR>
returning them<BR>
optimizable-one returned: #(#"addi", '}', #"apply") #f<BR>
returning them<BR>
optimizable-one returned: #(41, #"addi", '}', #"apply") #f<BR>
returning them<BR>
optimizable-one returned: #('{', 41, #"addi", '}', #"apply") #f<BR>
returning them<BR>
optimizable-one returned: #(1, '{', 41, #"addi", '}', #"apply") #f<BR>
returning them<BR>
entering optimize-all: #('{', 41, #"addi", '}', #"apply") suppress: #f<BR>
entering optimize-all: #(41, #"addi", '}', #"apply") suppress: #t<BR>
entering optimize-all: #(#"addi", '}', #"apply") suppress: #t<BR>
entering optimize-all: #('}', #"apply") suppress: #t<BR>
entering optimize-all: #(#"apply") suppress: #t<BR>
optimizable-one returned: #(#"apply") #f<BR>
returning them<BR>
optimizable-one returned: #('}', #"apply") #f<BR>
returning them<BR>
optimizable-one returned: #(#"addi", '}', #"apply") #f<BR>
returning them<BR>
optimizable-one returned: #(41, #"addi", '}', #"apply") #f<BR>
returning them<BR>
optimizable-one returned: #('{', 41, #"addi", '}', #"apply") #f<BR>
returning them<BR>
entering optimize-all: #(41, #"addi", '}', #"apply") suppress: #f<BR>
entering optimize-all: #(#"addi", '}', #"apply") suppress: #t<BR>
entering optimize-all: #('}', #"apply") suppress: #t<BR>
entering optimize-all: #(#"apply") suppress: #t<BR>
optimizable-one returned: #(#"apply") #f<BR>
returning them<BR>
optimizable-one returned: #('}', #"apply") #f<BR>
returning them<BR>
optimizable-one returned: #(#"addi", '}', #"apply") #f<BR>
returning them<BR>
entering optimize-all: #('}', #"apply") suppress: #f<BR>
entering optimize-all: #(#"apply") suppress: #t<BR>
optimizable-one returned: #(#"apply") #f<BR>
returning them<BR>
optimizable-one returned: #('}', #"apply") #f<BR>
returning them<BR>
optimizable-one returned: #('}', #"apply") {Method optimizable-two{<integer>, singleton(#"addi"), <pair>, singleton(#f)} internal method (<pair>, <function>)}<BR>
returning them<BR>
entering optimize-all: #(#"apply") suppress: #f<BR>
optimizable-one returned: #(#"apply") #f<BR>
returning them<BR>
lexed : #(1, '{', 41, #"addi", '}', #"apply")<BR>
<BR>
output: #(42)<BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "you are a genius!"<BR>
Bruce says, "It was nothing..."<BR>
Bruce says, "Wait: you mean igor, right?"<BR>
gabor_[Guest] says, "now you can start doing weird combinations of negi and addi!"<BR>
igor hears his name.<BR>
igor [to Bruce]: When you get a chance, check out spotlight.gml<BR>
Bruce says, "igor, I'm trying to, but I'm getting MB of optimizer messages scrolling by..."<BR>
gabor_[Guest] says, ""2 negi 3 negi addi 45 100 addi addi""<BR>
igor [to Bruce]: Oh, never mind then...<BR>
Bruce says, "I tried to run it before you suggested it :-)"<BR>
igor has his Engine.dylan stickied to 1.8 :-)<BR>
gabor_[Guest] says, "and?"<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 -<BR>
2 negi 3 negi addi 45 100 addi addi<BR>
entering optimize-all: #(2, #"negi", 3, #"negi", #"addi", 45, 100, #"addi", #"addi") suppress: #f<BR>
entering optimize-all: #(#"negi", 3, #"negi", #"addi", 45, 100, #"addi", #"addi") suppress: #t<BR>
entering optimize-all: #(3, #"negi", #"addi", 45, 100, #"addi", #"addi") suppress: #t<BR>
entering optimize-all: #(#"negi", #"addi", 45, 100, #"addi", #"addi") suppress: #t<BR>
entering optimize-all: #(#"addi", 45, 100, #"addi", #"addi") suppress: #t<BR>
entering optimize-all: #(45, 100, #"addi", #"addi") suppress: #t<BR>
entering optimize-all: #(100, #"addi", #"addi") suppress: #t<BR>
entering optimize-all: #(#"addi", #"addi") suppress: #t<BR>
entering optimize-all: #(#"addi") suppress: #t<BR>
optimizable-one returned: #(#"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(#"addi", #"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(100, #"addi", #"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(145, #"addi") #f<BR>
optimizing more<BR>
entering optimize-all: #(145, #"addi") suppress: #t<BR>
entering optimize-all: #(#"addi") suppress: #t<BR>
optimizable-one returned: #(#"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(145, #"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(#"addi", 145, #"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(#"negi", #"addi", 145, #"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(-3, #"addi", 145, #"addi") #f<BR>
optimizing more<BR>
entering optimize-all: #(-3, #"addi", 145, #"addi") suppress: #t<BR>
entering optimize-all: #(#"addi", 145, #"addi") suppress: #t<BR>
entering optimize-all: #(145, #"addi") suppress: #t<BR>
entering optimize-all: #(#"addi") suppress: #t<BR>
optimizable-one returned: #(#"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(145, #"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(#"addi", 145, #"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(-3, #"addi", 145, #"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(#"negi", -3, #"addi", 145, #"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(-2, -3, #"addi", 145, #"addi") #f<BR>
optimizing more<BR>
entering optimize-all: #(-2, -3, #"addi", 145, #"addi") suppress: #f<BR>
entering optimize-all: #(-3, #"addi", 145, #"addi") suppress: #t<BR>
entering optimize-all: #(#"addi", 145, #"addi") suppress: #t<BR>
entering optimize-all: #(145, #"addi") suppress: #t<BR>
entering optimize-all: #(#"addi") suppress: #t<BR>
optimizable-one returned: #(#"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(145, #"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(#"addi", 145, #"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(-3, #"addi", 145, #"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(-5, 145, #"addi") #f<BR>
optimizing more<BR>
entering optimize-all: #(-5, 145, #"addi") suppress: #f<BR>
entering optimize-all: #(145, #"addi") suppress: #t<BR>
entering optimize-all: #(#"addi") suppress: #t<BR>
optimizable-one returned: #(#"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(145, #"addi") #f<BR>
returning them<BR>
optimizable-one returned: #(140) #f<BR>
optimizing more<BR>
entering optimize-all: #(140) suppress: #f<BR>
optimizable-one returned: #(140) #f<BR>
returning them<BR>
lexed : #(2, #"negi", 3, #"negi", #"addi", 45, 100, #"addi", #"addi")<BR>
<BR>
output: #(140)<BR>
<BR>
---------------------------------finished----------------------------------<BR>
igor says, "<A HREF="http://secret-lab.dartmouth.edu/~igor/spotlight.gif" TARGET="_blank">http://secret-lab.dartmouth.edu/~igor/spotlight.gif</A>"<BR>
gabor_[Guest] [to igor]: we will win if you go on...<BR>
Bruce says, "igor..."<BR>
Bruce says, "on the image on your web site, the floor is gray (where it isn't lighted)"<BR>
igor says, "Ambient light."<BR>
Bruce says, "on the imiage I just made here, the floor is black"<BR>
igor scratches his head.<BR>
Bruce says, "on their sample image the floor is black too"<BR>
igor [to Bruce]: Your monitor/video system is messed up, then...<BR>
igor says, "on <A HREF="http://www.cs.bell-labs.com/who/jhr/icfp/examples.html" TARGET="_blank">http://www.cs.bell-labs.com/who/jhr/icfp/examples.html</A>, there is grey on the floor quite clearly..."<BR>
Bruce says, "yes, but it's much much darker"<BR>
igor says, "They look identical to me..."<BR>
igor says, "md5sum your image..."<BR>
Bruce says, "hmm -- you're right.  Must be a difference in the gamma from the Mac to the linux box"<BR>
Bruce says, "both show gray on the Mac, bot show near black on linux"<BR>
igor gets 3cbd5aa6b86b9dae145eb2ebc4f33851<BR>
igor says, "OK, good..."<BR>
gabor_[Guest] [to Bruce]: optimizer works, please check in, // commenting out the debug-prints<BR>
igor says, "For a moment there, I thought we were both on crack..."<BR>
Bruce says, "I'd like to see that on with a ball suspended above the plane, in the middle of the lights"<BR>
igor says, "OK..."<BR>
gabor_[Guest] says, "now I add the simplification stuff to the math-primitives :-)"<BR>
Bruce says, "it's checked in"<BR>
igor says, "So, can I upgrade to the latest Engine?"<BR>
Bruce says, "OK, I'm going to work on error handling for a while"<BR>
igor says, "(without getting massively spammed)"<BR>
Bruce says, "yes"<BR>
Bruce says, "just a sec .. let me check..."<BR>
Bruce says, "yes"<BR>
Bruce says, "spotlight only takes 8 seconds"<BR>
igor hmms...<BR>
gabor_[Guest] [to Bruce]: do you know report-condition?<BR>
Bruce says, "??"<BR>
gabor_[Guest] says, "look into conditions.dylan in the dylan runtime lib"<BR>
gabor_[Guest] says, "it is a very fine utility GF giving verbose descriptions about errors."<BR>
gabor_[Guest] [to igor]: interpreter still working? :-<<BR>
Bruce says, "OK, so I'll just catch <condition>, print a nice message say that an interpreter error occured, call report-condition, and print a message saying that we are outta here."<BR>
Bruce says, "That'll make it look as if we have it under control -- especially if I mention ICFP somewhere :-)"<BR>
igor says, "OK, where's this 'optimize-compile-GML' coming from?"<BR>
Bruce says, "oh, sorry .. justa sec"<BR>
Bruce says, "update again"<BR>
Bruce says, "that's the makefile, -exports, and .lid"<BR>
igor nods.<BR>
gabor_[Guest] says, "catch <simple-error> first <error> next and leave alone other conditions."<BR>
Bruce says, "why?"<BR>
Bruce says, "we *never8 want to crash"<BR>
gabor_[Guest] says, "for <error> you can add that this is a serious error."<BR>
gabor_[Guest] says, "do not forget to exit code != 0 !!!!! otherwise we lose."<BR>
Bruce says, "which one will no-applicable-methods throw?"<BR>
Bruce says, ".. and ambiguous-methods"<BR>
gabor_[Guest] says, "hopefully not :-|"<BR>
Bruce says, "I know -- Im even writing a little driver script to check that works"<BR>
gabor_[Guest] says, "fantastic"<BR>
Bruce says, "are you working OK, igor?"<BR>
igor nods.<BR>
igor says, "Looks good."<BR>
igor says, "Anyone mind if the lexer debug output goes away?"<BR>
Bruce says, "I'm just doing that now"<BR>
igor says, "And the vector diagnostics can vanish, too."<BR>
Bruce says, "already gone..."<BR>
Bruce says, "gimme a break!"<BR>
igor will be back in a few minutes.<BR>
igor says, "Oh, we also need to think of a cool name for this project..."<BR>
Bruce says, "do we want to print the output stack?"<BR>
gabor_[Guest] says, "to bruce macros are in. get optimizer and math-prims"<BR>
Bruce says, "one minute"<BR>
Bruce says, "where do I impot report-condition from?"<BR>
gabor_[Guest] says, "uncomment the debug-prints and try if the simplification now haoppens for all unary and binary primitives"<BR>
gabor_[Guest] says, "test "44 2 subi" and with subf"<BR>
gabor_[Guest] says, "test "44 { 2 subi } apply" and with subf"<BR>
Bruce says, "extensions, i think"<BR>
gabor_[Guest] says, "test "{ 3 ]" ;-)"<BR>
gabor_[Guest] says, "condition-ext?"<BR>
Bruce says, "extensions did it"<BR>
gabor_[Guest] says, "I may be disconnected from the internet soon, we are reassigning IP numbers here"<BR>
gabor_[Guest] says, "so you may be on your own with the compiler..."<BR>
gabor_[Guest] says, "hopefully not too long -- sigh"<BR>
gabor_[Guest] says, "How mich did the binary increase?"<BR>
Bruce says, "how big is the program now, you mean?"<BR>
gabor_[Guest] says, "yes and after my recent additions."<BR>
Bruce says, "6705628, or 1854740 stripped"<BR>
Bruce says, "oh, I haven't added your stuff yet :-("<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 <BR>
1 2 sdfsdfs<BR>
Sorry, Dylan Hacker has detected an error<BR>
=========================================<BR>
no symbol #"sdfsdfs" in environment<BR>
=========================================<BR>
<BR>
Program terminating with error status<BR>
[bruce@k7 src]$ <BR>
---------------------------------finished----------------------------------<BR>
Bruce cvs updating<BR>
gabor_[Guest] says, "looks good. And "3 0 divi"?"<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ./icfp2000 <BR>
3 0 divi  <BR>
Sorry, Dylan Hacker has detected an error<BR>
=========================================<BR>
Division by zero.<BR>
=========================================<BR>
<BR>
Program terminating with error status<BR>
[bruce@k7 src]$ <BR>
---------------------------------finished----------------------------------<BR>
You hear a quiet popping sound; Karl-Heinz_Guest has disconnected.<BR>
Bruce says, "Igor?"<BR>
Bruce pings<BR>
igor nods.<BR>
Bruce says, "hello!"<BR>
igor says, "What's up?"<BR>
Bruce says, "hi!"<BR>
Bruce says, "my stuff is going well"<BR>
igor says, "Excellent..."<BR>
igor says, "What are you working on?"<BR>
Bruce says, "it seems pretty error-proof, except for  acoupple of things that Gabor might have to look at"<BR>
Bruce says, "if there is a stack underflow then the program exits with an error, but it's not a graceful one"<BR>
igor nods.<BR>
Bruce says, "Expected an instance of {Class <pair>}, but got #()"<BR>
Bruce says, "hold on .. got email from Gabor .. will reply"<BR>
igor nods.<BR>
Bruce says, "back"<BR>
Bruce says, "he's onto it, but doesn't have the net yet (seems to have email though...)"<BR>
igor nods.<BR>
Bruce says, "so, what are your plans?  You slept?"<BR>
Bruce says, "cone/cube/cylinder??"<BR>
Bruce says, "... and pointlight"<BR>
Bruce thinks tier 3 ain't going to happen, but 2 can!<BR>
igor slept a bit.<BR>
igor says, "Hey, spotlights work great, so if somone can figure out CSG..."<BR>
Bruce says, "do we have pointlights?"<BR>
igor says, "Yep."<BR>
Bruce says, "I've figured out CSG, but I expect you canimplement it faster if I explain it to you..."<BR>
igor says, "Let me get a little more programming fluid in my bloodstream..."<BR>
igor says, "OK, in that case, if I work on CSG, can you work on cube/cone/cyls?"<BR>
Bruce says, "I'm starting to fade (it's 2am) but don't have time to sleep so I'll try to hang in there..."<BR>
Bruce says, "7 hours to go"<BR>
igor grins.<BR>
igor says, "Yeah, I caught sleep from ~7:30 to 10:30 our-time"<BR>
igor says, "Er, my-time"<BR>
Bruce says, "15 minutes after deadline, Svetlana has a phone technical interview with people in Chicago, two hours later I have to show real-estate people around my house."<BR>
igor grins.<BR>
igor says, "Read the Encouraging Message on gd-hackers?"<BR>
igor says, "(and info-dylan, too)"<BR>
Bruce says, "I can look at the L2 primitives.  Let me read your sphere code before I decide..."<BR>
igor grins.<BR>
igor says, "It's not too bad, you just need to sit down with the math..."<BR>
Bruce says, "if you can do at least, say, cube, then I'll know that the framework is there"<BR>
igor says, "F&vD is very useful, as well..."<BR>
Bruce says, "the math is no problem -- it's the organization of the code"<BR>
Bruce says, "Another thing that I could do is to do the same for other classes that I did for matrix/vector"<BR>
Bruce says, "If we can't do tier 3 then we can at least win with sheer speed!"<BR>
igor has a hunch that if we can can get to Tier 3, then the only people up there will be people that are limping along, or people who will just smoke us because they invoked POVray or are descended directly from deities...<BR>
Bruce says, "we have all the drawing effects now don't we?"<BR>
igor says, "Drawing effects?"<BR>
Bruce says, "specular, reflection..."<BR>
igor nods.<BR>
igor says, "They all seem to work exactly as specified."<BR>
Bruce says, "did you get the depth spec correct?"<BR>
Bruce says, "if they pass zero as the depth then they expect that you don't do any reflection but do everything else"<BR>
igor says, "So, cubes are from $origin to (1,1,1)"<BR>
igor nods.<BR>
igor says, "So, in order to do cubes, hit test on 6 planes..."<BR>
Bruce says, "SORRY -- 'depth' is for specular.  reflection is infinite depth"<BR>
igor says, "If you get a hit, see if all coordinates are between 0.0 and 1.0."<BR>
igor says, "They lump specular and reflection somewhat together."<BR>
Bruce says, "yes, I understand how to hit test a cube in it's own space"<BR>
Bruce says, "the question is what *else* do I have to do?"<BR>
igor says, "Return the appropriate point on the cube, the normal, and the appropriate surface closure."<BR>
igor wishes there were a "team listing" so we knew who we were dealing with...<BR>
Bruce says, "one of the things for CSG is that you should return *all* intersections with the object, as a list"<BR>
igor says, "Right...  We may need to juice up our hit-testing framework a tad, then..."<BR>
igor says, "OK, well, why don't we get L2 primitives working first..."<BR>
igor works on writing a quick "does this ray hit this plane, if so, where" method.<BR>
Karl-Heinz_Guest has connected.<BR>
>> Karl-Heinz_Guest is now known as gabor_[Guest].<BR>
igor waves.<BR>
gabor_[Guest] says, "Hello!"<BR>
gabor_[Guest] says, "any new"<BR>
igor just woke back up.<BR>
gabor_[Guest] says, "tier 1 ready?"<BR>
igor's starting on the L2 solids.<BR>
igor says, "Tier one is done."<BR>
igor says, "(At least in the renderer...)"<BR>
gabor_[Guest] says, "what if we are in the solid half of a plane?"<BR>
gabor_[Guest] says, "what is missing then tier 1"<BR>
igor says, "A little testing and bugfixing, I s'pose..."<BR>
gabor_[Guest] says, "Andreas?"<BR>
igor says, "Things like "what if the viewer is inside the sphere" and other weird stuff like that."<BR>
gabor_[Guest] says, "can erik do that or someone else?"<BR>
igor dunnos.<BR>
gabor_[Guest] says, "tere is a new task.dpf"<BR>
igor grabs it and prints it out...<BR>
gabor_[Guest] says, "tier2?"<BR>
igor says, "We need cones, cylinders and cubes to be tier-II friendly..."<BR>
gabor_[Guest] says, "can we get them?"<BR>
igor says, "It shouldn't be too bad..."<BR>
igor's working on cubes right now.<BR>
gabor_[Guest] says, "tier3?"<BR>
igor says, "CSG: intersection & difference."<BR>
gabor_[Guest] says, "any chance with that?"<BR>
igor says, "Maybe..."<BR>
gabor_[Guest] [to Bruce]: how long do you wake? Can you test my uscale optimization?<BR>
Bruce says, "hi"<BR>
Bruce says, "I'm getting sleepy"<BR>
Bruce says, "if you guys are bot able to program creatively I guess I can do some grunt work..."<BR>
gabor_[Guest] [to igor]: can you show me a typical _constant_ surface func?<BR>
Bruce says, "Gabor!  We're fast enough!"<BR>
igor grins at Bruce.<BR>
gabor_[Guest] [to Bruce]: I checkin graphics prims in a mo.<BR>
gabor_[Guest] says, "there is no such thing as fast enough :-)"<BR>
igor notes that speed improvements to the interpretter are not likely to win us too, too much if our ray-tracer sucks...<BR>
Bruce says, "depends on what else needs doing"<BR>
Bruce is going to have another panadol and a quick shower<BR>
gabor_[Guest] says, "my build system is screwed so I cannot test"<BR>
igor nods.<BR>
gabor_[Guest] [to Bruce]: does "3 1 subi 4 { 3 subi }" work? -- getting paranoid<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ time ./icfp2000 <BR>
3 1 subi 4 { 3 subi }<BR>
Run sucessful, final stack: 2 4 {Method rcurry{<function>} internal method ()} <BR>
---------------------------------finished----------------------------------<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ time ./icfp2000 <BR>
3 1 subi 4 { 3 subi } apply<BR>
Run sucessful, final stack: 2 1 <BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "Thanks"<BR>
igor grins:<BR>
-----------------------------------igor------------------------------------<BR>
define constant $cube-planes =  vector(vector(vector3D( 0.0,  0.0, -1.0), 0.0), // Front<BR>
       vector(vector3D( 0.0,  0.0,  1.0), 1.0), // Back<BR>
       vector(vector3D(-1.0,  0.0,  0.0), 0.0), // Left<BR>
       vector(vector3D( 1.0,  0.0,  0.0), 1.0), // Right<BR>
       vector(vector3D( 0.0,  1.0,  0.0), 1.0), // Top<BR>
       vector(vector3D( 0.0, -1.0,  0.0), 0.0)); // Bottom<BR>
<BR>
define constant $u-methods = vector(x, x, z, z, y, y);<BR>
define constant $v-methods = vector(y, y, y, y, z, z);<BR>
<BR>
define method real-intersection-before(m :: <cube>, ray, distance, #key shadow-test: shadow-test?)<BR>
 => (point, normal, surface-method, new-distance)<BR>
  for (p in $cube-planes, which-one from 0)<BR>
    let hit = plane-intersection(p[0], p[1], ray);<BR>
    if (hit & hit.x <= 1.0 & hit.y <= 1.0 & hit.z <= 1.0<BR>
    & hit.x >= 0.0 & hit.y >= 0.0 & hit.z >= 0.0)<BR>
      values(hit, p[0], make-surface-closure(which, <BR>
     $u-methods[which](hit), <BR>
     $v-methods[which](hit), <BR>
     m.surface-interpreter-entry));<BR>
    end if;<BR>
  end for;<BR>
end method real-intersection-before;<BR>
---------------------------------finished----------------------------------<BR>
igor says, "The fun part is the $u-methods & $v-methods..."<BR>
igor says, "They're there to pick the right texture coordinates, depending on the side."<BR>
gabor_[Guest] says, "to bruce grafprims is in cvs. test "... sphere 5 uscale render" and "... sphere {5 uscale} apply render""<BR>
gabor_[Guest] says, ""... 5 /a sphere {a uscale} apply render""<BR>
igor says, "Cubes work!"<BR>
Bruce says, "Gaor, I don't think ... is a valid GML token"<BR>
gabor_[Guest] says, "put a surface func there"<BR>
Bruce says, "It's not too lat to get an account on my box or igor's box..."<BR>
Bruce says, "I don't know off the top of my head what one looks like.  I could look it up, of course"<BR>
igor <- back.<BR>
igor hmms.  More surface acne :-P<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ time ./icfp2000 <BR>
{ /v /u /face         % ignore the args<BR>
  0.0 0.0 1.0 point   % color<BR>
  1.0                 % Full diffusion coef<BR>
  0.0                 % No specular<BR>
  1.0                 % No phong, either<BR>
} 5.0 /a sphere {a uscale} apply render<BR>
Sorry, Dylan Hacker has detected an error<BR>
<BR>
=========================================<BR>
Expected an instance of {Class <string>}, but got {<sphere> instance}<BR>
=========================================<BR>
---------------------------------finished----------------------------------<BR>
igor says, "You need to give it a filename to render to..."<BR>
gabor_[Guest] says, "no just take an example.gml and insert 5 uscale after sphere"<BR>
gabor_[Guest] says, "I dunno the syntax either"<BR>
Bruce says, "well, it needs to be 5.0 for a start"<BR>
gabor_[Guest] says, "yep"<BR>
Bruce says, "with 1.0 uscale it looks the same as before"<BR>
igor hmms.<BR>
Bruce says, "and with 2.0 uscale it's twice as big -- strangely enough"<BR>
igor will check in his cube stuff... Can someone tell him how to fix it?<BR>
gabor_[Guest] says, "BTW all numbers are written in the .dylan sources with 3.0 notation. Should we change this to be #e3.0 ??"<BR>
Bruce says, "I can try"<BR>
Bruce says, "Gabor, I don't think it's worth spending a lot of time on this micro-optimization stuf now"<BR>
Bruce says, "*especially" if it means that both you and I are tied up"<BR>
gabor_[Guest] says, "OK I stop"<BR>
Bruce says, "if it was just oine of us I still wouldn't like it"<BR>
Bruce says, "if anything needs speed increase I think it's still the renderer"<BR>
igor says, "OK, update..."<BR>
igor says, "Try it out with checked-cube..."<BR>
Bruce says, "ok, 6.3 seconds"<BR>
Bruce says, "oooh -- acne"<BR>
igor says, "Also, it's not drawing two of the faces."<BR>
Bruce says, "it's not drawing the top"<BR>
igor says, "Or the right side."<BR>
Bruce says, "right"<BR>
igor figures out the acne problem.<BR>
Bruce says, "hey you're taking the first hit, not the closest one!"<BR>
igor says, "Hmm.  Good point, there..."<BR>
Bruce says, "please calculate all the hits, and put them in a list, and sort it"<BR>
igor nods.<BR>
Bruce says, "Gabor?"<BR>
gabor_[Guest] says, "dont really construct a list, just put in the minimum distance"<BR>
igor [to gabor_[Guest]]: No, actually, if we want to move onto CSG, we need all the hits...<BR>
gabor_[Guest] says, "use a custom setter"<BR>
Bruce says, "it's just as easy to make the list, and there will usually only be two points on it .. and we ned both of them to be returned later for CSG"<BR>
gabor_[Guest] says, "OK convinced"<BR>
igor says, "How do I sort a vector of vectors by the first element in the subvectors?"<BR>
igor says, "Ah..."<BR>
igor scratches his head.<BR>
gabor_[Guest] says, "go shopping"<BR>
gabor_[Guest] says, "back in half an hour"<BR>
Bruce says, "gabor?"<BR>
igor's checking in the next version of cubes...<BR>
Bruce says, "cool"<BR>
Bruce says, "man, I hope I didn't offend Gabor"<BR>
igor had been debating mentioning it...<BR>
igor says, "We need to write a README file, too..."<BR>
Bruce says, "i'm doing that at the moment"<BR>
gabor_[Guest] says, "no offense taken"<BR>
Bruce says, "I'll check in what I have so far"<BR>
gabor_[Guest] says, ":-)"<BR>
igor says, "(and CVS is flaky (again))"<BR>
gabor_[Guest] says, "I had that too"<BR>
gabor_[Guest] says, "what should go into the readme?"<BR>
Bruce says, "OK, check out the README"<BR>
-----------------------------------igor------------------------------------<BR>
secret-lab:~/src/ICFP2000/src$ ping berlin.ccc.de<BR>
PING berlin.ccc.de (195.21.255.248): 56 data bytes<BR>
<nothing at all><BR>
---------------------------------finished----------------------------------<BR>
igor :-P<BR>
Bruce says, "it's working fine here"<BR>
gabor_[Guest] says, "see you later"<BR>
-----------------------------------igor------------------------------------<BR>
define constant $cube-planes =  vector(vector(vector3D( 0.0,  0.0, -1.0), 0.0), // Front<BR>
       vector(vector3D( 0.0,  0.0,  1.0), -1.0), // Back<BR>
       vector(vector3D(-1.0,  0.0,  0.0), 0.0), // Left<BR>
       vector(vector3D( 1.0,  0.0,  0.0), -1.0), // Right<BR>
       vector(vector3D( 0.0,  1.0,  0.0), -1.0), // Top<BR>
       vector(vector3D( 0.0, -1.0,  0.0), 0.0)); // Bottom<BR>
<BR>
define constant $u-methods = vector(x, x, z, z, x, x);<BR>
define constant $v-methods = vector(y, y, y, y, z, z);<BR>
<BR>
define method real-intersection-before(m :: <cube>, ray, distance, #key shadow-test: shadow-test?)<BR>
 => (point, normal, surface-method, new-distance)<BR>
  let hits = make(<stretchy-vector>);<BR>
  for (p in $cube-planes, which-one from 0)<BR>
    let (hit, dist) = plane-intersection(p[0], p[1], ray);<BR>
    if (hit & $u-methods[which-one](hit) <= 1.0 & $v-methods[which-one](hit) <= 1.0 &<BR>
  $u-methods[which-one](hit) >= 0.0 & $v-methods[which-one](hit) >= 0.0)<BR>
      add!(hits, vector(dist, hit, p[0], make-surface-closure(which-one, <BR>
      $u-methods[which-one](hit), <BR>
      $v-methods[which-one](hit), <BR>
      m.surface-interpreter-entry)));<BR>
    end if;<BR>
  end for;<BR>
<BR>
  if (hits.size > 0)<BR>
    sort!(hits, test: method(a, b) a[0] < b[0]  end method);<BR>
    values(hits[0][1], hits[0][2], hits[0][3], ray.ray-position - hits[0][1]);<BR>
  else<BR>
    #f;<BR>
  end if;<BR>
end method real-intersection-before;<BR>
---------------------------------finished----------------------------------<BR>
-----------------------------------Bruce-----------------------------------<BR>
[bruce@k7 src]$ ping berlin.ccc.de<BR>
PING berlin.ccc.de (195.21.255.248) from 209.78.48.27 : 56(84) bytes of data.<BR>
64 bytes from berlin.ccc.de (195.21.255.248): icmp_seq=0 ttl=239 time=759.4 ms<BR>
64 bytes from berlin.ccc.de (195.21.255.248): icmp_seq=1 ttl=239 time=750.0 ms<BR>
64 bytes from berlin.ccc.de (195.21.255.248): icmp_seq=2 ttl=239 time=750.0 ms<BR>
64 bytes from berlin.ccc.de (195.21.255.248): icmp_seq=3 ttl=239 time=760.0 ms<BR>
---------------------------------finished----------------------------------<BR>
igor says, "Ah... It's back..."<BR>
igor says, "Briefly.  It's gone, again :-P"<BR>
Bruce says, "it's still fine here"<BR>
Bruce has ping going continuously<BR>
igor sighs.<BR>
Bruce says, "how much (if any) do you think we should evangalise in the README?"<BR>
-----------------------------------Bruce-----------------------------------<BR>
This archive contains an entry for the Third Annual ICFP<BR>
Programming Contest.<BR>
<BR>
Team name: Dylan Hackers<BR>
<BR>
Team Captain<BR>
  Name: Bruce Hoult<BR>
  Email: bruce@hoult.org<BR>
  Address: 65 Oxford St, Tawa, Wellington 6006, New Zealand<BR>
<BR>
<BR>
Team Members:<BR>
  Bruce Hoult <bruce@hoult.org>, New Zealand<BR>
  Andreas Bogk <andreas@andreas.org>, Germany<BR>
  Jeff Dubrule <igor@secret-lab.dartmouth.edu>, USA<BR>
  Gabor Greif <gabor@mac.com>, Germany<BR>
<BR>
<BR>
Language used: Dylan (Gwydion "d2c" 2.3.4pre1)<BR>
<BR>
This program has been implemented entirely in portable Dylan code,<BR>
and consists of a single file ("runme").  We didn't call out to<BR>
C to do the rendering.  We didn't use an open-source package<BR>
such as POVRay for the rendering (though we could have).  We<BR>
didn't use flex for the lexical analysis (though we could have).<BR>
<BR>
Most of us worked on the program using d2c on Linux or LinuxPPC.<BR>
One of us used Apple's 1995 alpha-quality "Dylan Technology<BR>
Release" (the project was cancelled during Apple's hard times)<BR>
on his Macintosh PowerBook.<BR>
---------------------------------finished----------------------------------<BR>
igor says, "Feel free to mention all that is nifty. & cool about it."<BR>
igor says, "OK, got it checked in."<BR>
igor says, "For example, that we have an optimizing compiler..."<BR>
igor says, "That our rendering resolution is not memory-bound"<BR>
Bruce says, "still no top or right"<BR>
Bruce says, "spoeckles are gone though"<BR>
igor says, "That we are (hopefully) a Tier-II-compliant renderer, plus spotlights."<BR>
Bruce says, "did you get the surface normals in the right direction?"<BR>
igor believes so.<BR>
igor says, "The 'd's might be off by a bit, though..."<BR>
Bruce says, "interesting!!!!"<BR>
igor says, "?"<BR>
Bruce says, "not knowing what I'm doing ... I chnaged the cube-planes entry for top to have the last number = 1.0 instead or -1.0."<BR>
Bruce says, "... and now it's visibly, 1 unit below the bottomof the cube"<BR>
igor nods.  That makes sense...<BR>
Bruce says, "right"<BR>
Bruce says, "so why wasn't it visible before?"<BR>
igor tries reversing the sort condition...<BR>
igor says, "No dice :-P"<BR>
Bruce says, "I tried making it -2.0 now, expecting to see it above the cube.  nope"<BR>
igor says, "Well, the cube might be in a bad place for that..."<BR>
igor says, "These planes are only 1-sided..."<BR>
igor says, "Wait, no they're not..."<BR>
Bruce says, "I think I may have it"<BR>
igor says, "oh?"<BR>
Bruce says, "... wait"<BR>
Bruce says, "nope.  drat"<BR>
igor notes that the problem is that we're simply drawing the back layer for places where we should be drawing the front layer...<BR>
igor says, "Except for the front face, which works..."<BR>
Bruce says, "what are these x/y/z things in the $u-methods, $v-methods?"<BR>
igor points at page 14.<BR>
Bruce says, "yeah, but where are x & y & z declared?  what are they?"<BR>
igor says, "They are methods."<BR>
Bruce says, "which do what?"<BR>
igor says, "$u-methods[which-one](hit).  That gives you hit.[xyz], where [xyz] is the correct value of 'u' as listed in the table"<BR>
igor has an idea...<BR>
igor says, "Bingo!  Working cubes."<BR>
igor didn't assign the result of the sort anywhere.<BR>
Bruce says, "doh!"<BR>
gabor_[Guest] says, "we really ned a warning on this!"<BR>
igor says, "No, that was me saying 'sort!(hits, ...)' instead of 'hits := sort!(hits, ...)'"<BR>
gabor_[Guest] says, "that only works on vectors"<BR>
gabor_[Guest] says, "not on lists"<BR>
gabor_[Guest] says, "i mean the sort!(hits, ...)"<BR>
igor says, "Doesn't work on some vectors either..."<BR>
Bruce says, "do you need that new p[0] time ray-direction stuff?"<BR>
Bruce says, "Gabor, would you like to have a lok at the lexer and see if you can macro-ize the table building?"<BR>
gabor_[Guest] says, "how true, I confused it with reverse!"<BR>
gabor_[Guest] says, "of course!"<BR>
igor hmms.<BR>
igor says, "OK.  Next question..."<BR>
igor says, "Why doesn't it look like the example image..."<BR>
igor says, "It's rotated slightly wrong."<BR>
igor hmms.  All of our [xyz]-rotate functions were slightly off.<BR>
Bruce says, "you rotated in the wrong direction"<BR>
Bruce says, "z-rotate"<BR>
igor doesn't get it...<BR>
Bruce says, "what?"<BR>
igor says, "Why it's not rotating right..."<BR>
igor fixed the matrix code in obj.dylan, with still no effect...<BR>
igor hmms.  If I reverse the two rotates in checked-cube.dylan, it looks a bit better...<BR>
igor [to Bruce]: Can you worry about that, and I'll move on to cylinders & cones?<BR>
Bruce says, "sure"<BR>
-------------------------------gabor_[Guest]-------------------------------<BR>
what exactly should be macroized? the compile-state-machine part?<BR>
something like<BR>
define state-machine $Initial-State()<BR>
	state start() " \t..." => whitespace,<BR>
			'/' => binder;<BR>
	state double-quote(string-literal)<BR>
		;<BR>
etc.<BR>
end state-machine<BR>
<BR>
this style?<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "something liek that, yeah"<BR>
Bruce says, "whatever you think makes the most compact, readable, code"<BR>
gabor_[Guest] says, "rotates are not commutative! I learned that in quantum mechanics :-)"<BR>
Bruce says, ".. and shows off just a little bit"<BR>
igor knows.<BR>
Bruce says, "are we concatenating our matrixes in the right order?"<BR>
igor just rearranged the order in obj.dylan, as it seemed bogus before...<BR>
gabor_[Guest] says, "you get the macro. please keep the lexer.c output for comparison"<BR>
Bruce says, "ok, copying it now :-)"<BR>
gabor_[Guest] says, "matrix multiply is associative"<BR>
gabor_[Guest] says, "but be aware of badly conitioned broblems :-)"<BR>
igor hmms.<BR>
igor says, "All the rotation functions work correctly when used alone.  They break down when combined..."<BR>
gabor_[Guest] says, "maybe you are implicitly using a transposed matrix and Mt * Nt != (M*N)t"<BR>
gabor_[Guest] says, "Breaking News "<BR>
gabor_[Guest] says, "Tue 8:00am EDT:  Did you read them?"<BR>
gabor_[Guest] says, "They have bugs too :-)"<BR>
Bruce says, "they've had *lots* of bugs"<BR>
Bruce says, "hmmm .. if we're not going to get CSG done, how about enabling intersect and difference and just make them the same as union for now?"<BR>
igor implemented them as "identity" for now...<BR>
igor says, "SO obj1 - obj1 => obj1"<BR>
Bruce says, "i think the dice one would look OK as union"<BR>
igor supposes...<BR>
Bruce says, "... ytou'd have to look *real* closely to tell the difference"<BR>
gabor_[Guest] says, "I have an initial working macro. :-)"<BR>
gabor_[Guest] says, "checking in soon"<BR>
gabor_[Guest] [to Bruce]: can compare the c files here<BR>
Bruce says, "ok"<BR>
igor [to Bruce]: Looked at that rotation issue yet?<BR>
Bruce says, "can you tell me just before you check in?"<BR>
Bruce says, "igor, ina few minutes"<BR>
igor nods.<BR>
Bruce says, "Igor: someone's dropped us some pseudo-code for doing CSG. Are we interested?"<BR>
gabor_[Guest] says, "if it works?"<BR>
igor says, "Well, the cube is already rigged to provide > 1 value, and the sphere is really easy in that regard..."<BR>
igor says, "And planes, well..."<BR>
igor says, "Whence came this CSG code?"<BR>
Bruce says, "y'all will have email shortly"<BR>
jon.dyte [Guest] has connected.<BR>
Bruce says, "who is john dyte?"<BR>
gabor_[Guest] says, "Generates same C code - modulo comments :-)"<BR>
gabor_[Guest] says, "can somebody verify lexer.dylan, it is checked in"<BR>
Bruce says, "ok"<BR>
Bruce says, "yep -- it still works"<BR>
gabor_[Guest] says, "that macro can go back straight into d2c! :-)"<BR>
emk [Guest] has connected.<BR>
igor [to emk [Guest]]: Good morning...<BR>
emk [Guest] glances nervously at the clock.<BR>
emk [Guest]  Hello!<BR>
gabor_[Guest] says, "how mich left?"<BR>
igor [to gabor_[Guest]]: 'look clock'<BR>
gabor_[Guest] glances nervously at the clock.<BR>
Bruce says, "all the line number comments changed (of course), but other than that it looks the same"<BR>
Bruce says, "2hours 10 minutes"<BR>
gabor_[Guest] says, "this is what I have found too"<BR>
emk [Guest] says, "Not much time left, but you folks have been doing an amzazing job..."<BR>
Bruce says, "Eric!!!"<BR>
emk [Guest] says, "I'm consulting, but just wanted to say hi."<BR>
emk [Guest] says, "Can I help with anything in the time remaining?"<BR>
gabor_[Guest] says, "invested a bit of sweat that's all"<BR>
Bruce says, "there's still time for you to touch some code and get your name in the credits :-)"<BR>
Bruce ignores the fact that Gabor's isn't in most files yet...<BR>
igor says, "Can any speed be eeked out of this by sealing a bunch of stuff?"<BR>
Bruce has been trying<BR>
Bruce got about 15% extra in the last hour<BR>
gabor_[Guest] says, "you can also build the beast and stress test the GML compiler"<BR>
Bruce says, "nothing compared to doing the vector stuff"<BR>
igor nods.<BR>
gabor_[Guest] says, "but 40 * 1.15 makes a difference!"<BR>
Bruce says, "Eric, sheck this out..."<BR>
emk [Guest] says, "Check what out, Bruce?"<BR>
gabor_[Guest] says, "Are the transform issues resolved?"<BR>
-----------------------------------Bruce-----------------------------------<BR>
{/body /max /min<BR>
   {/me /i i max lessi {i body apply i 1 addi me me apply}{} if} /me<BR>
   min me me apply<BR>
} /for<BR>
<BR>
1 1000 {/x<BR>
  1 1000 {/y<BR>
<BR>
    x y modi /mod<BR>
    x y divi /div<BR>
<BR>
    y div muli mod addi  x eqi {<BR>
      % "OK for" x y<BR>
    }{<BR>
       "fail for" x y<BR>
    } if<BR>
<BR>
  } for apply<BR>
} for apply<BR>
---------------------------------finished----------------------------------<BR>
igor doesn't believe so...<BR>
Bruce says, "that's *nasty* code."<BR>
Bruce says, "but it runs well"<BR>
gabor_[Guest] says, "we could go straight into the renderman business..."<BR>
igor says, "Assuming that we can figure out how to render a frickin' cylinder..."<BR>
Bruce says, "problems?"<BR>
igor says, "It's just annoying & time-consuming math..."<BR>
You hear a quiet popping sound; Paul_Guest has disconnected.<BR>
emk [Guest] says, "These PPM files take a while to check out over a modem..."<BR>
igor grins at emk.<BR>
Bruce says, "to find the intersection, the thing to do is to ignore the y coordinate at first, and just calculate the intersections with a circle"<BR>
igor's doing that.<BR>
Bruce says, "once you have that, just substitute the x and z into the line equation"<BR>
emk [Guest]  is just downloaded 6 ppm files.<BR>
emk [Guest] glances nervously at the clock.<BR>
Bruce says, "cone is much nastier :-("<BR>
Bruce says, "I dont know exacty what is happening with this checked cube :-("<BR>
Bruce says, "if you reverse the order of the rotations then it's sorta right, but the wrong size and distance away"<BR>
gabor_[Guest] says, "maybe it helps that cutting a cone with a plane always gives you a point or ellipis or hyperbola they are all described by the"<BR>
Bruce says, "the rotates are by the right amount and in the right direction"<BR>
gabor_[Guest] says, "same equation"<BR>
gabor_[Guest] glances nervously at the clock.<BR>
Bruce glances nervously at the clock.<BR>
emk [Guest]  finished with check out & now reading code.<BR>
Bruce says, "Engine.dylan is a work of art"<BR>
emk [Guest]  bows to Gabor Greif<BR>
igor says, "Yay..."<BR>
igor licked the rotation problem...<BR>
Bruce says, "what!!!???"<BR>
Bruce says, "cool!"<BR>
Bruce says, "hey!  I jusy now spoted a problem!"<BR>
Bruce says, "a missing - in the x-rotation"<BR>
igor says, "The trick is that you should matrix mult: TTTA, but A'T'T'T', it seems."<BR>
Bruce says, "no .. it's OK"<BR>
Bruce says, "um .. yes, I know that"<BR>
igor says, "Well, it wasn't doing that precisely enough..."<BR>
emk [Guest]  is massively impressed, but has no idea how to help. ;-)<BR>
Bruce says, "... but I haven't seen that code"<BR>
emk [Guest] glances nervously at the clock.<BR>
Bruce says, "check it in .. ckeck it in ..."<BR>
igor [to emk [Guest]]: Try to get some more speed out of it...<BR>
gabor_[Guest] [to emk [Guest]]: can you fix the headers etc to contain consistent author and licensing infos? My files miss it -- thanks!<BR>
igor says, "Hint: we do a *lot* of matrix math..."<BR>
emk [Guest] says, "Where are the hot spots?"<BR>
emk [Guest]  will add licensing info, look at matrix math<BR>
igor nods.<BR>
Bruce says, "well, once we got a 40X speedup there aren't too many strong ones left, i think"<BR>
gabor_[Guest] says, "maybe we could look for identity matrices?"<BR>
Bruce says, "we concatenate all the mtransforms for an object into one matrix already"<BR>
igor [to emk [Guest]]: Actually here's an easy one: in obj.dylan, record the fact that the matrix hasn't been touched.<BR>
emk [Guest] says, "Files should say "copyright: this program may be freely used by anyone, for any purpose"<BR>
Bruce says, "there aren't too many objects that are never transformed at all..."<BR>
igor [to emk [Guest]]: Then set it dirty upon calling a transform.<BR>
igor says, "Thus, allowing us to skip transforms in intersection.dylan"<BR>
igor <- checked in.<BR>
jon.dyte [Guest] has connected.<BR>
Bruce says, "if you want a serious speedup for complex scenes (where it matters), add a bounding sphere for each CSG-union, and check it before recursing into the components"<BR>
gabor_[Guest] glances nervously at the clock.<BR>
Bruce says, "just see how long fib.gml takes..."<BR>
jon.dyte [Guest] glances nervously at the clock.<BR>
emk [Guest]  looks at bounding spheres, but doesn't expect to figure them out in time...<BR>
igor hmms.  Actually, it might be best to make me the team captain, as I'm planning on going to the Montreal conference if we win...<BR>
Bruce says, "yes!  Pixel perfect on checked cube!!!  Yahooo!"<BR>
igor [to Bruce]: Could you recheck the other images?<BR>
Bruce says, "sure"<BR>
Bruce says, "re captain: the captain's name was stated when the team was registered"<BR>
igor shrugs.  We could tell them we changed it...<BR>
Bruce says, "which I did about three hous after I posted the first message to the list, when no one had replied yet"<BR>
igor grins.<BR>
gabor_[Guest] grins.<BR>
Bruce says, "It doesn't make any difference to who goes where, anyway.  DOes it?"<BR>
gabor_[Guest] glances nervously at the clock.<BR>
igor says, "No, it doesn't..."<BR>
gabor_[Guest] says, "Just send postcards"<BR>
jon.dyte [Guest] says, "hello, I've been watching this in between going to work ; what's the story as the deadline approaches""<BR>
Bruce says, "someone will have to make a speech in my name ;-)"<BR>
igor grins.<BR>
gabor_[Guest] grins.<BR>
Bruce says, "to whom do we have the pleasure of speaking?"<BR>
gabor_[Guest] says, "what about igor -- in russian"<BR>
igor smacks his forehead as he restarts ./icfp2000 after just finishing a successful 'dice' run, but not actually seeing the image... :-P<BR>
igor isn't even a little bit russian...<BR>
Bruce says, "da tovarich"<BR>
Bruce says, "moi russki nye ochen horushu"<BR>
gabor_[Guest] says, "govarish pa russki?"<BR>
jon.dyte [Guest] says, "jon dyte, subscriber on gd list fun-o hacker, england, soory forgot the formalities, but i'm new to this thing and telnet seems sub-optimal way to ""<BR>
Bruce says, "nye ochen"<BR>
gabor_[Guest] says, "nitshewo"<BR>
igor says, "Well, with a proper client, it's quite nice."<BR>
jon.dyte [Guest] says, "is there one for linux""<BR>
igor says, "Use 'tinyfugue'..."<BR>
gabor_[Guest] says, "JAVA"<BR>
Bruce says, "painyatnya"<BR>
emk [Guest] glances nervously at the clock.<BR>
igor says, "It's text-based, but it is definitely the client-of-choice for most people who've been doing this for a while..."<BR>
igor says, "(and who use Unix...)"<BR>
Bruce says, "ochen malinki vremya"<BR>
-----------------------------------igor------------------------------------<BR>
/icfp2000 ../examples/dice.gml<BR>
Run sucessful, final stack: {Method rcurry{<function>} internal method ()}<BR>
---------------------------------finished----------------------------------<BR>
igor says, "Is that at all supposed to happen?"<BR>
igor loses the bit where we accept a file as an argument...<BR>
gabor_[Guest] says, "da, nye znaju kogda ja utshil etot jazik"<BR>
gabor_[Guest] says, "graphics prims"<BR>
gabor_[Guest] says, "look render line 74"<BR>
Bruce says, "hmmm ... 'yes, not know when I ??? that  ???'"<BR>
gabor_[Guest] says, "learned language"<BR>
gabor_[Guest] [to Bruce]: are you an agent<BR>
Bruce says, "nyet!"<BR>
gabor_[Guest] says, "horosho"<BR>
Bruce says, "I just discovered a use for Enlightenment!"<BR>
emk [Guest]  gives up on graphics code--not smart enough. ;-)<BR>
Bruce says, "comparing two images, using translucent dragging mode"<BR>
igor grins.<BR>
Bruce says, "both sphere and sphere2 are pixel-perfect"<BR>
gabor_[Guest] says, "dont we want to add 3d letter rendering from OpenType descrs?"<BR>
Bruce says, "tomorrow"<BR>
igor says, "If anyone wants to work on the cylinder mess for a bit, I checked it in..."<BR>
gabor_[Guest] says, "something like "Hello world, here are the Dylan Hackers!" text 42 scale render"<BR>
gabor_[Guest] glances nervously at the clock.<BR>
Bruce says, "/Times-Roman findfont 200 scalefont setfont 100 100 moveto (Hello world, here are the Dylan Hackers!) show showpage"<BR>
jon.dyte [Guest] says, "how long should dice.gml take to render; dual celery 450Mhz""<BR>
igor says, "GML syntax error: character '\n' may not start a token."<BR>
igor says, "tjat"<BR>
igor says, "er, that's kinda odd for a stack-underflow problem..."<BR>
igor says, "Also, 'Expected an instance of {Class <pair>}, but got #()' should report as an underflow..."<BR>
gabor_[Guest] says, "that say it all!"<BR>
emk [Guest]  groks engine & optimizer.<BR>
gabor_[Guest] says, "easy eh?"<BR>
gabor_[Guest] says, "found an infinite recursion? We could still fix it"<BR>
Bruce says, "we dont know -- we'venever rendered dice.gml before!"<BR>
emk [Guest]  likes Gabor's code.<BR>
igor rendered dice.gml just now.<BR>
Bruce says, "that's a tier 3 image, and we doont really do that!"<BR>
igor says, "It took 5-10 minues."<BR>
gabor_[Guest] [to Bruce]: still have some micro-optimisations :-=<BR>
emk [Guest] says, ""Gabor, I could give you a quick-and-dirty constant folder..."<BR>
igor notes that the interpreter is not the slow part here...<BR>
Bruce says, "we have a constant folder"<BR>
emk [Guest]  knows<BR>
gabor_[Guest] says, "Hey that is already inside!"<BR>
Bruce says, "well I'm rendering dice, and it's sitting happy on 3468 KB of RAM used after three minutes"<BR>
Bruce says, "finished!"<BR>
Bruce says, "about 3:05"<BR>
Bruce says, "177.6 seconds User time, 0.10 sustem"<BR>
emk [Guest]  finds Math-Primitives.dylan, smacks self on head.<BR>
gabor_[Guest] says, "anything fancy I could kill my time with?"<BR>
emk [Guest] says, "Good luck, folks! You've done a great job, and I'd only screw things up."<BR>
igor grins.<BR>
gabor_[Guest] says, "difference is implemented very effectively ;-)"<BR>
emk [Guest] glances nervously at the clock.<BR>
gabor_[Guest] says, "how do we send the packet to icfp?"<BR>
igor says, "It's in the 'submission info' page..."<BR>
Bruce says, "I think w should use the "give them a URL method"<BR>
igor nods.<BR>
igor says, "I can host it on my machine..."<BR>
Bruce says, ".. unless someone's got the email tool they mention"<BR>
Bruce says, "OK, project status...."<BR>
Bruce says, "If we had cone and cylinder we'd be fully Trie 2"<BR>
igor nods.<BR>
Bruce says, "er, tier"<BR>
Bruce says, "so that's the thing we've got to try and pushj for in the next hour"<BR>
igor says, "OK..."<BR>
Bruce says, "thanks for checking in your code Igor"<BR>
igor nods.<BR>
igor says, "It's a bit of a mess, ATM..."<BR>
gabor_[Guest] [to bruce,]: can you run the modi test with negative values too? Four Quadrants!<BR>
Bruce says, "sure"<BR>
Bruce says, "um, there's the smallmatter of a division by zero"<BR>
Bruce says, "of course"<BR>
gabor_[Guest] says, "exclude zero denominators"<BR>
igor sucks the Graphics Gems V source code from acm.org<BR>
Bruce says, "it always fails for x and y of different signs"<BR>
Bruce says, "no, that's not quite right"<BR>
gabor_[Guest] says, "this is what I suspected!"<BR>
gabor_[Guest] says, "looking into math primitives"<BR>
gabor_[Guest] says, "I am using truncate/"<BR>
emk [Guest] glances nervously at the clock.<BR>
Bruce says, "ok, whenever it doens'tr divide exactly it fails"<BR>
gabor_[Guest] says, "5 -2 modi?"<BR>
Bruce says, "-1"<BR>
gabor_[Guest] says, "5 -2 divi"<BR>
Bruce says, "-2"<BR>
Bruce says, "you shoudl be using floor for divi ..."<BR>
Bruce says, "... or else calculate modi as a - (a/b)*b"<BR>
gabor_[Guest] says, "floor is not dividing"<BR>
Bruce says, "floor/"<BR>
gabor_[Guest] says, "divi is doing this!"<BR>
Bruce says, "is divi truncate/ or floor/?"<BR>
gabor_[Guest] says, "maybe it is a pentium bug ;-)"<BR>
gabor_[Guest] says, "sorry, truncate"<BR>
Bruce says, "divi is *supposed* to be towards zero i.e. truncate/"<BR>
gabor_[Guest] says, "that is why I picked it!"<BR>
Bruce says, ".. so do modi as  a - truncate/(a,b)*b"<BR>
igor wonders what he should do about cylinders & cones...  Should he put cubes in their place, or simply don't draw them...<BR>
gabor_[Guest] says, "but modulo is associated with floor/"<BR>
Bruce says, ".. not in *these* specs"<BR>
gabor_[Guest] says, "there is a note that we should return errors for unimplemented primitives"<BR>
Bruce says, "we've got to make it so that the relationship holds, and that's how you do it"<BR>
igor wonders what's wrong with '%' for doing mods...<BR>
gabor_[Guest] says, "you surely got your relationship right?"<BR>
gabor_[Guest] says, "undefined behaviour"<BR>
gabor_[Guest] says, "not portable dylan"<BR>
Bruce says, "yes -- P6"<BR>
gabor_[Guest] [to igor]: read the spec on unimplemented features!<BR>
igor ahs.<BR>
gabor_[Guest] [to Bruce]: try floor/ for divi locally on your machine!<BR>
gabor_[Guest] [to igor]: did you find the page?, I dont remember!<BR>
gabor_[Guest] says, "Which primitives should return an unimplemented error?"<BR>
gabor_[Guest] says, "intersection? difference? cone? cylinder?"<BR>
igor nods.<BR>
gabor_[Guest] says, "we have to put out feature set into the README"<BR>
Bruce says, "floor/ is *wrong* for divi!"<BR>
igor is doing so.<BR>
Bruce says, "I've fixed the modi to match the divi and the relationship thjey ask for"<BR>
igor notes that we haven't tested textures on anything but cubes yet...<BR>
gabor_[Guest] says, "then we have to special case the non ++ calculations to use other than modulo"<BR>
Bruce says, "the non what?"<BR>
igor tries for a checkerboard sphere...<BR>
gabor_[Guest] [to igor]: leave avay the body of the graphprim to get the nonimpl error<BR>
igor nods at Gabor.  Is that actually what we're supposed to do, though?<BR>
gabor_[Guest] says, "looking docs"<BR>
Bruce says, "gabor, you can check out the new math-prims"<BR>
gabor_[Guest] says, "it is in the readme?"<BR>
jon.dyte [Guest] says, "good luck dudes, gotta shoot""<BR>
You hear a quiet popping sound; Horst_Guest has disconnected.<BR>
gabor_[Guest] says, "it is in the faq."<BR>
gabor_[Guest] says, "It would be nice if a tier 1 program seeing a tier2/3 operator would throw an error"<BR>
gabor_[Guest] says, "we are tier 1 right?"<BR>
igor says, "Tier 1 + cubes + spotlights"<BR>
igor says, "+ pointlights, too."<BR>
Bruce says, "yes, only tier 1 :-("<BR>
gabor_[Guest] says, "so put this into the readme"<BR>
-----------------------------------igor------------------------------------<BR>
Our submission implements a Tier 1 system, with the additional<BR>
features of cubes, pointlights, and spotlights.<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "Hey Igor!  Your cylinders aren't too bad!"<BR>
igor says, "Oh?  How far off am I?"<BR>
Bruce says, "the golf scene has a pretty good flag"<BR>
Bruce says, "well I don't know about the math, but it looks OK"<BR>
gabor_[Guest] says, "put them in?"<BR>
igor has not, personally, seen the ray-tracer draw a cylinder, tho...<BR>
gabor_[Guest] glances nervously at the clock.<BR>
gabor_[Guest] [to Bruce]: the modi test works for all quadrants?<BR>
Bruce says, "the stick of the flag matches well -- right down to the red&white pattern"<BR>
Bruce says, "gabor: yes"<BR>
gabor_[Guest] says, "good"<BR>
gabor_[Guest] says, "the modi in task.pdf or DRM is fucked up. GRRRR"<BR>
igor [to Bruce]: Cool, I guess...<BR>
emk [Guest] glances nervously at the clock.<BR>
gabor_[Guest] says, "I disable difference and intersection"<BR>
-----------------------------------igor------------------------------------<BR>
:  We'll follow a couple of other languages and require that "n1 n2 modi" results in a value n3 such that n3 is the remainder of the division of n1 by n2 and has the same sign as n1 n2.  (Note:  I had a bug here<BR>
previously and wrote n2 instead of n1.)  So, the following should hold (for n2<>0):<BR>
<BR>
 <BR>
<BR>
  (n1 / n2) * n2 + (n1 mod n2) = n1<BR>
---------------------------------finished----------------------------------<BR>
emk [Guest]  wishes everybody luck.<BR>
igor [to gabor_[Guest]]: Actually, it says that there's no need for them to raise an error...<BR>
gabor_[Guest] says, "the graphics prims?"<BR>
igor nods.<BR>
igor says, "Why don't we just leave them being silently ignored..."<BR>
-----------------------------------igor------------------------------------<BR>
Q:  What should we do in a Tier-1 implementation if we see a Tier-2/3 operator?  Signal an error?<BR>
<BR>
 <BR>
<BR>
A:  That would be nice, but we?re not going to test this.<BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "ok at least the rest gets drawn"<BR>
igor nods.<BR>
gabor_[Guest] says, "do we get a crash on cone?"<BR>
igor dunnos.<BR>
gabor_[Guest] says, "try it"<BR>
gabor_[Guest] says, "if not, leave them in"<BR>
gabor_[Guest] says, "else I disable cone"<BR>
Bruce says, "I think we're in really, really good shape as a tier-1 app."<BR>
andreas has connected.<BR>
andreas says, "Hi folks."<BR>
andreas glances nervously at the clock.<BR>
igor hey-heys to andreas<BR>
igor glances nervously at the clock.<BR>
andreas says, "What's the state?"<BR>
gabor_[Guest] [to igor]: cone crashes?<BR>
igor [to gabor_[Guest]]: Just tweaking it so it doesn't...<BR>
gabor_[Guest] says, "OK we leave everything in. Intersection and difference wont work right, but from the right perspective they might look good :-)"<BR>
Bruce says, "Anyone who has implement more than us has probably used a slower language"<BR>
Bruce hopes :-)<BR>
Bruce says, "Status: fully Tier-1"<BR>
Bruce says, "tier-2 except clylindes and cones"<BR>
Bruce says, "cylinders are close, but no cigar"<BR>
Bruce says, "if we just had another day..."<BR>
igor says, "Plus bonus spotlights :-)"<BR>
andreas says, "Aren't cigars ellipsoids? :)"<BR>
andreas says, "What's the problem with the cylinders?"<BR>
gabor_[Guest] says, "just hack all the icfp servers to headcrash..."<BR>
igor <- really good at lighting, apparently, but not so good at intersections and planning ahead...<BR>
igor [to andreas]: They don't work.<BR>
igor says, "real-intersection-before(m :: <cylinder>...  doesn't give us the right stuff."<BR>
igor says, "Cones have their base rendered, but that's it."<BR>
igor says, "Most of the logic for the cylinder is there,  it's just buggy."<BR>
Bruce pings<BR>
igor says, "Hey, the top & bottom work great, though..."<BR>
gabor_[Guest] says, "who is the burnmaster?"<BR>
andreas says, "Hm... I'll take a look..."<BR>
igor glances nervously at the clock.<BR>
Bruce says, "I'm going to propose a code freeze about now..."<BR>
gabor_[Guest] says, "cone does not crash?"<BR>
igor says, "With possible exception of cylinders, if andreas can figure 'em out..."<BR>
Bruce says, "the risk of us breaking something in a rush is too high"<BR>
gabor_[Guest] says, "this is not C++ ;-)"<BR>
igor says, "Well, the worst Andreas can do is cause cylinders to crash, really..."<BR>
Bruce says, "OK, the only exception is Andreas on the Cylinders..."<BR>
igor [to gabor_[Guest]]: Hmm...  Now that you mention it, I have not as yet experienced a case where I change something somewhere, then something else way off in some other part breaks.<BR>
Bruce wishes him rots of ruck<BR>
gabor_[Guest] says, "all checked in for me, I am ready."<BR>
andreas notes that all the constants are single float...<BR>
igor [to Bruce]: Care to run a few final test runs to make sure it all still works?<BR>
igor's favourite spotlight demo still works :-)<BR>
gabor_[Guest] says, "if they are integral < 24meg then that should not be a problem"<BR>
Bruce says, "yes, I can run tests again..."<BR>
Bruce says, "anyone want to write some more words in the README?"<BR>
gabor_[Guest] says, "Andreas how hard to change them all to double constants?"<BR>
igor is doing that.<BR>
igor imagines the conversion ought to be pre-compiled by d2c...<BR>
andreas says, "0.0 is single float, 0.0d0 is double float. Pretty easy."<BR>
Bruce says, "don't touch the float constants!"<BR>
gabor_[Guest] says, "Please say that the (RIP) Apple Dylan TR helped us a lot"<BR>
Bruce says, "they'll be fine"<BR>
Bruce says, "I mentioned it"<BR>
gabor_[Guest] says, "I do not think it is arisk, but can gain speed and precision"<BR>
gabor_[Guest] glances nervously at the clock.<BR>
gabor_[Guest] says, "who writes the email?"<BR>
andreas points at Bruce.<BR>
igor [to gabor_[Guest]]: Care to insert a few words about the GML engine?<BR>
igor says, "Who should make the Master Build."<BR>
igor isn't real confident in his d2c version, so suggests that someone else do so.<BR>
igor says, "I've also got a Redhat 7.0-alpha system going here..."<BR>
igor glances nervously at the clock.<BR>
andreas has a PowerPC....<BR>
igor elects Bruce.<BR>
andreas says, "I give up on the cylinder. The code looks ok on the first glance (except for things like (ray.ray-direction.x ~= 0.0), comparing for equality is always a risk with fp)."<BR>
-------------------------------gabor_[Guest]-------------------------------<BR>
The GML language is compiled to continuation passing style after the obvious arithmetic<BR>
and primitive related simplifications.<BR>
---------------------------------finished----------------------------------<BR>
emk [Guest] glances nervously at the clock.<BR>
emk [Guest] holds his breath.<BR>
igor nods to andreas.<BR>
igor says, "OK, call it done."<BR>
gabor_[Guest] says, "build the beast"<BR>
igor pokes Bruce into action.<BR>
gabor_[Guest] says, "do not forget the md5 from the email"<BR>
igor says, "Bruce (#186)           11 hours     7 minutes    The Gentleman Loser "<BR>
igor hmms.<BR>
Bruce says, "I nominate igor to build it, since he'll host it"<BR>
Bruce says, "I'll write the email"<BR>
igor [to Bruce]: My libc/etc. is funky.  You build it, and give it to Andreas to host.<BR>
Bruce says, "OK, then someone write the email"<BR>
igor will write the email then.<BR>
gabor_[Guest] glances nervously at the clock.<BR>
gabor_[Guest] says, "we have to put the tar.gz into the mail"<BR>
igor [to andreas]: do you want to host it, or should I?<BR>
andreas says, "I will gladly host it."<BR>
igor [to andreas]: URL, please...<BR>
gabor_[Guest] says, "any support files we have to deal with?"<BR>
andreas says, "ftp://berlin.ccc.de/pub/gd/incoming"<BR>
igor glances nervously at the clock.<BR>
igor says, "7 minutes left here..."<BR>
igor [to Bruce]: md5sum, please.<BR>
gabor_[Guest] says, "the mail should be there before the big ben beats"<BR>
gabor_[Guest] says, "md5 of the tar.gz!"<BR>
igor [to Bruce]: It is more important that we get the md5sum than it is that we get the tar.gz in place...<BR>
gabor_[Guest] says, "sorry of the .tar too!"<BR>
gabor_[Guest] says, "we need the md5 of the .tar"<BR>
gabor_[Guest] glances nervously at the clock.<BR>
emk [Guest] glances nervously at the clock.<BR>
igor pokepokepokes Bruce.<BR>
gabor_[Guest] says, "mailto:icfp-sub@cs.cornell.edu"<BR>
gabor_[Guest] glances nervously at the clock.<BR>
You hear a quiet popping sound; Bruce has disconnected.<BR>
igor says, "Hmm... That's no good..."<BR>
Bruce has connected.<BR>
igor [to Bruce]: md5sum, please...<BR>
Bruce says, "e1b6e560d263ae2d8784bdd872c063a6  dylan-hackers.tar.gz"<BR>
Bruce says, "jeezez that was hard!"<BR>
gabor_[Guest] says, "md5 of .tar?"<BR>
Bruce says, "I entered it 50 times and it didn't go"<BR>
Bruce says, "had to disconnect and reconnect"<BR>
andreas says, "One minute left."<BR>
gabor_[Guest] says, "then we have to write this into the mail"<BR>
igor sends the mail.<BR>
igor waits patiently...<BR>
andreas [to Bruce]: Upload please.<BR>
emk [Guest] glances nervously at the clock.<BR>
igor glances nervously at the clock.<BR>
gabor_[Guest] says, "do we get a confirm?"<BR>
igor says, "Would be nice."<BR>
igor glances nervously at the clock.<BR>
igor glances nervously at the clock.<BR>
andreas says, "URL will be <A HREF="http://www.gwydiondylan.org/dylan-hackers.tar.gz" TARGET="_blank">http://www.gwydiondylan.org/dylan-hackers.tar.gz</A>"<BR>
igor says, "Oops..."<BR>
andreas says, "Ok, game is over."<BR>
igor submitted the wrong URL, then...<BR>
gabor_[Guest] glances nervously at the clock.<BR>
andreas says, "What did you submit?"<BR>
gabor_[Guest] says, "countdown#"<BR>
igor says, "ftp://incoming..."<BR>
andreas says, "Ok, I make that readable."<BR>
emk [Guest] breathes<BR>
emk [Guest] says, "Congratulations, and great work!"<BR>
igor says, "Still nothing from them..."<BR>
igor hi-5s us all.<BR>
gabor_[Guest] says, "send again"<BR>
-----------------------------------igor------------------------------------<BR>
Date: Tue, 29 Aug 2000 17:00:57 -0400 (EDT)<BR>
To: igor@secret-lab.dartmouth.edu<BR>
Subject: ICFP2000 Submission Acknowledgement (Failure)<BR>
   <BR>
   <BR>
Your submission failed (Checksums don't match)<BR>
   <BR>
team:            Dylan Hackers<BR>
contact-email:   bruce@hoult.org<BR>
address1:        65 Oxford St,<BR>
address2:        Tawa, Wellington 6006, New Zealand<BR>
phone:           (603) 643-9823<BR>
url:             ftp://berlin.ccc.de/pub/gd/incoming/dylan-hackers.tar.gz<BR>
found-md5sum:    3a065a21c20e5f4e10327bed1d2931f7<BR>
expected-md5sum: e1b6e560d263ae2d8784bdd872c063a6<BR>
local-time:      Tue Aug 29 17:00:52 2000<BR>
GMT-time:        Tue Aug 29 21:00:52 2000<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "top, excellent work everyone!"<BR>
Bruce says, "we did good!"<BR>
igor [to andreas]: Please verify the md5sum.<BR>
igor [to Bruce]: Did you upload in binary mode?<BR>
Bruce says, "um .. it's not fully uploaded yet!"<BR>
igor says, "Ah..."<BR>
igor says, "That'd do it..."<BR>
Bruce says, "400 KN out of 600 KN"<BR>
Bruce says, "er, KB"<BR>
igor will send them mail when it is uploaded...<BR>
Bruce says, "470"<BR>
Bruce says, "540"<BR>
emk [Guest] crosses fingers<BR>
Bruce says, "it's up"<BR>
andreas says, "MD5 matches on the server!"<BR>
emk [Guest] cheers<BR>
igor says, "Excellent."<BR>
emk [Guest] bows<BR>
emk [Guest] says, "You guys are absolutely amazing!"<BR>
gabor_[Guest] says, "wait for the confirm :-|"<BR>
Bruce says, "our email was 52 seconds late getting there :-("<BR>
andreas drops bottle of champaign.<BR>
gabor_[Guest] says, "we lost?"<BR>
-----------------------------------igor------------------------------------<BR>
To: "'Jeff Dubrule'" <igor@secret-lab.dartmouth.edu><BR>
Subject: RE: ICFP2000 Submission Acknowledgement (Failure)<BR>
Date: Tue, 29 Aug 2000 17:04:15 -0400<BR>
   <BR>
Just do another submission.<BR>
   <BR>
        - Stephanie<BR>
   <BR>
---------------------------------finished----------------------------------<BR>
-----------------------------------igor------------------------------------<BR>
Date: Tue, 29 Aug 2000 17:06:21 -0400 (EDT)<BR>
To: igor@secret-lab.dartmouth.edu<BR>
Subject: ICFP2000 Submission Acknowledgement (Success)<BR>
   <BR>
   <BR>
Your submission was accepted as submission 105<BR>
   <BR>
team:          Dylan Hackers<BR>
contact-email: bruce@hoult.org<BR>
address1:      65 Oxford St,<BR>
address2:      Tawa, Wellington 6006, New Zealand<BR>
phone:         (603) 643-9823<BR>
url:           ftp://berlin.ccc.de/pub/gd/incoming/dylan-hackers.tar.gz<BR>
md5sum:        e1b6e560d263ae2d8784bdd872c063a6<BR>
local-time:    Tue Aug 29 17:06:20 2000<BR>
GMT-time:      Tue Aug 29 21:06:20 2000<BR>
---------------------------------finished----------------------------------<BR>
andreas says, "Yes!"<BR>
igor says, "WHee."<BR>
gabor_[Guest] COOOOL<BR>
igor says, "Wow... #105?"<BR>
andreas pops open the champaign bottle.<BR>
Bruce says, "105!!!!"<BR>
igor says, "Lotsa people entered..."<BR>
igor says, "(or they started at 100...)"<BR>
igor says, "It may also count duplicate entries."<BR>
andreas says, "Do we get to see the other people's submissions?"<BR>
gabor_[Guest] says, "hopefully"<BR>
Bruce says, "they *promised* to have a test machine available .. didn't see any sign of it"<BR>
-----------------------------------igor------------------------------------<BR>
Breaking News <BR>
<BR>
The Contest is now Over!!! <BR>
<BR>
 <BR>
<BR>
Over the next week or two, we will be evaluating the contest entries.  We will inform the winners of the contest as soon as possible, and will announce the winners at the ICFP conference.  Thanks for participating<BR>
and good luck to all!<BR>
<BR>
 .<BR>
---------------------------------finished----------------------------------<BR>
Bruce says, "I hope like hell that thing reall *is* statically linked..."<BR>
igor grins.<BR>
emk [Guest] says, "Good job."<BR>
igor hi-5s everyone.<BR>
gabor_[Guest] says, "dito"<BR>
igor says, "If nothing else, we have the second major application written using d2c that I know of..."<BR>
andreas says, "I am amazed at the speed at which one can write such a complex application."<BR>
Bruce says, "2494 lines of Dylan"<BR>
igor calculates the stats...<BR>
gabor_[Guest] says, "I only contributed ca 330 lines"<BR>
andreas thinks that less lines are often better.<BR>
Bruce says, "I didn't have time to make mine shorter"<BR>
igor says, "igor: 1030 lines, bruce: 1048 lines, andreas: 119 lines, gabor: 377, emk: 5"<BR>
igor says, "And that leaves 3 mystery lines leftover..."<BR>
gabor_[Guest] says, "I bet we are in the top 5 A 6pack of champaign"<BR>
gabor_[Guest] says, "the holy ghost"<BR>
andreas says, "Yes, I guess we are very good."<BR>
igor says, "Nope, I lied (or hit a bad key on my calculator..."<BR>
andreas says, "How many other compilers which produce code as good as ours are out there?"<BR>
gabor_[Guest] says, "we are faster then the Haskell/M$ guys..."<BR>
igor says, "cvs annotate | grep -v igor | grep -v bruce | grep -v andreas | grep -e gabor | grep -e emk | wc => 0 0 0"<BR>
andreas says, "There are a couple of Lisp compilers which do pretty well."<BR>
igor says, "Barring someone bolting a transator onto the front of POVray, or a solo run by a C++ god..."<BR>
gabor_[Guest] says, "The ML compilers are pretty good as they generate machine code"<BR>
andreas says, "It's possible in C++ if you happen to have a good 3D graphics library around."<BR>
igor says, "So, who wants to fix the #keys, #all-keys bug now?"<BR>
gabor_[Guest] says, "Even C++ bergods cannot do this in 72 hours"<BR>
igor puts his finger against his nose...<BR>
andreas says, "lex and yacc are there, you can use the boehm gc..."<BR>
gabor_[Guest] says, "what exactly is the bug?"<BR>
andreas says, "STL for hash tables..."<BR>
igor says, "It's a syntax problem."<BR>
andreas says, "I would bet it's doable."<BR>
andreas says, "You need to bei either a language or computer graphics guru."<BR>
gabor_[Guest] says, "And you have to type as hell"<BR>
-----------------------------------igor------------------------------------<BR>
efine method initialize(ppm :: <ppm-image>, #key, #all-keys)  works, but<BR>
<BR>
define method initialize(ppm :: <ppm-image>, #key #all-keys) fails:<BR>
 <BR>
---------------------------------finished----------------------------------<BR>
gabor_[Guest] says, "Someone changes the header and all others begin recompile"<BR>
igor says, "In contrast to what's in Dylan Programming."<BR>
igor hasn't checked the DRM yet...<BR>
gabor_[Guest] says, "What does DRM say?"<BR>
gabor_[Guest] says, "Needs a , between #key and #all-keys. not a bug"<BR>
igor says, "Yep, you're right..."<BR>
igor says, "'tis a bug in the book, then..."<BR>
gabor_[Guest] says, "Most people in last rounds flew out because the parser violated the semantics"<BR>
igor says, "Anyhow, I'm quite sick of staring at my computer, and am going to go eat or something..."<BR>
andreas says, "How good is our language part? Didn't have much time to look at it yet."<BR>
igor [to andreas]: It kicks booty<BR>
Bruce says, "the language part is *superb*"<BR>
emk [Guest] says, "Gabor is the man."<BR>
Bruce says, "the parser/interpreter kicks ass"<BR>
emk [Guest] says, "He wrote a continuation-passing compiler (with optimizer)..."<BR>
gabor_[Guest] says, "igor, can you ask sweet Stephanie how many teams participated?"<BR>
emk [Guest] says, "...and used closures instead of byte code."<BR>
Bruce says, "the lexer is a bit crufty but will do the job"<BR>
andreas says, "You're kidding. That's awesome!"<BR>
emk [Guest] says, ""It's an absolutely classic design, beautifully done."<BR>
gabor_[Guest] says, "calling girlfriend..."<BR>
Bruce says, "as far as I can tell, we match every spec for the language, down to the last dot."<BR>
andreas says, "I like the specification of GML. Only a few, but well-chosen rules."<BR>
Bruce says, "it runs at around 3 uS per operation, on my computer"<BR>
emk [Guest] tries to find message in gd-hackers archive, but it hasn't updated recently.<BR>
Bruce says, "300,000 instructions per second"<BR>
emk [Guest] whistles<BR>
Bruce says, ".. which is about the speed of a Mac Plus"<BR>
andreas [to emk [Guest]]: Yes, I guess that's my fault. The archive database was corrupted, and I need to rebuild it.<BR>
Bruce says, ".. except that this does it with fully-lexical scoping and 1st class closures and so forth"<BR>
gabor_[Guest] says, "Hey your timing was before I made the simplifier and the partial evaluator"<BR>
gabor_[Guest] says, "run your test again, it should be twice as fast"<BR>
Bruce says, "no that was from the divi/modi test program"<BR>
gabor_[Guest] says, "hey 300000 divisions is 1000000 additions!"<BR>
Bruce says, ".. oh, and plus anbother ten or so for loop control. Call it 30 all up.  At 50 uS per iteration"<BR>
Bruce says, "OK, maybe 1.6 uS per instruction"<BR>
gabor_[Guest] says, "Igor still there?"<BR>
gabor_[Guest] says, "GML was fantastic"<BR>
Bruce says, "oh the spheres2.gml test, it does a 320x240 image in 14.53 seconds"<BR>
andreas says, "We rock."<BR>
Bruce says, "or 5285 pixels/second"<BR>
gabor_[Guest] says, "I conceived still more compile-time optimizations, but I feared to break something"<BR>
Bruce says, ".. or 190 uS per pixel"<BR>
gabor_[Guest] says, "For example the empty array optimization is in my Apple Dylan IDE and works well. I will bring in that code in the CVS"<BR>
andreas [to gabor_[Guest]]: you did that with apple dylan?<BR>
igor returns.<BR>
gabor_[Guest] says, "In case someone wants to run the pattern-match-toy-code from the pdf with some serious problem"<BR>
Bruce says, "on the checked cube, it does 9667 pixels/second, or 103 uS/pixel"<BR>
gabor_[Guest] says, "I used the TR for all compiler and optimizer development, minus the macros."<BR>
gabor_[Guest] says, "The macros simply expand to what i have implemented in the TR just for seeing how a GF works."<BR>
Bruce says, "on the more complex "fib.gml" it drops back to 1340 pixels/sec or 746 uS/pixel"<BR>
gabor_[Guest] says, "It runs really smoothly on my G3 PowerBook :-)"<BR>
gabor_[Guest] says, "WE KICK ASS!!!"<BR>
Bruce says, "Anyone want to lay bets that we are by far the fastest entry to survive the initial correctness rounds?"<BR>
gabor_[Guest] says, "I am convinced of that"<BR>
andreas says, "I think 80% chance that we are the fastest."<BR>
andreas says, "The rest is for the Lisp and ML folks out there."<BR>
Bruce says, "so the question is: are we *enough* faster to make up for anyone who managed to implement tier 3"<BR>
andreas says, "The problem with tier 3 is that you have to decide early to support it."<BR>
andreas says, "One would write the intersection code differently with CSG in mind."<BR>
Bruce says, "with one more day, or one more peson, we could have done it"<BR>
andreas says, "Or if the contest would have taken place *after* the trade exhibition my company is attending in two weeks :("<BR>
gabor_[Guest] says, "Will you turn down headhunters? :-)"<BR>
andreas [to gabor_[Guest]]: Not if they bring interesting people to this company ;)<BR>
gabor_[Guest] [to andreas]: What company you wrk for?<BR>
andreas says, "convergence integrated media."<BR>
andreas says, "We do stuff with video under linux."<BR>
gabor_[Guest] says, "sounds lik UMTS"<BR>
andreas says, "oh yes, we might get to play with that too..."<BR>
gabor_[Guest] says, "beng slepy I mis the keys"<BR>
andreas says, "We have some GPLed stuff at <A HREF="http://linuxtv.org" TARGET="_blank">http://linuxtv.org</A>"<BR>
gabor_[Guest] says, "There are two other bright persons in germany I know of that would love to join us (if asked)"<BR>
gabor_[Guest] says, "Michael Schuerig"<BR>
gabor_[Guest] says, "Stephan Schmiedl"<BR>
gabor_[Guest] says, "both of mac fame"<BR>
gabor_[Guest] says, "the latter was in the same college and uni as me, he told me about dylan"<BR>
gabor_[Guest] says, "I shall go now. Bye chaps."<BR>
gabor_[Guest] says, "Had a hard day"<BR>
Bruce says, "ye Gabor, and thanks!"<BR>
Bruce says, "Bye Gabor, and thanks!"<BR>
gabor_[Guest] says, "Good night!"<BR>
Bruce says, "9:50 am here..."<BR>
Bruce says, "... and I'vebeen up all night"<BR>
Bruce says, "and I can't type"<BR>
You hear a quiet popping sound; Karl-Heinz_Guest has disconnected.<BR>
andreas still can't believe how cool our implementation is.<BR>
<BR>
-- End log: Tuesday, August 29, 2000 9:56:42 pm Gentleman Loser time --<BR>
<BR>
</FONT>
</BODY>
</HTML>
