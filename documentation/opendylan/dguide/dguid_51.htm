<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="dguide_1.htm">
<LINK REL=UP HREF="dguid_47.htm">
<LINK REL=PREV HREF="dguid_50.htm">
<LINK REL=NEXT HREF="dguid_52.htm">
<TITLE>5.3.3.4   Refreshing the list of tasks</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING51></A>

<DIV>
<P><A HREF="dguid_52.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="dguid_50.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="dguid_47.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="dguide_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="dguide_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="dgui_110.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>5.3.3   Updating the user interface</P>

</DIV>
<A NAME=HEADING51-0></A>
<H1>5.3.3.4   <A NAME=MARKER-9-298></A>Refreshing the list of tasks</H1>
<P><A NAME=MARKER-9-299></A>The <CODE>refresh-task-frame</CODE> method is called whenever the list of tasks needs to be refreshed for whatever reason. This happens most commonly after adding or removing a task from the list, or loading in a new task list from a file on disk. The method <CODE>refresh-task-frame</CODE> takes an instance of <CODE>&lt;task-frame&gt;</CODE> as an argument and returns no values. For the Task List 1 project the definition is:</P>
<PRE>
define method refresh-task-frame
    (frame :: &lt;task-frame&gt;) =&gt; ()
  let list-box = frame.task-list;
  let task-list = frame.frame-task-list;
  let modified? = task-list.task-list-modified?;
  let tasks = task-list.task-list-tasks;
  if (gadget-items(list-box) == tasks)
    update-gadget(list-box)
  else
    gadget-items(list-box) := tasks
  end;
  gadget-enabled?(frame.save-button) := modified?;
  gadget-enabled?(frame.save-menu-button) := modified?;
  note-task-selection-change(frame);
end method refresh-task-frame;
<P></P>
</PRE>
<P>However, the Task List 2 project requires a call to <CODE>command-enabled?</CODE>, so the definition is:</P>
<PRE>
define method refresh-task-frame
    (frame :: &lt;task-frame&gt;) =&gt; ()
  let list-box = frame.task-list;
  let task-list = frame.frame-task-list;
  let modified? = task-list.task-list-modified?;
  let tasks = task-list.task-list-tasks;
  if (gadget-items(list-box) == tasks)
    update-gadget(list-box)
  else
    gadget-items(list-box) := tasks
  end;
  command-enabled?(save-file, frame) := modified?;
  note-task-selection-change(frame);
end method refresh-task-frame;
<P></P>
</PRE>
<P>To begin, <CODE>refresh-task-frame</CODE> sets a number of local variables:</P>
<DL>
<DT><CODE>list-box</CODE><DD><P> The list box used to display the list of tasks in task list manager.</P>
<DT><CODE>task-list</CODE><DD><P> The task list currently loaded in the task list manager. </P>
<DT><CODE>modified?</CODE><DD><P> The value of the <CODE>task-list-modified?</CODE> slot of <CODE>task-list</CODE>.</P>
<DT><CODE>tasks</CODE><DD><P> The sequence of tasks stored in <CODE>task-list</CODE>.</P>
</DL>
<P>Next, the following code is executed:</P>
<PRE>
if (gadget-items(list-box) == tasks)
  update-gadget(list-box)
else
  gadget-items(list-box) := tasks
end;
<P></P>
</PRE>
<P>This code ensures that if the items in the list box are the same as the sequence of tasks in the task list, then the display in the list box is updated to ensure all the items are displayed correctly. If the items in the list box are not the same as the sequence of tasks, then the items in the list box are updated to reflect the current task list. The items in the list box could be different if a task had been added or removed from the list, or if a completely new set of tasks had been loaded into the task list manager.</P>
<P>Lastly, the following three lines</P>
<PRE>
gadget-enabled?(frame.save-button) := modified?;
gadget-enabled?(frame.save-menu-button) := modified?;
note-task-selection-change(frame);
<P></P>
</PRE>
<P>ensure that the <B>Save</B> button and <B>File &gt; Save</B> menu command are enabled if the task list has been modified, and then any changes that need to be made to the GUI as a result of changing the selected item are performed, by calling <CODE>note-task-selection-change</CODE>.</P>
<P>Add the code for this method to <CODE>frame.dylan</CODE>.</P>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>Building Applications Using DUIM - 26 May 1999</ADDRESS>
<P><A HREF="dguid_52.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="dguid_50.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="dguid_47.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="dguide_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="dguide_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="dgui_110.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
