<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="dguide_1.htm">
<LINK REL=UP HREF="dguid_19.htm">
<LINK REL=PREV HREF="dguid_25.htm">
<LINK REL=NEXT HREF="dguid_27.htm">
<TITLE>3.7   Gluing the new design together</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING26></A>

<DIV>
<P><A HREF="dguid_27.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="dguid_25.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="dguid_19.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="dguide_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="dguide_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="dgui_110.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>3 Improving The Design</P>

</DIV>
<A NAME=HEADING26-0></A>
<A NAME=UID-improve-889583></A>
<H1>3.7   <A NAME=MARKER-2-170></A><A NAME=MARKER-9-171></A>Gluing the new design together</H1>
<P>In improving the initial design of the application, you have added a tool bar and a status bar. Adding a tool bar, in particular, has obviated the need for some of the elements that you added to the earlier version of the frame design. In this section, you throw away those elements that are no longer needed, and add in the new elements, to create a new, improved design for the frame class.</P>
<P>One part of the initial design you have not yet improved on is the radio box that shows the priority of any task in the list. Ideally, rather than using a radio box, you would display the priority of each task alongside the task itself, within the list box. For now, however, keep the radio box. </P>
<PRE>
pane priority-box (frame)
  make (&lt;radio-box&gt;,
        items: $priority-items,
        orientation: #&quot;horizontal&quot;,
        label-key: first,
        value-key: second,
        value: #&quot;medium&quot;,
        activate-callback: not-yet-implemented);
<P></P>
</PRE>
<P>Notice that the orientation is no longer constrained to be vertical. In the new design, a horizontal radio box looks better. By default, the orientation of a radio box is horizontal, so you could just completely remove the initialization of the <CODE>orientation:</CODE> init-keyword from the definition of the pane. In general, though, if you care about the orientation of a gadget, you should specify it explicitly, so leave the init-keyword in the pane definition, and change its value, as shown above.</P>
<P>Next, notice that the items are now specified using a named constant, rather than by embedding literals in the pane definition. The definition of this constant is as follows:</P>
<PRE>
define constant $priority-items
  = #(#(&quot;Low&quot;,    #&quot;low&quot;),
      #(&quot;Medium&quot;, #&quot;medium&quot;),
      #(&quot;High&quot;,   #&quot;high&quot;));
<P></P>
</PRE>
<P><A NAME=MARKER-10-172></A>Add the definition for this constant to <CODE>frame.dylan</CODE>.</P>
<P>Using lists of string and symbol values in this constant lets you assign values to the individual components of the radio box elegantly, in conjunction with the other improvements to the definition of <CODE>priority-box</CODE>. </P>
<UL>
<LI>The <I>label key</I> is a function which is passed an entry from the sequence and returns a string to use as the label. 
</UL>
<DL>
<DT><DD>Assigning <CODE>first</CODE> to the label key of <CODE>priority-box</CODE> ensures that the first element from each sub-list of <CODE>$priority-items</CODE> (the string) is used as the label for the appropriate item. Thus, the first button in priority box is labeled "Low".
</DL>
<UL>
<LI>The <I>value key</I> is a function which is passed an entry and returns the logical value of the entry. 
</UL>
<DL>
<DT><DD>Assigning <CODE>second</CODE> to the value key of <CODE>priority-box</CODE> ensures that the second element from each sub-list of <CODE>$priority-items</CODE> (the symbol) is used as the value for the appropriate item. Thus, the first button in priority box has the value <CODE>#&quot;low&quot;</CODE>. 
</DL>
<P>Lastly, <CODE>priority-box</CODE> is given a default value: <CODE>#&quot;medium&quot;</CODE>. This ensures that the button labeled "Medium" is selected by default whenever <CODE>priority-box</CODE> is first created.</P>
<P>The definitions for <CODE>add-button</CODE>, <CODE>remove-button</CODE>, and <CODE>task-list</CODE> remain unchanged from the initial design. In addition, you need to add the definitions for <CODE>open-button</CODE> and <CODE>save-button</CODE> described in <A HREF="dguid_24.htm#MARKER-9-165">Section 3.5 on page 19</A>.</P>
<P>You also need to add in the definitions for the tool bar and status bar themselves, as described in <A HREF="dguid_24.htm#MARKER-9-165">Section 3.5 on page 19</A> and <A HREF="dguid_25.htm#MARKER-9-169">Section 3.6 on page 21</A>.</P>
<P>The definition for <CODE>task-layout</CODE> has become much simpler. Because you have added buttons to the tool bar, the main layout for the application has reduced to a single column layout whose children are <CODE>task-list</CODE> and <CODE>priority-box</CODE>.</P>
<P>The definition for the new design of the frame class now looks as follows (button definitions vary slightly for the Task List 2 project, see <A HREF="dgui_109.htm#MARKER-9-619">Appendix A.2, "A task list manager using command tables"</A>):</P>
<PRE>
define frame &lt;task-frame&gt; (&lt;simple-frame&gt;)
// definition of buttons
  pane add-button (frame)
    make(&lt;push-button&gt;, label: &quot;Add task&quot;,
         activate-callback: not-yet-implemented);
  pane remove-button (frame)
    make(&lt;push-button&gt;, label: &quot;Remove task&quot;,
         activate-callback: not-yet-implemented);
  pane open-button (frame)
    make(&lt;push-button&gt;, label: &quot;Open file&quot;,
         activate-callback: not-yet-implemented);
  pane save-button (frame)
    make(&lt;push-button&gt;, label: &quot;Save file&quot;,
         activate-callback: not-yet-implemented);
<P></P>
// definition of radio box
  pane priority-box (frame)
    make (&lt;radio-box&gt;,
          items: $priority-items,
          orientation: #&quot;horizontal&quot;,
          label-key: first,
          value-key: second,
          value: #&quot;medium&quot;,
          activate-callback: not-yet-implemented);
<P></P>
// definition of tool bar
  pane task-tool-bar (frame)
    make(&lt;tool-bar&gt;,
         child: horizontally ()
                  frame.open-button;
                  frame.save-button;
                  frame.add-button;
                  frame.remove-button
                end); 
<P></P>
// definition of status bar
  pane task-status-bar (frame)
    make(&lt;status-bar&gt;, label: &quot;Task Manager&quot;);
<P></P>
// definition of list
  pane task-list (frame)
    make (&lt;list-box&gt;, items: #(), lines: 15,
          activate-callback: not-yet-implemented);
<P></P>
// main layout
  pane task-layout (frame)
    vertically ()
      frame.task-list; 
      frame.priority-box;
    end;
<P></P>
// activation of frame elements
  layout (frame) frame.task-layout;
  tool-bar (frame) frame.task-tool-bar;
  status-bar (frame) frame.task-status-bar;
<P></P>
// frame title
  keyword title: = &quot;Task List Manager&quot;;
end frame &lt;task-frame&gt;;
<P></P>
</PRE>
<P>Note that this definition does not incorporate the original <CODE>task-text</CODE> pane defined in <A HREF="dguid_23.htm#MARKER-9-162">Section 3.4, "Defining a new frame class"</A>. In fact, this part of the original interface is handled differently in the final design, and is re-implemented in <A HREF="dguid_27.htm#MARKER-9-175">Section 3.8, "Creating a dialog for adding new items"</A>.</P>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>Building Applications Using DUIM - 26 May 1999</ADDRESS>
<P><A HREF="dguid_27.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="dguid_25.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="dguid_19.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="dguide_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="dguide_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="dgui_110.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
