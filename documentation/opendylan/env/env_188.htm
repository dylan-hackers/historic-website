<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="env_1.htm">
<LINK REL=UP HREF="env_184.htm">
<LINK REL=PREV HREF="env_187.htm">
<LINK REL=NEXT HREF="env_189.htm">
<TITLE>A.2.4   Creating the client</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING188></A>

<DIV>
<P><A HREF="env_189.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="env_187.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="env_184.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="env_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="env_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="env_206.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>A.2   An example COM server and client</P>

</DIV>
<A NAME=HEADING188-0></A>
<H1>A.2.4   Creating the client</H1>
<P>Now we create the actual client application.</P>
<DL>
<DT><DD>1.  Choose <B>File &gt; New...</B> from the main window.
<DT><DD>2.  Select <B>Project</B> and click <B>OK</B>.
<DT><DD>The New Project wizard appears. 
<DT><DD>3.  In the Project Type section, select "Console Application (EXE)" and click <B>Next</B> to continue to the next wizard page.
<DT><DD>4.  Name the project <B>RotNExample-client</B>.
<DT><DD>5.  Choose a suitable Location for the project.
<DT><DD>6.  Make sure the "Include any available templates" option is <I>not</I> chosen.
<DT><DD>7.  Click <B>Next</B>.
<DT><DD>8.  Choose the Simple libraries option, and choose the "Standard IO streams and string formatting" and "OLE Automation" options.
<DT><DD>9.  Proceed to the last page of the wizard and click <B>Finish</B>.
<DT><DD>10.  In the new project, edit <CODE>library.dylan</CODE>, and add to the <CODE>define</CODE> <CODE>library</CODE> declaration the following line:
</DL>
<PRE>
use RotNExample-client-stubs;
<P></P>
</PRE>
<DL>
<DT><DD>11.  Add the same line to the <CODE>define</CODE> <CODE>module</CODE> declaration in <CODE>module.dylan</CODE>.
</DL>
<P>We now add code to make the client encrypt and decrypt a simple string with the default key of 13 and with the key set to 3. </P>
<P><B>Note:</B> The remainder of this section of the example involves adding code to <CODE>RotNExample-client.dylan</CODE>. A version of this file with all the code we add in this section is available in the Functional Developer installation folder, under <CODE>Examples\Documentation\RotNExample\RotNExample-client.dylan</CODE>. You may want to copy that file into place in your project folder rather than typing code in.</P>
<DL>
<DT><DD>12.  Modify the <CODE>main</CODE> method in <CODE>RotNExample-client.dylan</CODE> to look like the following.
</DL>
<PRE>
define method main () =&gt; ()
  with-ole
    format-out(&quot;Client connecting to server.\n&quot;);
    let server = make-RotNExample();
    local method encrypt-and-decrypt () =&gt; ()
      let plaintext = &quot;And he was going ooo-la, oooooo-la...&quot;;
      format-out(&quot;Plaintext is %=, encrypting.\n&quot;, plaintext);
      let ciphertext = IRotNExample/encrypt(server, plaintext);
      format-out(&quot;Ciphertext is %=, decrypting.\n&quot;, ciphertext);
      let decrypted = IRotNExample/decrypt(server, ciphertext);
      format-out(&quot;Decrypted text is %=.\n&quot;, decrypted);
    end method;
<P></P>
    encrypt-and-decrypt();
    server.IRotNExample/key := 3;
    format-out(&quot;Set key to %d.\n&quot;, server.IRotNExample/key);
    encrypt-and-decrypt();
    format-out(&quot;Client releasing server.\n&quot;);
    release(server);
  end with-ole;
end method main;
<P></P>
</PRE>
<P>The <CODE>with-ole</CODE> macro initializes OLE at entry and uninitializes it at exit. </P>
<DL>
<DT><DD>13.  Build the project with <B>Project &gt; Build</B>.
<DT><DD>During the build, you will be prompted for the location of the project file <CODE>RotNExample-client-stubs.hdp</CODE>. 
</DL>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>Getting Started with Functional Developer - 31 MAR 2000</ADDRESS>
<P><A HREF="env_189.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="env_187.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="env_184.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="env_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="env_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="env_206.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
