<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="env_1.htm">
<LINK REL=UP HREF="env_116.htm">
<LINK REL=PREV HREF="env_117.htm">
<LINK REL=NEXT HREF="env_119.htm">
<TITLE>6.5.2   Debugging DLLs</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING118></A>

<DIV>
<P><A HREF="env_119.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="env_117.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="env_116.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="env_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="env_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="env_206.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>6.5   Debugging techniques</P>

</DIV>
<A NAME=HEADING118-0></A>
<H1>6.5.2   <A NAME=MARKER-9-503></A>Debugging<A NAME=MARKER-9-504></A> DLLs</H1>
<P><A NAME=MARKER-2-505></A>Debugging DLLs is similar to debugging executable (EXE) applications (see <A HREF="env_117.htm#MARKER-9-500">Section 6.5.1</A> above), but there are a couple of differences. </P>
<P>One difference is that DLLs may not have a start function. Without a start function, there is nothing for the environment to place a breakpoint upon in order to pause the DLL's execution and enter the debugger. </P>
<P>Nonetheless, for debugging it is still useful to be able to pause the DLL once it has initialized completely but before it exits. To do this, simply remove the name in the Start Function section of the <B>Project &gt; Settings...</B> dialog's Debug page. Then, when you choose <B>Application &gt; Debug</B> or <B>Application &gt; Interact</B>, the debugger lets the DLL execute all its top-level expressions, and pauses the DLL just as its main thread is about to exit. This gives you access to all the definitions and state that the DLL creates.</P>
<P>If the DLL does have a start function, simply specify it and the <B>Application &gt; Debug</B> and <B>Application &gt; Interact</B> commands will work as they do for EXE applications: the environment adds a breakpoint on the start function, and on entry to the function the DLL's main thread is paused and a debugger window is opened on it.</P>
<P>Another consideration is that it is not normally possible to execute a DLL directly; instead, you start an EXE that calls it. The environment normally handles this issue for you, by using a small EXE that takes the target DLL name as a command-line argument, loads it (causing all its top-level expressions to be executed), and exits. When you choose <B>Application &gt; Start</B>, <B>Application &gt; Debug</B>, or <B>Application &gt; Interact</B> the environment runs the EXE. The point at which the EXE is paused again depends on whether you supply a start function.</P>
<P>Alternatively, you can supply your own EXE in the Executable field of the <B>Project &gt; Settings...</B> dialog's Debug page. The <B>Application &gt; Start</B>, <B>Application &gt; Debug</B>, and <B>Application &gt; Interact</B> commands then call your EXE<B> </B>and behave in the same way as if your EXE was the project target file. That is to say, execution of the EXE proceeds without intervention from the debugger until the DLL loads. Only then will the debugger be in a position to pause the DLL. (Again, the point at which the pause occurs depends on whether you specify a start function.) </P>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>Getting Started with Functional Developer - 31 MAR 2000</ADDRESS>
<P><A HREF="env_119.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="env_117.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="env_116.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="env_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="env_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="env_206.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
