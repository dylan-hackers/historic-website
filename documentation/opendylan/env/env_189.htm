<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="env_1.htm">
<LINK REL=UP HREF="env_184.htm">
<LINK REL=PREV HREF="env_188.htm">
<LINK REL=NEXT HREF="env_190.htm">
<TITLE>A.2.5   Testing the client and server pair</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING189></A>

<DIV>
<P><A HREF="env_190.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="env_188.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="env_184.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="env_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="env_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="env_206.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>A.2   An example COM server and client</P>

</DIV>
<A NAME=HEADING189-0></A>
<H1>A.2.5   Testing the client and server pair</H1>
<P>The best way to test the client and server pair is from within the Functional Developer environment, so that we can use the debugger if either application fails.</P>
<P>First we must register the server with the system, so that COM knows where to find the server and what interfaces it supports. In order to do this, we must execute the server with the <CODE>/RegServer</CODE> command line flag. This will cause the server's call <CODE>OLE-util-register-only?</CODE> to return <CODE>#t</CODE>, and the server to call <CODE>register-coclass</CODE>.</P>
<DL>
<DT><DD>1.  Open the RotNExample-server project and build it. 
<DT><DD>2.  Select <B>Project &gt; Settings...</B> in the RotNExample-server project window. 
<DT><DD>The Project Settings dialog appears. 
<DT><DD>3.  On the Debug page, put <CODE>/RegServer</CODE> in the Arguments field, and click <B>OK</B>.
<DT><DD>4.  Start the RotNExample-server application. 
</DL>
<P>The server application registers itself and exits immediately. You can tell that the server has exited by watching the stop button in the project window become unavailable. </P>
<P>Now that the server is registered, it can be invoked by the client. But we are going to start the server manually in the environment before starting the client. That way, if the server fails, we can debug it in the environment. </P>
<P>First, however, we need to remove the <CODE>/RegServer</CODE> argument from the project settings, so that the server can run normally. </P>
<DL>
<DT><DD>5.  Select <B>Project &gt; Settings...</B> in the RotNExample-server project window. 
<DT><DD>The Project Settings dialog appears. 
<DT><DD>6.  On the Debug page, remove <CODE>/RegServer</CODE> from the Arguments field, and click <B>OK</B>.
<DT><DD>7.  Start RotNExample-server.
<DT><DD>8.  Start RotNExample-client. 
<DT><DD>The client should execute, and print something like this:
</DL>
<PRE>
Client connecting to server.
<P></P>
Plaintext is &quot;And he was going ooo-la, oooooo-la...&quot;, encrypting.
Ciphertext is &quot;Naq ur jnf tbvat bbb-yn, bbbbbb-yn...&quot;,
  decrypting.
Decrypted text is &quot;And he was going ooo-la, oooooo-la...&quot;.
Set key to 3.
Plaintext is &quot;And he was going ooo-la, oooooo-la...&quot;, encrypting.
Ciphertext is &quot;Dqg kh zdv jrlqj rrr-od, rrrrrr-od...&quot;,
  decrypting.
Decrypted text is &quot;And he was going ooo-la, oooooo-la...&quot;.
Client releasing server.
<P></P>
</PRE>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>Getting Started with Functional Developer - 31 MAR 2000</ADDRESS>
<P><A HREF="env_190.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="env_188.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="env_184.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="env_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="env_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="env_206.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
