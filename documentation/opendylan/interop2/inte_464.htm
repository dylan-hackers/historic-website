<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="intero_1.htm">
<LINK REL=UP HREF="inte_460.htm">
<LINK REL=PREV HREF="inte_463.htm">
<LINK REL=NEXT HREF="inte_465.htm">
<TITLE> OLE-part-Save-To-Storage</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING464></A>

<DIV>
<P><A HREF="inte_465.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_463.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_460.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>6.7.3   More required methods (persistent storage) </P>

</DIV>
<A NAME=HEADING464-0></A>
<H1> <A NAME=MARKER-2-1604></A><A NAME=MARKER-2-1605></A><A NAME=MARKER-9-1606></A>OLE-part-Save-To-Storage</H1>
<P><I>G.f. method</I></P>
<H3>Summary</H3>
<P> Saves your server application's non-screen-image persistent data. </P>
<H3>Signature</H3>
<dl><dd><pre>OLE-part-Save-To-Storage <I>obj</I> <I>storage</I> <I>sameasload?</I> =&gt; ()</pre></dl>
<H3>Arguments</H3>
<DL>
<P> </P><DT><I>obj</I><DD> An instance of your subclass of <A HREF="inte_452.htm#MARKER-9-1562"><CODE>&lt;ole-server-framework&gt;</CODE></A> or <A HREF="inte_453.htm#MARKER-9-1566"><CODE>&lt;ole-in-process-server&gt;</CODE></A>.
<P> </P><DT><I>storage</I><DD> An instance of <CODE>&lt;LPSTORAGE&gt;</CODE>.
<P> </P><DT><I>sameasload?</I><DD> An instance of <CODE>&lt;boolean&gt;</CODE>.
</DL>
<H3>Values</H3>
<P> None.</P>
<H3>Library</H3>
<dl><dd><pre>OLE-Server</pre></dl>
<H3>Module</H3>
<dl><dd><pre>OLE-Server</pre></dl>
<H3>Description</H3>
<P> Saves your server application's non-screen-image persistent data to <I>storage</I> by writing it to the application's stream objects. </P>
<P> The <I>sameasload?</I> flag indicates whether this is the same compound document storage as that with which the object was originally created. If so, your method should write to the same streams remembered from a previous call to <A HREF="inte_461.htm#MARKER-9-1597"><CODE>OLE-part-Create-Streams</CODE></A> or <A HREF="inte_462.htm#MARKER-9-1600"><CODE>OLE-part-Open-Streams</CODE></A>; otherwise, <A HREF="inte_461.htm#MARKER-9-1597"><CODE>OLE-part-Create-Streams</CODE></A> should be called to create new temporary streams (which should be released with <A HREF="inte_564.htm#MARKER-9-1902"><CODE>Release</CODE>,  page 356</A>, before returning).</P>
<P> You can call <A HREF="inte_494.htm#MARKER-9-1691"><CODE>istream-rewrite</CODE></A> on each stream to position it at the beginning and erase any old data, or use <CODE>IStream/Seek</CODE> to do selective updates. The writing can be done either by using helper functions such as <A HREF="inte_495.htm#MARKER-9-1694"><CODE>istream-write-integer</CODE></A> and <A HREF="inte_496.htm#MARKER-9-1697"><CODE>istream-write-int16</CODE></A>, or by using the low-level API function <CODE>IStream/Write</CODE>.</P>
<P> If your server application has no data other than its window image to store persistently, your method can do nothing. But you must define one even so, because there is no default method. We have not supplied default methods because most applications will need persistent storage, and to allow these operations to be silently ignored could lead to difficulties that would be difficult to trace. </P>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>OLE, COM, ActiveX and DBMS Reference - 31 MAR 2000</ADDRESS>
<P><A HREF="inte_465.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_463.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_460.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
