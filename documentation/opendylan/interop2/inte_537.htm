<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="intero_1.htm">
<LINK REL=UP HREF="inte_535.htm">
<LINK REL=PREV HREF="inte_536.htm">
<LINK REL=NEXT HREF="inte_538.htm">
<TITLE>7.2.2   Ambient properties</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING537></A>

<DIV>
<P><A HREF="inte_538.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_536.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_535.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>7.2   OLE Controls </P>

</DIV>
<A NAME=HEADING537-0></A>
<H1>7.2.2   <A NAME=MARKER-2-1829></A><A NAME=MARKER-9-1830></A>Ambient properties</H1>
<P>OLE control containers typically make property information available to the controls they contain. Ambient properties allow a control to know about and adapt itself to the environment in which it is running. </P>
<P>Some properties are used directly by the OLE-Control-Framework library and you do not need to be concerned about them. (This includes <CODE>$DISPID-AMBIENT-SHOWHATCHING</CODE>.) Others are cached by OLE-Control-Framework so that you can access them easily by calling the following functions: </P>
<UL>
<LI><A HREF="inte_545.htm#MARKER-9-1853"><CODE>freeze-events?</CODE>,  page 342</A>
<LI><A HREF="inte_546.htm#MARKER-9-1856"><CODE>freeze-UI?</CODE>,  page 343</A> 
<LI><A HREF="inte_547.htm#MARKER-9-1859"><CODE>OLE-util-locale</CODE>,  page 343</A> 
</UL>
<P>The current value of any ambient property can be obtained like this:</P>
<PRE>
let dispatch-interface = object.container-IDispatch;
<P></P>
unless ( null-pointer?(dispatch-interface) )
  let value = get-property(dispatch-interface, disp-id,
                           default: $unfound);
  unless ( value == $unfound )
    ... // use the value
  end unless;
end unless;
<P></P>
</PRE>
<P>The function <A HREF="inte_408.htm#MARKER-9-1360"><CODE>get-property</CODE></A> is from the OLE-Automation library; see page <A HREF="inte_408.htm#MARKER-9-1360">218</A>. A <CODE>default:</CODE> value must be supplied because containers are not required to support all properties. The particular property is identified by a Dispatch ID, which is one of the following constants:</P>
<DL>
<DT><CODE>$DISPID-AMBIENT-AUTOCLIP</CODE> <DD><P></P>
<DT><DD>True if container automatically clips the control display area.
<DT><CODE>$DISPID-AMBIENT-APPEARANCE</CODE> <DD><P></P>
<DT><DD>Control appearance: 
<DT><DD>0 =&gt; flat
<DT><DD>1 =&gt; 3D
<DT><CODE>$DISPID-AMBIENT-BACKCOLOR</CODE> <DD><P></P>
<DT><DD>Background color. Convert the value with <A HREF="inte_551.htm#MARKER-9-1869"><CODE>OLE-util-translate-color</CODE>,  page 347</A>.
<DT><CODE>$DISPID-AMBIENT-FORECOLOR</CODE> <DD><P></P>
<DT><DD>Foreground color. Convert the value with <A HREF="inte_551.htm#MARKER-9-1869"><CODE>OLE-util-translate-color</CODE>,  page 347</A>.
<DT><CODE>$DISPID-AMBIENT-FONT</CODE> <DD><P></P>
<DT><DD>Font, as an <CODE>IDispatch</CODE> interface.
<DT><CODE>$DISPID-AMBIENT-DISPLAYNAME</CODE> <DD><P></P>
<DT><DD>Name of control for use in error messages.
<DT><CODE>$DISPID-AMBIENT-LOCALEID</CODE> <DD><P></P>
<DT><DD>Locale.
<DT><CODE>$DISPID-AMBIENT-MESSAGEREFLECT</CODE> <DD><P></P>
<DT><DD>Boolean value indicating whether the container wants to receive Windows messages such as <CODE>$WM-CTLCOLOR</CODE>, <CODE>$WM-DRAWITEM</CODE>, or <CODE>$WM-PARENTNOTIFY</CODE>.
<DT><CODE>$DISPID-AMBIENT-SCALEUNITS</CODE> <DD><P></P>
<DT><DD>A string (actually an instance of <A HREF="inte_391.htm#MARKER-9-1291"><CODE>&lt;ole-array&gt;</CODE>,  page 198</A>) naming the coordinate unit used by the container.
<DT><CODE>$DISPID-AMBIENT-TEXTALIGN</CODE> <DD><P></P>
<DT><DD>Text alignment: 
<DT><DD>0 =&gt; numbers to the right and text to the left
<DT><DD>1 =&gt; left
<DT><DD>2 =&gt; center
<DT><DD>3 =&gt; right
<DT><DD>4 =&gt; fill justify
<DT><CODE>$DISPID-AMBIENT-USERMODE</CODE> <DD><P></P>
<DT><DD>True if user mode, false if design mode.
<DT><CODE>$DISPID-AMBIENT-UIDEAD</CODE><DD><P></P>
<DT><DD>True if user input should be ignored.
<DT><CODE>$DISPID-AMBIENT-SHOWGRABHANDLES</CODE><DD><P></P>
<DT><DD>True to enable resize handles.
<DT><CODE>$DISPID-AMBIENT-DISPLAYASDEFAULT</CODE><DD><P></P>
<DT><DD>True if control is the default button.
<DT><CODE>$DISPID-AMBIENT-SUPPORTSMNEMONICS</CODE> <DD><P></P>
<DT><DD>True if container supports mnemonics.
</DL>
<P>Alternatively, a control can ask to be notified whenever the value of an ambient property changes. This is done by defining a method on the function <A HREF="inte_549.htm#MARKER-9-1863"><CODE>OLE-part-ambient-properties</CODE>,  page 345</A>, to specify which properties are of interest, and defining one or more methods on <A HREF="inte_550.htm#MARKER-9-1866"><CODE>OLE-part-set-ambient-property</CODE>,  page 346</A>, to receive the values. The following functions are also related to ambient property support:</P>
<UL>
<LI><A HREF="inte_548.htm#MARKER-9-1860"><CODE>container-IDispatch</CODE>,  page 344</A>.
<LI><A HREF="inte_551.htm#MARKER-9-1869"><CODE>OLE-util-translate-color</CODE>,  page 347</A>.
</UL>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>OLE, COM, ActiveX and DBMS Reference - 31 MAR 2000</ADDRESS>
<P><A HREF="inte_538.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_536.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_535.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
