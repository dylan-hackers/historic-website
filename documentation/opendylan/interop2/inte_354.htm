<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="intero_1.htm">
<LINK REL=UP HREF="inte_350.htm">
<LINK REL=PREV HREF="inte_353.htm">
<LINK REL=NEXT HREF="inte_355.htm">
<TITLE>4.3.4   Class factories</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING354></A>

<DIV>
<P><A HREF="inte_355.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_353.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_350.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>4.3   Overview of OLE Automation </P>

</DIV>
<A NAME=HEADING354-0></A>
<H1>4.3.4   <A NAME=MARKER-2-1165></A><A NAME=MARKER-2-1166></A><A NAME=MARKER-9-1167></A>Class factories</H1>
<P>When a server starts running, it does not typically create an instance of the COM class it was asked for straight away. Instead, it first creates a <I>class factory</I>. </P>
<P>A class factory can create multiple objects of a single COM class. Class factories are COM objects that support the interface <CODE>IClassFactory</CODE> or <CODE>IClassFactory2</CODE>. </P>
<P>The OLE-Automation library provides the class <A HREF="inte_393.htm#MARKER-9-1303"><CODE>&lt;class-factory&gt;</CODE>,  page 199</A>. When you create an instance of this class, a COM class factory object is created and registered with Windows. Once you have finished with the class factory (such as when the server is about to terminate) you must end this registration with the function <A HREF="inte_418.htm#MARKER-9-1381"><CODE>revoke-registration</CODE>,  page 227</A>. </P>
<P>Once the server's class factory is running, the controller connects to the class factory and directs it to make an instance of the desired COM object. </P>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>OLE, COM, ActiveX and DBMS Reference - 31 MAR 2000</ADDRESS>
<P><A HREF="inte_355.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_353.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_350.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
