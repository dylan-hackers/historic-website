<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="intero_1.htm">
<LINK REL=UP HREF="intero_4.htm">
<LINK REL=PREV HREF="inter_56.htm">
<LINK REL=NEXT HREF="inter_58.htm">
<TITLE>1.4   Data retrieval using result-set collection</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING57></A>

<DIV>
<P><A HREF="inter_58.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inter_56.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="intero_4.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>1 The SQL-ODBC Library</P>

</DIV>
<A NAME=HEADING57-0></A>
<A NAME=UID-sql-888661></A>
<H1>1.4   <A NAME=MARKER-10-230></A><A NAME=MARKER-2-231></A><A NAME=MARKER-2-232></A><A NAME=MARKER-9-233></A>Data retrieval using result-set collection</H1>
<P>Executing an SQL <CODE>SELECT</CODE> statement by invoking the <CODE>execute</CODE> function on the instance of <CODE>&lt;sql-statement&gt;</CODE> that represents the statement<A NAME=MARKER-10-234></A> yields a result set. </P>
<P>A result set is a Dylan collection which encapsulates the protocol necessary to retrieve data from a database. The SQL-ODBC library defines two subclasses of <CODE>&lt;result-set&gt;</CODE> that provide different behaviors and performance characteristics. The type of the result set returned by the <CODE>execute</CODE> function is determined by the result-set <I>policy</I> supplied to the function or macro.</P>
<P>There are two subclasses of <CODE>&lt;result-set&gt;</CODE>: <CODE>&lt;forward-only-result-set&gt;</CODE> and <CODE>&lt;scrollable-result-set&gt;</CODE>.</P>
<P>The <CODE>&lt;forward-only-result-set&gt;</CODE> class provides an efficient means of accessing the elements of a result set. Efficiency is achieved by performing minimal processing on each record retrieved and by maintaining in memory only the current record. Implicit in this behavior is that records you have accessed previously are no longer available to your application; if you maintain references to previous records behavior is unpredictable. The key for each access must always be greater than or equal to the previous access's key; otherwise, a condition is signaled.</P>
<P>The <CODE>&lt;scrollable-result-set&gt;</CODE> class allows your application to access elements of the result-set collection in any order, meaning that records you have accessed previously can be revisited. Scrollable result sets retrieve records synchronously. <A NAME=MARKER-10-235></A></P>
<P>Example:</P>
<P>This example returns a list of authors who have published two or more books.</P>
<PRE>
(result-set-policy: make(&lt;scrollable-result-set-policy&gt;))
    select last_name, first_name, count(*)
    from author, book_author
    where book_author.author_id = author.author_id
    group by last_name, first_name
    having count(*) &gt; 2
  end;
=&gt; #(#(&quot;Date&quot;, &quot;Chris&quot;, 2))
<P></P>
let query = make(&lt;sql-statement&gt;,
                text: &quot;select last_name, first_name, count(*)&quot;
                      &quot;from author, book_author&quot;
                      &quot;where book_author.author_id 
                         = author.author_id&quot;
                      &quot;group by last_name, first_name having                          count(*) &gt;= 2&quot;);
execute(query, result-set-policy: $scrollable-result-set-policy);
</PRE>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>OLE, COM, ActiveX and DBMS Reference - 31 MAR 2000</ADDRESS>
<P><A HREF="inter_58.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inter_56.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="intero_4.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
