<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="intero_1.htm">
<LINK REL=UP HREF="inte_388.htm">
<LINK REL=PREV HREF="inte_426.htm">
<LINK REL=NEXT HREF="inte_428.htm">
<TITLE> register-type-library</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING427></A>

<DIV>
<P><A HREF="inte_428.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_426.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_388.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>4.12   The OLE-AUTOMATION module </P>

</DIV>
<A NAME=HEADING427-0></A>
<H1> <A NAME=MARKER-2-1401></A><A NAME=MARKER-2-1402></A><A NAME=MARKER-9-1403></A>register-type-library</H1>
<P><I>Function</I></P>
<H3>Summary</H3>
<dl><dd><pre>register-type-library <I>typeinfo</I> =&gt; ()</pre></dl>
<H3>Arguments</H3>
<DL>
<P> </P><DT><I>typeinfo</I><DD> An instance of <CODE>&lt;ITypeInfo&gt;</CODE>.
</DL>
<H3>Values</H3>
<DL>
<P> </P><DT>None.<DD>
</DL>
<H3>Description</H3>
<P> Creates an OLE/COM <I>type library</I> file from the given type information and records it in Windows Registry, associating it with this Automation server. </P>
<P> If the server was invoked with the command line option <CODE>/UnregServer</CODE> or <CODE>-UnregServer</CODE>, this function attempts to delete the type library from the registry.</P>
<P> This function returns no values.</P>
<P> The type library file that is created is placed in the same directory as the server (.EXE) file, and will have the same name but with the version and locale numbers appended, and the extension .TLB. For example, <CODE>foo.exe</CODE> might become <CODE>foo-2-1-0.tlb</CODE>.</P>
<P> Automation controllers and other utilities can use the type library to find out what facilities are provided by the Automation server the type library describes, without actually executing the server. </P>
<P> It is not mandatory to create and register a type library for your Automation server, since the server itself does not use it, and an Automation controller does not necessarily need it either. If a connected controller requests the type library, it will use the registered one if it exists, or else force the type library to be created and registered dynamically.</P>
<P> Normally the argument should be an instance of <A HREF="inte_399.htm#MARKER-9-1326"><CODE>&lt;coclass-type-info&gt;</CODE></A>, although if there is just a single dispinterface, it is also possible to pass an instance of <A HREF="inte_395.htm#MARKER-9-1311"><CODE>&lt;disp-type-info&gt;</CODE></A> provided it was created with a unique <CODE>uuid:</CODE> argument (not just <CODE>$IID-IDispatch</CODE>); it will then act as both an Interface ID and a Class ID.</P>
<P> The type library can be identified by its version number and locale as well as its Class ID (type info options <CODE>major-version:</CODE>, <CODE>minor-version:</CODE>, <CODE>locale:</CODE>, and <CODE>uuid:</CODE>, respectively) so different versions of an application can be installed at the same time, and one application can register multiple type libraries with different locales (but the same Class ID, version, and help directory). (However, there will still be only one call to <A HREF="inte_417.htm#MARKER-9-1378"><CODE>make-object-factory</CODE></A>, since it does not depend on the locale.)</P>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>OLE, COM, ActiveX and DBMS Reference - 31 MAR 2000</ADDRESS>
<P><A HREF="inte_428.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_426.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_388.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
