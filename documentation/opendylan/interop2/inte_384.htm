<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="intero_1.htm">
<LINK REL=UP HREF="inte_347.htm">
<LINK REL=PREV HREF="inte_383.htm">
<LINK REL=NEXT HREF="inte_385.htm">
<TITLE>4.8   Datatypes</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING384></A>

<DIV>
<P><A HREF="inte_385.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_383.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_347.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>4 OLE Automation</P>

</DIV>
<A NAME=HEADING384-0></A>
<A NAME=UID-ole-automation-901240></A>
<H1>4.8   <A NAME=MARKER-2-1268></A>Datatypes</H1>
<P>Since the mechanisms of OLE Automation were designed for C and BASIC rather than for Dylan, it does not support the passing of arbitrary Dylan objects. However, instances of the following Dylan classes can be used as method arguments, results, and property values:</P>
<PRE>
&lt;integer&gt;, &lt;machine-word&gt;, &lt;byte-character&gt;, &lt;boolean&gt;, 
&lt;single-float&gt;, &lt;double-float&gt;, &lt;string&gt;
<P></P>
</PRE>
<P>An COM interface can itself be passed as an argument. Also, you can pass instances of <CODE>&lt;sequence&gt;</CODE> or <CODE>&lt;array&gt;</CODE> as long as each element is of one of these types. (The elements do not necessarily have to be of the same class if the server is prepared to accept heterogeneous data; that will be true automatically if the server is implemented in Dylan.) For a <CODE>&lt;sequence&gt;</CODE>, the server will receive the data as a vector, regardless of which subclass of <CODE>&lt;sequence&gt;</CODE> was used in the controller. </P>
<P>You can also pass the special value <CODE>$SQL-NULL</CODE> as an argument to indicate an unspecified value. This is intended to correspond to the null value of SQL, and not a C <CODE>NULL</CODE> pointer.</P>
<P>Note that you cannot pass C pointers, because the controller and server do not necessarily have access to the same address space. Essentially, what is being passed across the dispinterface is a copy of the value.</P>
<P>However, for implementing by-reference parameter passing, it is permissible to pass certain types of C pointers as argument values, but the server can only use the pointer to load or store a value during the duration of the call. Alternatively, a controller can use the convenience functions <CODE>out-ref</CODE> and <CODE>inout-ref</CODE> to implement by-reference parameters without direct handling of C pointers. </P>
<P>In some cases, a server in another language may require an argument to be passed with a particular representation even though it cannot be unambiguously inferred from the actual value. A Dylan client can use the function <CODE>pass-as</CODE> to specify the representation. For example, using the expression <CODE>pass-as(&lt;C-long&gt;,</CODE> <CODE>1)</CODE> as a method argument forces the value <CODE>1</CODE> to be passed as a <CODE>long</CODE> value even though it could fit in a <CODE>short</CODE>.</P>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>OLE, COM, ActiveX and DBMS Reference - 31 MAR 2000</ADDRESS>
<P><A HREF="inte_385.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_383.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_347.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
