<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="intero_1.htm">
<LINK REL=UP HREF="inte_356.htm">
<LINK REL=PREV HREF="inte_364.htm">
<LINK REL=NEXT HREF="inte_366.htm">
<TITLE>4.5.9   Controllers using more than one dispinterface</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING365></A>

<DIV>
<P><A HREF="inte_366.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_364.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_356.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>4.5   Building an Automation controller application</P>

</DIV>
<A NAME=HEADING365-0></A>
<H1>4.5.9   <A NAME=MARKER-2-1201></A><A NAME=MARKER-2-1202></A><A NAME=MARKER-2-1203></A><A NAME=MARKER-2-1204></A><A NAME=MARKER-2-1205></A><A NAME=MARKER-9-1206></A>Controllers using more than one dispinterface</H1>
<P>If the server provides more than one dispinterface, the first dispinterface that the controller gets back is whatever the server developer designated the default dispinterface. The controller can find the other dispinterfaces by calling the method <A HREF="inte_565.htm#MARKER-9-1905"><CODE>QueryInterface</CODE>,  page 356</A>, passing the default dispinterface and the ID (from <A HREF="inte_559.htm#MARKER-9-1892"><CODE>make-GUID</CODE>,  page 351</A>) of the desired interface. See also <A HREF="inte_378.htm#MARKER-9-1250">"Servers providing more than one dispinterface" on page 187</A>.</P>
<P>For example:</P>
<PRE>
let (status, foo-interface) =
  QueryInterface(dispinterface, interface-id);
<P></P>
if (FAILED?(status))
  error(...);  // Requested interface not found
else
  ... // Use foo-interface
  Release(foo-interface); // Mandatory when finished
end;
<P></P>
</PRE>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>OLE, COM, ActiveX and DBMS Reference - 31 MAR 2000</ADDRESS>
<P><A HREF="inte_366.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_364.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_356.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
