<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="intero_1.htm">
<LINK REL=UP HREF="inte_321.htm">
<LINK REL=PREV HREF="inte_335.htm">
<LINK REL=NEXT HREF="inte_337.htm">
<TITLE> save-frame-to-storage</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING336></A>

<DIV>
<P><A HREF="inte_337.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_335.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_321.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>3.6   The DUIM-OLE-SERVER module</P>

</DIV>
<A NAME=HEADING336-0></A>
<H1> <A NAME=MARKER-2-1052></A><A NAME=MARKER-2-1053></A><A NAME=MARKER-9-1054></A>save-frame-to-storage</H1>
<P><I>Open generic function</I></P>
<H3>Summary</H3>
<P> The DUIM-OLE-Server library calls this function to store the server application's data persistently as part of the container's compound document.</P>
<H3>Signature</H3>
<dl><dd><pre>save-frame-to-storage <I>frame</I> <I>stream</I> =&gt; () </pre></dl>
<H3>Arguments</H3>
<DL>
<P> </P><DT><I>frame</I><DD> An instance of <A HREF="inte_322.htm#MARKER-9-1014"><CODE>&lt;embeddable-frame&gt;</CODE></A>.
<P> </P><DT><I>stream</I><DD> An instance of <CODE>&lt;storage-istream&gt;</CODE>.
</DL>
<H3>Values</H3>
<DL>
<P> </P><DT>None. <DD>
</DL>
<H3>Library</H3>
<dl><dd><pre>duim-ole-server</pre></dl>
<H3>Module</H3>
<dl><dd><pre>duim-ole-server</pre></dl>
<H3>Description</H3>
<P> The DUIM-OLE-Server library calls this function to store the server application's data persistently as part of the container's compound document. If your server application has any data that should be saved persistently, you must provide a method on this function. The default method does nothing. </P>
<P> If you wanted to save three <CODE>&lt;integer&gt;</CODE> values in the compound document, the method on <CODE>save-frame-to-storage</CODE> might look something like this:</P>
<DL><DD><PRE>  define method save-frame-to-storage 
    (frame :: &lt;foo-frame&gt;, 
     stream :: &lt;storage-istream&gt;) =&gt; ()
       istream-write-integer(stream, frame.foo);
      istream-write-integer(stream, frame.bar);
      istream-write-integer(stream, frame.baz);
  end method;</PRE></DL>
<P> The function <CODE>istream-write-integer</CODE> stores a 32-bit signed integer (and returns no values), while <CODE>istream-write-int16</CODE> can be used for values that fit into a 16-bit signed field. Use <CODE>istream-write-float</CODE> for a <CODE>&lt;single-float&gt;</CODE>, or <CODE>istream-write-string</CODE> to write a <CODE>&lt;byte-string&gt;</CODE>.</P>
<P> You can also use the low-level OLE API function <CODE>IStream/Write</CODE> to output arbitrary FFI data, or you can use the functions in the Streams or Format modules of the IO library.<A NAME=MARKER-10-1055></A>Note that there are separate <CODE>istream-write-</CODE>... functions instead of a single generic function, because the object type is not saved to the stream; you need to know what kind of object you are writing in order to know how to read it back.</P>
<P> <A NAME=MARKER-10-1056></A> <A NAME=MARKER-10-1057></A> </P>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>OLE, COM, ActiveX and DBMS Reference - 31 MAR 2000</ADDRESS>
<P><A HREF="inte_337.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_335.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_321.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
