<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="intero_1.htm">
<LINK REL=UP HREF="inte_316.htm">
<LINK REL=PREV HREF="inte_316.htm">
<LINK REL=NEXT HREF="inte_318.htm">
<TITLE>3.5.1   Differences from implementing OLE compound document servers</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING317></A>

<DIV>
<P><A HREF="inte_318.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_316.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_316.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>3.5   Building an OLE control in DUIM </P>

</DIV>
<A NAME=HEADING317-0></A>
<H1>3.5.1   <A NAME=MARKER-2-993></A><A NAME=MARKER-2-994></A><A NAME=MARKER-2-995></A><A NAME=MARKER-2-996></A><A NAME=MARKER-2-997></A>Differences from implementing OLE compound document servers</H1>
<P>To build an OLE control in DUIM using the DUIM-OLE-Control library, write your application as you would write an OLE compound document server with DUIM-OLE-Server (see <A HREF="inte_309.htm#MARKER-9-966">Section 3.4</A>), but with the few differences summarized below. </P>
<DL>
<DT><DD>1.  Use the library DUIM-OLE-Control instead of DUIM-OLE-Server. 
<DT><DD>In addition to the DUIM libraries you would normally use, use the DUIM-OLE-Control library and its <CODE>DUIM-OLE-Control</CODE> module in your control's library and module definitions.
<DT><DD>2.  You can optionally provide type information, specifying the methods and properties that are available to your control's clients (control containers). Type information is represented with an instance of <CODE>&lt;coclass-type-info&gt;</CODE>. If the frame just contains a DUIM <CODE>&lt;gadget&gt;</CODE>, you can let the library create type information automatically. It creates type information corresponding to the DUIM gadget protocols.
<DT><DD>3.  If possible, define a method for <CODE>max-storage-size</CODE>.
<DT><DD>4.  The program must be linked as a dynamic link library (file suffix .DLL or .OCX), not as an .EXE file.
<DT><DD>5.  Do not directly instantiate the DUIM frame or call <CODE>start-frame</CODE>. 
<DT><DD>OLE control registration and activation is handled by the <CODE>initialize-ole-control</CODE> macro, described below.
</DL>
<P>An OLE control also differs from a compound document server in that out-of-place activation is never used, and to be actually used as a "control" element, the frame will typically contain just a single <CODE>&lt;gadget&gt;</CODE>, with no menu bar or tool bar, so that it can be active at the same time as other controls.</P>
<P>For more information, see the code for the DUIM OCX Scribble example, in</P>
<PRE>
Examples\duim-ole\ocx-scribble\
<P></P>
</PRE>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>OLE, COM, ActiveX and DBMS Reference - 31 MAR 2000</ADDRESS>
<P><A HREF="inte_318.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_316.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_316.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
