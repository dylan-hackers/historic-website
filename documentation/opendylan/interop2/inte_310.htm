<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="intero_1.htm">
<LINK REL=UP HREF="inte_309.htm">
<LINK REL=PREV HREF="inte_309.htm">
<LINK REL=NEXT HREF="inte_311.htm">
<TITLE>3.4.1   Differences from ordinary DUIM applications </TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING310></A>

<DIV>
<P><A HREF="inte_311.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_309.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_309.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>3.4   Building a compound document server in DUIM</P>

</DIV>
<A NAME=HEADING310-0></A>
<H1>3.4.1   <A NAME=MARKER-2-967></A><A NAME=MARKER-2-968></A><A NAME=MARKER-2-969></A><A NAME=MARKER-2-970></A>Differences from ordinary DUIM applications </H1>
<P>To build a compound document server application in DUIM, write your application as you would a normal DUIM application, but with the few differences summarized below. </P>
<DL>
<DT><DD>1.  Use the DUIM-OLE-Server library.
<DT><DD>In addition to the DUIM libraries you would normally use, use the DUIM-OLE-Server library and its <CODE>DUIM-OLE-Server</CODE> module in your server application's library and module definitions.
<DT><DD>2.  Define the application as a subclass of <CODE>&lt;embeddable-frame&gt;</CODE>.
<DT><DD>Instead of defining your application as a subclass of <CODE>&lt;simple-frame&gt;</CODE>, define it as a subclass of <A HREF="inte_322.htm#MARKER-9-1014"><CODE>&lt;embeddable-frame&gt;</CODE></A> (page <A HREF="inte_322.htm#MARKER-9-1014">146</A>).
<DT><DD>3.  Give the application a COM Class ID (a GUID).
<DT><DD>When creating an instance of <CODE>&lt;embeddable-frame&gt;</CODE> with <CODE>make</CODE>, supply a <CODE>class-id:</CODE> argument (whose value is usually created by <A HREF="inte_559.htm#MARKER-9-1892"><CODE>make-GUID</CODE>,  page 351</A>). This argument is recorded next to the name of the server application in the Windows registry; it is the key that client applications use to find the server application. There are other, optional arguments that allow further control over registration. See <A HREF="inte_322.htm#MARKER-9-1014"><CODE>&lt;embeddable-frame&gt;</CODE>,  page 146</A>.
<DT><DD>4.  Define methods to handle persistent storage in compound documents.
<DT><DD>Define methods for <A HREF="inte_336.htm#MARKER-9-1054"><CODE>save-frame-to-storage</CODE></A> (page <A HREF="inte_336.htm#MARKER-9-1054">159</A>) and <A HREF="inte_337.htm#MARKER-9-1060"><CODE>load-frame-from-storage</CODE></A> (page <A HREF="inte_337.htm#MARKER-9-1060">160</A>). These functions handle your server application's persistent data, ensuring that it can be saved as part of a compound document and reloaded next time the user accesses the compound document. When your application needs to save its data, call <A HREF="inte_332.htm#MARKER-9-1042"><CODE>note-embedded-data-changed</CODE></A> (page <A HREF="inte_332.htm#MARKER-9-1042">155</A>) on the instance of <CODE>&lt;embeddable-frame&gt;</CODE>.
<DT><DD>5.  Use <CODE>frame-status-message</CODE> for application status bar messages 
<DT><DD>To display status bar messages, instead of referring directly to <CODE>frame-status-bar</CODE>, use this idiom:
</DL>
<PRE>
  frame-status-message(<I>frame</I>) := &quot;Message-text string&quot;;
<P></P>
</PRE>
<DL>
<DT><DD>This ensures that status bar messages always work, whether or not the application is running embedded.
</DL>
<P>For more information, see the code for the DUIM OLE Scribble example in:</P>
<PRE>
Examples\duim-ole\ole-scribble\
<P></P>
</PRE>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>OLE, COM, ActiveX and DBMS Reference - 31 MAR 2000</ADDRESS>
<P><A HREF="inte_311.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_309.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_309.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
