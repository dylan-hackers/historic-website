<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="intero_1.htm">
<LINK REL=UP HREF="inte_264.htm">
<LINK REL=PREV HREF="inte_269.htm">
<LINK REL=NEXT HREF="inte_271.htm">
<TITLE>2.1.6   OLE/COM example: using compound documents</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING270></A>

<DIV>
<P><A HREF="inte_271.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_269.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_264.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>2.1   Introduction</P>

</DIV>
<A NAME=HEADING270-0></A>
<H1>2.1.6   <A NAME=MARKER-2-861></A><A NAME=MARKER-9-862></A>OLE/COM example: using compound documents</H1>
<P>To give an example of OLE/COM technologies in action, we will now create a compound document and give a very high-level overview of what is going on as we do so. Compound documents are the simplest OLE/COM technology to demonstrate, since all basic Windows 95 and NT 4 setups include some applications that can be used as compound document containers and servers. If you have created a compound document before, you may wish to skip this section.</P>
<P>To begin, simply start the WordPad program. It should be available from the <B>Start</B> menu as <B>Programs &gt; Accessories &gt; WordPad</B>. Type some text into the empty document window. We can embed a picture into this document, thereby creating a compound document. </P>
<P>Choose <B>Insert &gt; Object</B> in WordPad. This command brings up the Insert Object dialog, which shows a list of COM objects you can embed in a WordPad document. </P>
<P>This is actually a list of new objects; by changing the option button selection from <B>Create New</B> to <B>Create from File</B> we can also embed an existing file into the document and activate it using the application that created it.</P>
<P><IMG ALIGN=TOP SRC=in27ima2.gif></P>
<P>Figure 2.1   <A NAME=MARKER-10-863></A>A new WordPad document.</P>
<P>For this example, we want to create a new Paintbrush picture. Select <B>Paintbrush Picture</B> in the <B>Object Type</B> list and click <B>OK</B>.</P>
<P><A NAME=MARKER-10-864></A><IMG ALIGN=TOP SRC=in27ima3.gif></P>
<P>Figure 2.2   WordPad's Insert Object dialog.</P>
<P>Having chosen the Paintbrush picture object, the WordPad window shows a drawing region bounded on two sides by scroll bars. This is our embedded Paintbrush picture object. Notice too that the horizontal toolbar has gone away, to be replaced by a vertical toolbar and a pane at the bottom of the window containing a color palette. In addition, the menu bar has changed.</P>
<P>The new toolbar, pane, and menu bar are actually part of the user interface for the bundled Windows application Paint (formerly Paintbrush). We can confirm this by going to the <B>Help</B> menu; the "About" option is now <B>About Paint</B>.</P>
<P>The Paint toolbar, pane, and menus remain available as long as the picture object is <I>active</I>. The object is active when we can draw in the region; activation ends when we click outside the region or press Esc. Because the picture object is active inside the WordPad document, this sort of activation is known as <I>in-place activation</I>. The opposite of an in-place activation would be one where the picture object started up in a separate Paint window instead of in the container, WordPad. <IMG ALIGN=TOP SRC=in27ima4.gif></P>
<P>Figure 2.3   An activated embedded Paintbrush picture object in WordPad.</P>
<P>If we click outside the drawing region, the activation is ended and the Paintbrush tools go away. The WordPad toolbar returns. However, the picture we have drawn remains embedded. We can save the document and, when we open it again in WordPad, the embedded Paintbrush picture will still be available for viewing and editing. </P>
<P>Thus we have created a compound document comprised of data from WordPad and Paint. The document remains principally a WordPad document--WordPad will be the application it will open in by default--but clearly it is not just a WordPad document. </P>
<P>We can continue working with this document to demonstrate the difference between linking and embedding, and between in-place and out-of-place activation. We will now link a file containing a picture object into the document. </P>
<P>Start Paint up from the <B>Start</B> menu with <B>Programs &gt; Accessories &gt; Paint</B>. Now draw something in the empty picture, and save it in a new file.</P>
<P>Return to the WordPad document. We are now going to link our new picture file into the WordPad document. Make sure the existing picture object is not activated, because we cannot link a picture object into a picture object. (Notice there is no <B>Insert &gt; Object</B> command in WordPad while a picture object is activated--we can conclude from this that Paint can only play the role of a server in a compound document, and not that of a container.)</P>
<P>Choose <B>Insert &gt; Object</B> in WordPad and select the <B>Create from File</B> option button. Select your Paint picture file in the <B>File</B> box. </P>
<P>If we clicked <B>OK</B> at this stage, the object in the Paint picture file would be embedded in the WordPad compound document. Future changes to the Paint picture file would not be reflected in WordPad document. However, if we select the <B>Link</B> box before clicking <B>OK</B>, the picture object would be stored as a link to the Paint picture file, so future changes to the file would be reflected in the WordPad document. </P>
<P>Select the <B>Link</B> box and click <B>OK</B>. If we double-click on the inserted picture to active it, the activation occurs in a new Paint window. Linked objects can never be edited in place. To end this sort of activation, we have to exit the Paint window.</P>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>OLE, COM, ActiveX and DBMS Reference - 31 MAR 2000</ADDRESS>
<P><A HREF="inte_271.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_269.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_264.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
