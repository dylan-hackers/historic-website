<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="intero_1.htm">
<LINK REL=UP HREF="inte_366.htm">
<LINK REL=PREV HREF="inte_368.htm">
<LINK REL=NEXT HREF="inte_370.htm">
<TITLE>4.6.3   Defining type information for the dispinterface</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING369></A>

<DIV>
<P><A HREF="inte_370.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_368.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_366.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>4.6   Building an Automation server application</P>

</DIV>
<A NAME=HEADING369-0></A>
<H1>4.6.3   <A NAME=MARKER-2-1215></A><A NAME=MARKER-2-1216></A><A NAME=MARKER-2-1217></A>Defining type information for the dispinterface</H1>
<P>To define type information for dispinterface, create an instance of the class <A HREF="inte_395.htm#MARKER-9-1311"><CODE>&lt;disp-type-info&gt;</CODE>,  page 203</A>. We continue the example above by defining type information suitable for <CODE>&lt;my-dispatch-object&gt;</CODE>.</P>
<P>If you wanted the <CODE>my-property</CODE> slot in the example above to be an OLE Automation property that a controller can read or write, you could define type information like this:</P>
<PRE>
define constant $my-type-info = 
  make(&lt;disp-type-info&gt;, 
       properties: vector(make(&lt;variable-description&gt;,
                               name: &quot;value&quot;,
                               documentation: &quot;some value&quot;,
                               getter: my-property,
                               setter: my-property-setter)));
<P></P>
</PRE>
<P>The <CODE>name:</CODE> option specifies the property name that the controller will see; the Dylan class and function names will not be visible externally. </P>
<P>If you wish, you can deny either read or write access by suppling <CODE>getter:</CODE> or <CODE>setter:</CODE> values of <CODE>#f</CODE> respectively. </P>
<P>The <CODE>documentation:</CODE> is optional; it corresponds what is called a "helpstring" in IDL. </P>
<P>Note that a property does not have to correspond to a slot. It simply needs an accessor method specialized on the class. Any number of properties could be specified as elements of the vector. The DISPID values will be assigned automatically; your server does not need to know what they are, because the controller will ask for them by name.</P>
<P>Note that <CODE>setter:</CODE> <CODE>#f</CODE> simply means that the controller cannot change the value--not that it is necessarily a constant. You can specify a property that really is just a constant value like this: </P>
<PRE>
...
properties: vector(... make(&lt;constant-description&gt;, 
                          name: &quot;pi&quot;,
                          value: 3.1416),
                        ...
<P></P>
</PRE>
<P>In this case, the type information contains the complete implementation of the property; no slot or accessor functions are needed. </P>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>OLE, COM, ActiveX and DBMS Reference - 31 MAR 2000</ADDRESS>
<P><A HREF="inte_370.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_368.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_366.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
