<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="intero_1.htm">
<LINK REL=UP HREF="inte_388.htm">
<LINK REL=PREV HREF="inte_415.htm">
<LINK REL=NEXT HREF="inte_417.htm">
<TITLE> create-dispatch</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING416></A>

<DIV>
<P><A HREF="inte_417.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_415.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_388.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>4.12   The OLE-AUTOMATION module </P>

</DIV>
<A NAME=HEADING416-0></A>
<H1> <A NAME=MARKER-2-1373></A><A NAME=MARKER-2-1374></A><A NAME=MARKER-9-1375></A>create-dispatch</H1>
<P><I>Function</I></P>
<H3>Summary</H3>
<P> Invokes or connects to an Automation server, as specified by its COM Class ID.</P>
<H3>Signature</H3>
<DL><DD><PRE>create-dispatch <I>class-ID</I> #key <I>context</I> <I>interface-ID</I> =&gt; 
                <I>disp-interface</I> </PRE></DL>
<H3>Arguments</H3>
<DL>
<P> </P><DT><I>class-ID</I><DD> An instance of <CODE>&lt;string&gt;</CODE> or <CODE>&lt;REFGUID&gt;</CODE>. 
<P> </P><DT><I>context</I><DD> An instance of <CODE>&lt;integer&gt;</CODE>. Default value: <CODE>$CLSCTX-ALL</CODE>.
<P> </P><DT><I>interface-ID</I><DD> An instance of <CODE>&lt;REFCLSID&gt;</CODE> or <CODE>&lt;string&gt;</CODE>. See Description.
</DL>
<H3>Values</H3>
<DL>
<P> </P><DT><I>disp-interface</I><DD> An instance of <CODE>&lt;LPDISPATCH&gt;</CODE>.
</DL>
<H3>Description</H3>
<P> Invokes or connects to an Automation server, as specified by its COM <I>class-ID</I>. This is a function for use by Automation controllers.</P>
<P> Normally, this function returns the server's primary dispinterface, but you can use the <I>interface-ID</I> option to select a specific interface. </P>
<P> You should call <A HREF="inte_564.htm#MARKER-9-1902"><CODE>Release</CODE></A> on the returned interface when finished using it.</P>
<P> The <I>class-id</I> argument and <I>interface-ID</I> option may be either an instance of <CODE>&lt;REFCLSID&gt;</CODE> (such as returned by <A HREF="inte_559.htm#MARKER-9-1892"><CODE>make-GUID</CODE></A>) or a string of 32 hexadecimal digits in the following format </P>
<dl><dd><pre>  &quot;{<I>xxxxxxxx</I>-<I>xxxx</I>-<I>xxxx</I>-<I>xxxx</I>-<I>xxxxxxxxxxxx</I>}&quot; </pre></dl>
<P> That is, where each <I>x</I> is a hexadecimal digit. For example:</P>
<dl><dd><pre>  &quot;{e90f09e0-43db-11d0-8a04-02070119f639}&quot;</pre></dl>
<P> The <I>context</I> option takes one of the following values, constraining which implementation of the server to use: </P>
<DL>
<P> </P><DT><CODE>$CLSCTX-INPROC-SERVER</CODE> <DD>
<P>An in-process server (DLL running in the container's process). </P>
<P> </P><DT><CODE>$CLSCTX-LOCAL-SERVER</CODE> <DD>
<P>A server running in its own process (EXE file).</P>
<P> </P><DT><CODE>$CLSCTX-REMOTE-SERVER</CODE> <DD>
<P>Server running on a remote machine.</P>
<P> </P><DT><CODE>$CLSCTX-SERVER</CODE> <DD>
<P>Any of the above.</P>
<P> </P><DT><CODE>$CLSCTX-INPROC-HANDLER</CODE> <DD>
<P>An in-process handler.</P>
<P> </P><DT><CODE>$CLSCTX-ALL</CODE> <DD>
<P>Any of the above. This is the default value.</P>
</DL>
<P> If the Class ID is not found in the Windows registry, or there is no server that matches the requested <I>context</I>, the function will signal an <CODE>&lt;ole-error&gt;</CODE>, with status code of <CODE>$REGDB-E-CLASSNOTREG</CODE>. </P>
<P> If an interface matching the <I>interface-ID</I> is not found, the function will signal an <CODE>&lt;ole-error&gt;</CODE> with status code <CODE>$E-NOINTERFACE</CODE>.</P>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>OLE, COM, ActiveX and DBMS Reference - 31 MAR 2000</ADDRESS>
<P><A HREF="inte_417.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_415.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_388.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
