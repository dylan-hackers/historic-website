<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="intero_1.htm">
<LINK REL=UP HREF="inte_366.htm">
<LINK REL=PREV HREF="inte_381.htm">
<LINK REL=NEXT HREF="inte_383.htm">
<TITLE>4.6.14   In-process server initialization</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING382></A>

<DIV>
<P><A HREF="inte_383.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_381.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_366.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>4.6   Building an Automation server application</P>

</DIV>
<A NAME=HEADING382-0></A>
<H1>4.6.14   <A NAME=MARKER-2-1262></A><A NAME=MARKER-2-1263></A><A NAME=MARKER-2-1264></A><A NAME=MARKER-2-1265></A>In-process server initialization</H1>
<P>For an in-process server--one that is built as a DLL file instead of an EXE file--server registration and start-up is handled by code generated by the following macro call, which should appear at the end of the last source file in the server project:</P>
<PRE>
in-process-automation-server(
  typeinfo: make(&lt;disp-type-info&gt;, ...),
  class-id: $my-class-id, 
  prog-id: &quot;Foo.Bar&quot;,
  class: &lt;my-dispatch-object&gt;,
  title: &quot;in-process Automation server example&quot;);
<P></P>
</PRE>
<P>The container application will provide the Windows event loop, so there is no need for one in the server. Any windows that the server uses should be created in the server object's <CODE>initialize</CODE> method and destroyed in its <CODE>terminate</CODE> method.</P>
<P>Do not call <CODE>ExitProcess</CODE> or <CODE>PostQuitMessage</CODE> from an in-process server, because that would terminate the container process.</P>
<P>In-process servers still require registration. To register the DLL file, pass it as the argument to the Windows utility program <CODE>REGSVR32</CODE>. The program supports these options before the file name:</P>
<DL>
<DT><CODE>/s</CODE><DD><P> Suppress the dialog box that reports completion.</P>
<DT><CODE>/c</CODE><DD><P> Console output instead of dialog box.</P>
<DT><CODE>/u</CODE><DD><P> Unregister instead of register.</P>
</DL>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>OLE, COM, ActiveX and DBMS Reference - 31 MAR 2000</ADDRESS>
<P><A HREF="inte_383.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_381.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_366.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
