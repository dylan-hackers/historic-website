<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="intero_1.htm">
<LINK REL=UP HREF="inte_263.htm">
<LINK REL=PREV HREF="inte_277.htm">
<LINK REL=NEXT HREF="inte_279.htm">
<TITLE>2.3   Registering OLE/COM software </TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING278></A>

<DIV>
<P><A HREF="inte_279.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_277.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_263.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>2 Functional Developer's COM, OLE, and ActiveX Libraries </P>

</DIV>
<A NAME=HEADING278-0></A>
<A NAME=UID-ole-intro-897976></A>
<H1>2.3   <A NAME=MARKER-10-899></A><A NAME=MARKER-2-900></A><A NAME=MARKER-2-901></A><A NAME=MARKER-2-902></A><A NAME=MARKER-2-903></A><A NAME=MARKER-2-904></A><A NAME=MARKER-9-905></A>Registering OLE/COM software </H1>
<P>All the different kinds of OLE/COM server software--compound document server applications, Automation server applications, and OLE controls--must be registered with Windows so that OLE/COM client applications can use them. Until a server or control has been registered, there is no way for a client to find it. </P>
<P>Servers and controls typically register themselves. Registration involves the server or control entering its own COM Class ID into the Windows Registry. If a server or control implements more than one COM object, it must register the Class ID for each one. </P>
<P>The Class ID is recorded alongside the pathname to the server executable, or control OCX or DLL file. When a client application asks to connect to a COM object with a particular Class ID, the native Windows OLE/COM libraries consult the Registry to find the path to the server or control that implements the COM object in question, using the Class ID as a key.</P>
<P>Conventionally, you register server applications by calling them with the command-line argument <CODE>/RegServer</CODE> or <CODE>-RegServer</CODE>. For example:</P>
<PRE>
ms-dos&gt; my-server-app.exe /RegServer
<P></P>
</PRE>
<P>The application recognizes the registration request, registers itself, and exits without doing anything else. Applications can also unregister themselves when they receive the command-line argument <CODE>/UnregServer</CODE> or <CODE>-UnregServer</CODE>. </P>
<P>OLE controls register themselves dynamically when they are invoked. You supply registration data (including Class IDs) to a macro <A HREF="inte_540.htm#MARKER-9-1838"><CODE>initialize-ole-control</CODE></A> (see page <A HREF="inte_540.htm#MARKER-9-1838">338</A>), which prepares the DLL/OCX into which the control is built for dynamic self-registration when a container invokes it. You can also register a control explicitly with the command <CODE>regsvr32</CODE>:</P>
<PRE>
ms-dos&gt; regsvr32 my-control.ocx
<P></P>
</PRE>
<P>Server applications and controls must of course contain code that can perform registration. The Functional Developer OLE/COM API provides functions to help simplify the coding you need to do for self-registration. </P>
<P><B>Note:</B> When you perform an explicit registration with either <CODE>/RegServer</CODE>, <BR><CODE>-RegServer</CODE>, or <CODE>regsvr32</CODE>, the full pathname of the file is recorded in the registry. To move the file to a different folder, you must first unregister it, then move it, and then register it again at its new location.</P>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>OLE, COM, ActiveX and DBMS Reference - 31 MAR 2000</ADDRESS>
<P><A HREF="inte_279.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_277.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_263.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_579.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
