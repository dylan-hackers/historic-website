<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1977) -->
<HEAD>
<LINK REL=TOP HREF="dref_1.htm">
<LINK REL=UP HREF="dref_287.htm">
<LINK REL=PREV HREF="dref_515.htm">
<LINK REL=NEXT HREF="dref_517.htm">
<TITLE> with-clipboard</TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1977)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING516></A>

<DIV>
<P><A HREF="dref_517.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="dref_515.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="dref_287.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="dref_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="dref_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="dref_991.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>5.3   DUIM-Sheets Module</P>

</DIV>
<A NAME=HEADING516-0></A>
<H1> <A NAME=MARKER-9-2859></A>with-clipboard</H1>
<P><I>Statement macro</I></P>
<H3>Summary</H3>
<P> Evaluates a body of code with a clipboard grabbed.</P>
<H3>Signature</H3>
<dl><dd><pre>with-clipboard (<I>clipboard</I> = <I>sheet</I>) <I>body</I> end</pre></dl>
<H3>Arguments</H3>
<DL>
<P> </P><DT><I>clipboard</I><DD> A Dylan variable-name<SUB>bnf</SUB>.
<P> </P><DT><I>sheet</I><DD> A Dylan variable-name<SUB>bnf</SUB>.
<P> </P><DT><I>body</I><DD> A Dylan body<SUB>bnf</SUB>.
</DL>
<H3>Values</H3>
<DL>
<P> </P><DT><I>values</I><DD> Instances of <CODE>&lt;object&gt;</CODE>. <A NAME=MARKER-10-2860></A> 
</DL>
<H3>Library</H3>
<dl><dd><pre>duim-sheets</pre></dl>
<H3>Module</H3>
<dl><dd><pre>duim-sheets</pre></dl>
<H3>Description</H3>
<P> Evaluates <I>body</I> with the clipboard grabbed, returning the results to the clipboard. </P>
<P> The macro grabs a lock on the clipboard, using <CODE>open-clipboard</CODE>, and then executes <I>body</I>. Once the results of evaluating <I>body</I> have been sent to the clipboard, the clipboard lock is freed using <A HREF="dref_319.htm#MARKER-9-1966"><CODE>close-clipboard</CODE></A>. The <I>clipboard</I> argument is a Dylan variable-name<SUB>bnf</SUB> used locally in the call to <CODE>with-clipboard</CODE>. The <I>sheet</I> argument is a Dylan variable-name<SUB>bnf</SUB> that evaluates to the sheet associated with <I>clipboard</I>.</P>
<P> This macro is the easiest way of manipulating the clipboard from DUIM, since it removes the need to create and destroy a clipboard lock yourself.</P>
<P> You can add more than one format of your data to the clipboard within the scope of this macro. So, for example, you could place an arbitrary object onto the clipboard, for use within your own application, and a string representation for other tools applications to see. </P>
<H3>See also</H3>
<P> <A HREF="dref_315.htm#MARKER-9-1957"><CODE>&lt;clipboard&gt;</CODE>,  page 235</A></P>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>Functional Developer Library Reference: DUIM - 3 Dec 1998</ADDRESS>
<P><A HREF="dref_517.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="dref_515.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="dref_287.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="dref_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="dref_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="dref_991.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
