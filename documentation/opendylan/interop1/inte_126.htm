<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<!-- Generated by Harlequin WebMaker 3.0.2 ( 8-May-1997) -->
<HEAD>
<LINK REL=TOP HREF="intero_1.htm">
<LINK REL=UP HREF="inte_113.htm">
<LINK REL=PREV HREF="inte_125.htm">
<LINK REL=NEXT HREF="inte_127.htm">
<TITLE>2.6   Error messages </TITLE>
<META NAME=GENERATOR CONTENT="Harlequin WebMaker 3.0.2 ( 8-May-1997)">
</HEAD>
<BODY BGCOLOR="#FEFEF2" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<DIV>
<A NAME=HEADING126></A>

<DIV>
<P><A HREF="inte_127.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_125.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_113.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_152.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>
<P>2 The Functional Developer Win32 API Libraries</P>

</DIV>
<A NAME=HEADING126-0></A>
<A NAME=UID-win32-889791></A>
<H1>2.6   <A NAME=MARKER-2-660></A><A NAME=MARKER-2-661></A>Error messages </H1>
<P>The Win32-Kernel library provides the following utility functions.</P>
<STRONG><A NAME=MARKER-2-662></A><A NAME=MARKER-2-663></A>win32-error-message</STRONG>
<P><I>Function</I></P>
<PRE>
win32-error-message <I>error-code</I> =&gt; <I>message</I> 
<P></P>
</PRE>
<P>The <I>error-code</I> is an instance of <CODE>&lt;integer&gt;</CODE> or <CODE>&lt;machine-word&gt;</CODE> (type unioned).</P>
<P>The <I>error-code</I> argument is either a Windows a Windows error code (such as returned by <CODE>GetLastError</CODE>) or an <CODE>SCODE</CODE> (also known as an <CODE>HRESULT</CODE>) value (such as returned by most OLE/COM functions). </P>
<P>The function returns a text message (in a string) corresponding to the error code, <CODE>#f</CODE> if the code is not recognized. The returned string might have more than one line but does not have a newline at the end. For example:</P>
<PRE>
win32-error-message(5) =&gt; &quot;Access is denied.&quot;
<P></P>
</PRE>
<STRONG><A NAME=MARKER-2-664></A><A NAME=MARKER-9-665></A>report-win32-error<A NAME=MARKER-2-666></A> </STRONG>
<P><I>Function</I></P>
<PRE>
report-win32-error <I>name</I> #key <I>error</I>
<P></P>
</PRE>
<DL>
<DT><DD>Signals a Dylan error if the Win 32 error code specified is not <CODE>NO_ERROR</CODE>. If no code is specified, the value returned by the Win32 API <CODE>GetLastError</CODE> is used. The error that is signaled includes both the error code and the error message, as computed by the function <CODE>win32-error-message</CODE>.
</DL>
<STRONG><A NAME=MARKER-2-667></A><A NAME=MARKER-2-668></A>check-win32-result</STRONG>
<P><I>Function</I></P>
<PRE>
check-win32-result <I>name</I> <I>result</I>
<P></P>
</PRE>
<DL>
<DT><DD>Many Windows functions return <CODE>#f</CODE> or <CODE>NULL</CODE> to mean failure. The function <CODE>check-win32-result</CODE> checks the result to see if it indicates failure, and if so it calls <A HREF="#MARKER-9-665"><CODE>report-win32-error</CODE></A>. For example,
</DL>
<PRE>
check-win32-result(&quot;SetWindowText&quot;, SetWindowText(handle, label))
<P></P>
</PRE>
<STRONG><A NAME=MARKER-2-669></A><A NAME=MARKER-2-670></A>ensure-no-win32-error</STRONG>
<P><I>Function</I></P>
<PRE>
ensure-no-win32-error <I>name</I>
<P></P>
</PRE>
<DL>
<DT><DD>Ensures that the Win32 API <CODE>GetLastError </CODE>does not indicate that an error occurred. If an occurs, it is signaled using <A HREF="#MARKER-9-665"><CODE>report-win32-error</CODE></A>.
</DL>

</DIV>

<DIV>

<DIV>

<!-- TOC -->

</DIV>

<HR>
<ADDRESS>C FFI and Win 32 Reference - 31 MAR 2000</ADDRESS>
<P><A HREF="inte_127.htm"><IMG ALIGN=BOTTOM SRC=next.gif ALT=Next BORDER=0></A> <A HREF="inte_125.htm"><IMG ALIGN=BOTTOM SRC=prev.gif ALT=Previous BORDER=0></A> <A HREF="inte_113.htm"><IMG ALIGN=BOTTOM SRC=up.gif ALT=Up BORDER=0></A> <A HREF="intero_1.htm"><IMG ALIGN=BOTTOM SRC=top.gif ALT=Top BORDER=0></A> <A HREF="intero_2.htm"><IMG ALIGN=BOTTOM SRC=content.gif ALT=Contents BORDER=0></A> <A HREF="inte_152.htm"><IMG ALIGN=BOTTOM SRC=index.gif ALT=Index BORDER=0></A></P>

</DIV>
</BODY>
</HTML>
