<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="top" href="drm_1.html" />
<link rel="up" href="drm_76.html" />
<link rel="prev" href="drm_79.html" />
<link rel="next" href="drm_81.html" />
<link title="main style sheet" rel="stylesheet" href="drm.css" type="text/css" />
<title>Rewrite Rules</title>
</head>
<body>

<div class="wm-div-body">
<a name="HEADING80"></a>

<div class="wm-div-headers">
<p class="header"><a href="drm_81.html" class="header"><img alt="next" src="next.gif" class="header" /></a> <a href="drm_79.html" class="header"><img alt="prev" src="prev.gif" class="header" /></a> <a href="drm_76.html" class="header"><img alt="up" src="up.gif" class="header" /></a> <a href="drm_1.html" class="header"><img alt="top" src="top.gif" class="header" /></a> <a href="drm_2.html" class="header"><img alt="content" src="content.gif" class="header" /></a> <a href="drm_127.html" class="header"><img alt="index" src="index.gif" class="header" /></a></p>
<p class="header">10 Macros</p>

</div>
<a name="HEADING80-0"></a>
<a name="UID-Macros-1609"></a>
<h1 class="H1.Heading1"> Rewrite Rules</h1>
<p class="T1.Text1"><a name="MARKER-2-1234"></a>The grammar of a macro definition is <code class="T1.Text1">define<i class="T1.Text1">  macro  macro-definition</i></code>. For details see <a href="drm_116.html#MARKER-9-2090" class="T1.Text1">Appendix A, "BNF."</a></p>
<p class="T1.Text1">If the optional <em class="T1.Text1">name</em> at the end of a <i class="Parameter T1.Text1">macro-definition</i> is present, it must be the same <em class="T1.Text1">name</em> that appears at the beginning of the <i class="Parameter T1.Text1">macro-definition</i>.</p>
<p class="T1.Text1">The kind of macro being defined, and thus the Dylan grammar production that this macro extends, is determined by which kind of rules appear in the macro's <i class="Parameter T1.Text1">main-rule-set</i>. </p>
<p class="T1.Text1">The <em class="T1.Text1">name<i class="T1.Text1"> </i></em> preceding the <i class="Parameter T1.Text1">main-rule-set</i> is the name of the binding whose value is this macro. It must be consistent with each left-hand side of the <i class="Parameter T1.Text1">main-rule-set</i>. It can be any name, even a reserved word or backslash followed by an operator. For statement and function macros this <em class="T1.Text1">name<i class="T1.Text1"> </i></em> must be the same as the <em class="T1.Text1">name<i class="T1.Text1"> </i></em> that appears as the first token in each <i class="Parameter T1.Text1">main-rule-set</i> pattern. For definition macros this <em class="T1.Text1">name<i class="T1.Text1"> </i></em> must be the same as the <em class="T1.Text1">name<i class="T1.Text1"> </i></em> in the <i class="Parameter T1.Text1">xxx-style-definition-rule</i>  with the suffix "<code class="cv T1.Text1">-definer</code>" added.</p>
<p class="T1.Text1">A <em class="T1.Text1">name</em> can belong to more than one of the lexical categories <em class="T1.Text1">begin-word</em>, <em class="T1.Text1">function-word</em>, <em class="T1.Text1">define-body-word</em>, and <em class="T1.Text1">define-list-word</em>. A <em class="T1.Text1">name<i class="T1.Text1"> </i></em> cannot belong to both <em class="T1.Text1">begin-word </em>and <em class="T1.Text1">function-word</em>. A <em class="T1.Text1">name<i class="T1.Text1"> </i></em> cannot belong to both <em class="T1.Text1">define-body-word</em> and <em class="T1.Text1">define-list-word</em>.</p>
<p class="T1.Text1">For simplicity of documentation, the <i class="Parameter T1.Text1">xxx-style-definition-rule</i> productions are written ambiguously. The <em class="T1.Text1">name<i class="T1.Text1">  </i></em>in the left-hand side of the rule must be the <em class="T1.Text1">name</em> immediately following <code class="cv T1.Text1">define macro</code> with the "<code class="cv T1.Text1">-definer</code>" suffix removed, not an arbitrary <em class="T1.Text1">name</em>, which would be ambiguous with <i class="Parameter T1.Text1">modifier</i>.</p>
<p class="T1.Text1">The general idea is that the <i class="Parameter T1.Text1">main-rule-set</i> is an ordered sequence of rewrite rules. Macro expansion tests the macro call against each left-hand side in turn until one matches. The corresponding right-hand side supplies the new construct to replace the macro call. The left- and right-hand sides can contain pattern variables. The portion of the macro call that matches a particular pattern variable on the left replaces each occurrence of that pattern variable on the right. It is an error for the right-hand side of a rule to contain a pattern variable that does not appear on the left-hand side of the same rule.</p>
<p class="T1.Text1">If none of the left-hand sides match, the macro call is invalid. If more than one left-hand side matches, the first matching rule is used. Note that (as described in the next section) a pattern variable with a <a name="MARKER-2-1235"></a>wildcard constraint can match an empty portion of the macro call. A comma or a semicolon followed by a pattern variable with a wildcard constraint also can match an empty portion of the macro call. Do not assume that only an empty pattern can match an empty input. In general when writing recursive rewrite rules it is better to put the base case first, before the inductive cases, in case an inductive case rewrite rule might match a base case input.</p>
<p class="T1.Text1">The punctuation marks <code class="cv T1.Text1">?,</code> <code class="cv T1.Text1">??, </code>and <code class="cv T1.Text1">?=</code> used in patterns and templates are customarily written without any whitespace following them.<a name="MARKER-2-1236"></a></p>

</div>

<div class="wm-div-footers">

<div class="wm-div-toc">



</div>

<hr class="footer" />
<address class="footer">The Dylan Reference Manual - 7 Apr 1998</address>
<p class="footer"><a href="drm_81.html" class="header"><img alt="next" src="next.gif" class="header" /></a> <a href="drm_79.html" class="header"><img alt="prev" src="prev.gif" class="header" /></a> <a href="drm_76.html" class="header"><img alt="up" src="up.gif" class="header" /></a> <a href="drm_1.html" class="header"><img alt="top" src="top.gif" class="header" /></a> <a href="drm_2.html" class="header"><img alt="content" src="content.gif" class="header" /></a> <a href="drm_127.html" class="header"><img alt="index" src="index.gif" class="header" /></a></p>
<p class="footer">Copyright Apple Computer, Inc. 1996. Apple&#174; and the Apple logo are registered trademarks of Apple Computer, Inc. Used with permission. All Rights Reserved.</p>
<p class="footer">Generated with <a href="http://www.harlequin.com/webmaker" class="footer">Harlequin WebMaker&#174;</a></p>

</div>
</body>
</html>
