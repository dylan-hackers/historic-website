<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
  <head>
    
    <!-- Relative Navigation -->
    
    <link rel="up" href="Macros" />
    <link rel="prev" href="Patterns" />
    <link rel="next" href="Templates" />
    
    <!-- Absolute Navigation -->
    
    <link rel="top" href="Title" />
    <link rel="start first" href="." />
    <link rel="copyright" href="Copyrights" />
    <link rel="contents" href="Contents" />
    <link rel="glossary" href="Glossary" />
    <link rel="index" href="Index" />
    <link rel="last author" href="Colophon" />
    
    <!-- Chapters -->
    
    <link rel="chapter" title="About This Book" href="Preface" />
    <link rel="chapter" title="1 Introduction" href="Introduction" />
    <link rel="chapter" title="2 Syntax" href="Syntax" />
    <link rel="chapter" title="3 Program Structure" href="Program_Structure" />
    <link rel="chapter" title="4 Program Control" href="Program_Control" />
    <link rel="chapter" title="5 Types and Classes" href="Types_and_Classes" />
    <link rel="chapter" title="6 Functions" href="Functions" />
    <link rel="chapter" title="7 Conditions" href="Conditions" />
    <link rel="chapter" title="8 Collections" href="Collections" />
    <link rel="chapter" title="9 Sealing" href="Sealing" />
    <link rel="chapter" title="10 Macros" href="Macros" />
    <link rel="chapter" title="11 The Built-In Classes" href="Built-In_Classes" />
    <link rel="chapter" title="12 The Built-In Functions" href="Built-In_Functions" />
    <link rel="chapter" title="13 Other Built-In Objects" href="Other_Built-In_Objects" />
    <link rel="chapter" title="14 The Built-In Macros and Special Definitions" href="Built-In_Macros_and_Special_Definitions" />
    
    <!-- Appendices -->
    
    <link rel="appendix" title="A BNF" href="BNF" />
    <link rel="appendix" title="B Exported Names" href="Exported_Names" />
    
    <!-- Stylesheet -->
    
    <link rel="stylesheet" href="drm.css" type="text/css" />

    <title>Pattern Variable Constraints &mdash; 10. Macros &mdash; The DRM</title>
  </head>
  <body>

    <div id="header">
      <div id="navigation-header">
	<p id="book-title">The Dylan Reference Manual</p>
	<p id="basic-navigation"><a class="previous" title="Go to previous page" href="Patterns"><img alt="Previous" src="images/prev.gif" /></a> <a class="next" title="Go to next page" href="Templates"><img alt="Next" src="images/next.gif" /></a> <a class="up" title="Go to start of chapter" href="Macros"><img alt="Up" src="images/up.gif" /></a> <a class="start" title="Go to start of book" href="Title"><img alt="Top" src="images/top.gif" /></a> <a class="contents" title="Go to table of contents" href="Contents"><img alt="Contents" src="images/content.gif" /></a> <a class="index" title="Go to index" href="Index"><img alt="index" src="images/index.gif" /></a></p>
      </div>

      <div id="section-header">
	<p id="section-prefix">Chapter 10</p>
	<p id="section-name">Macros</p>
      </div>

      <div id="navigation-TOC">
	<ul class="front-matter">
	  <li><a href="Title">Start</a></li>
	  <li><a href="Contents">Contents</a></li>
	  <li><a href="Preface">About This Book</a></li>
	</ul>
	<ol class="chapters">
	  <li><a href="Introduction">Introduction</a></li>
	  <li><a href="Syntax">Syntax</a></li>
	  <li><a href="Program_Structure">Program Structure</a></li>
	  <li><a href="Program_Control">Program Control</a></li>
	  <li><a href="Types_and_Classes">Types and Classes</a></li>
	  <li><a href="Functions">Functions</a></li>
	  <li><a href="Conditions">Conditions</a></li>
	  <li><a href="Collections">Collections</a></li>
	  <li><a href="Sealing">Sealing</a></li>
	  <li><a href="Macros">Macros</a>
	    <ul>
	      <li><a href="Macros_Overview">Overview</a></li>
	      <li><a href="Extensible_Grammar">Extensible Grammar</a></li>
	      <li><a href="Macro_Names">Macro Names</a></li>
	      <li><a href="Rewrite_Rules">Rewrite Rules</a></li>
	      <li><a href="Patterns">Patterns</a></li>
	      <li id="current">Pattern Variable Constraints
		<ul>
		  <li><a href="#HEADING82-144">Intermediate Words</a></li>
		</ul>
	      </li>
	      <li><a href="Templates">Templates</a></li>
	      <li><a href="Auxiliary_Rule_Sets">Auxiliary Rule Sets</a></li>
	      <li><a href="Hygiene">Hygiene</a></li>
	      <li><a href="Rewrite_Rule_Examples">Rewrite Rule Examples</a></li>
	    </ul>
	  </li>
	  <li><a href="Built-In_Classes">The Built-In Classes</a></li>
	  <li><a href="Built-In_Functions">The Built-In Functions</a></li>
	  <li><a href="Other_Built-In_Objects">Other Built-In Objects</a></li>
	  <li><a href="Built-In_Macros_and_Special_Definitions">The Built-In Macros and Special Definitions</a></li>
	</ol>
	<ol class="appendices">
	  <li><a href="BNF">BNF</a></li>
	  <li><a href="Exported_Names">Exported Names</a></li>
	</ol>
	<ul class="back-matter">
	  <li><a href="Glossary">Glossary</a></li>
	  <li><a href="Index">Index</a></li>
	  <li><a href="Colophon">Colophon</a></li>
	</ul>
	<ul class="errata">
	  <li><a href="Errata">Errata</a></li>
	</ul>
      </div>

      <hr />

    </div>

    <div id="content">
      <a name="HEADING82-0"></a>
      <a name="UID-Macros-6305"></a>
      <h1 class="section-title"><a name="MARKER-9-1256"></a>Pattern Variable Constraints</h1>
      <p class="T1.Text1"><a name="MARKER-2-1257"></a>Each <var>pattern-variable</var> in the
      left-hand side of a rule in a macro definition has a constraint associated with it. This
      prevents the pattern from matching unless the fragment matched to the pattern-variable
      satisfies the constraint. In most cases it also controls how the matching fragment is
      parsed.</p>
      <p class="T1.Text1">You specify a constraint in a <var>pattern-variable</var> by suffixing a
      colon and the constraint name to the pattern variable name. Intervening whitespace is not
      allowed. As an abbreviation, if a pattern variable has the same name as its constraint,
      the <var>pattern-variable</var> can be written <code>?:<var>the-name</var></code> instead
      of <code>?<var>the-name</var>:<var>the-name</var></code>.</p>
      <p class="T1.Text1">The available constraints are listed in <a href="#MARKER-9-1173">Table 10-1</a>.</p>
      <table class="numbered">
	<caption><strong>Table 10-1</strong>  <a name="MARKER-9-1173"></a>Available constraints</caption>
	<tr>
	  <th><p>Constraint name</p></th>
	  <th><p>Grammar accepted</p></th>
	  <th><p>Binds pattern variable to</p></th>
	</tr>
	<tr>
	  <td><p><code>expression</code></p></td>
	  <td><p><span class="BNF"><var>expression</var></span></p></td>
	  <td><p>parsed expression fragment(1)</p>
	</td></tr>
	<tr>
	  <td><p><code>variable</code></p></td>
	  <td><p><span class="BNF"><var>variable</var></span></p></td>
	  <td><p>fragment(2)</p>
	</td></tr>
	<tr>
	  <td><p><code>name</code></p></td>
	  <td><p><span class="BNF"><em class="BNFCaps">name</em></span></p></td>
	  <td><p>one-token fragment</p>
	</td></tr>
	<tr>
	  <td><p><code>token</code></p></td>
	  <td><p><span class="BNF"><em class="BNFCaps">token</em></span></p></td>
	  <td><p>one-token fragment</p>
	</td></tr>
	<tr>
	  <td><p><code>body</code></p></td>
	  <td><p><span class="BNF"><var>body<em><sub>opt</sub></em></var></span> (3)</p></td>
	  <td><p>parsed expression fragment (4)</p>
	</td></tr>
	<tr>
	  <td><p><code>case-body</code></p></td>
	  <td><p><span class="BNF"><var>case-body<em><sub>opt</sub></em></var></span> (3)</p></td>
	  <td><p>fragment(2)</p>
	</td></tr>
	<tr>
	  <td><p><code>macro</code></p></td>
	  <td><p><span class="BNF"><var>macro</var></span></p></td>
	  <td><p>fragment(5)</p>
	</td></tr>
	<tr>
	  <td><p><code>*</code></p></td>
	  <td><p>(wildcard)</p></td>
	  <td><p>fragment</p></td>
	</tr>
      </table>
      <p class="T1.Text1">Notes:</p>
      <ol>
	<li>Parsed expression fragments are described on <a href="Macros_Overview#MARKER-9-1199">page
	146</a>.</li>
	<li>Where <var>expression</var>, <var>operand</var>, <var>constituents</var>
	or <var>body</var> appears in the grammar that this constraint accepts, the bound fragment
	contains a parsed expression fragment, not the original elementary fragments.</li>
	<li>Parsing stops at an intermediate word.</li>
	<li>The body is wrapped in <code>begin &hellip; end</code> to make it an expression, using
	the standard binding of <code>begin</code> in the Dylan module. An empty body defaults
	to <code>#f</code>.</li>
	<li>A pattern-variable with a <code>macro</code> constraint accepts exactly one elementary
	fragment, which must be a macro call fragment. It binds the pattern variable to the
	expansion of the macro.</li>
      </ol>
      <p class="T1.Text1">Some implementations and a future version of the Dylan language
      specification might add more constraint choices to this table.</p>
      <p class="T1.Text1">When a pattern variable has the same name as an auxiliary rule-set, its
      constraint defaults to <a name="MARKER-2-1258"></a>wildcard and can be omitted. Otherwise a
      constraint must be specified in every <var>pattern-variable</var>
      and <var>pattern-keyword</var>.</p>
      <p class="T1.Text1">A constraint applies only to the specific pattern variable occurrence to
      which it is attached. It does not constrain other pattern variable occurrences with the same
      name.</p>
      <a name="HEADING82-144"></a>
      <a name="UID-Macros-5860"></a>
      <h2 class="subsection-title">Intermediate Words</h2>
      <p class="T1.Text1"><a name="MARKER-2-1259"></a>When a <var>pattern-variable </var> has a
      constraint of <code>body</code> or <code>case-body</code>, its parsing of the fragment stops
      before any token that is an intermediate word. This allows intermediate words to delimit
      clauses that have separate bodies, like <code>else</code> and <code>elseif</code> in
      an <code>if</code> statement. The intermediate words of a macro are identified as follows:</p>
      <ul>
	<li>Define a body-variable to be a pattern variable that either has a constraint
	of <code>body</code> or <code>case-body</code>, or names an auxiliary rule-set where some
	left-hand side in that rule-set ends in a body-variable. This is a least fixed
	point<var>, </var> so a recursive auxiliary rule-set does not automatically make its name
	into a body-variable.  Note that an ellipsis that stands for a pattern variable is a
	body-variable when that pattern variable is one.
	</li>
	<li>Define an intermediate-variable to be a pattern variable that either immediately follows
	a body-variable in a left-hand side, or appears at the beginning of a left-hand side in an
	auxiliary rule-set named by an intermediate-variable.
	</li>
	<li>An intermediate word is a <em class="BNFCaps">name</em> that either immediately follows
	a body-variable in a left-hand side, or occurs at the beginning of a left-hand side in an
	auxiliary rule-set named by an intermediate-variable. Intermediate words are not reserved,
	they are just used as delimiters during the parsing for a <var>pattern-variable</var> with
	a <code>body</code> or <code>case-body</code>
	constraint.<a name="MARKER-2-1260"></a><a name="MARKER-2-1261"></a>
	</li>
      </ul>

    </div>

    <div id="footer">

      <hr class="footer" />
      <address class="footer">The Dylan Reference Manual - 7 Apr 1998</address>
      <p class="footer"><a class="previous" title="Go to previous page" href="Patterns"><img alt="Previous" src="images/prev.gif" /></a> <a class="next" title="Go to next page" href="Templates"><img alt="Next" src="images/next.gif" /></a> <a class="up" title="Go to start of chapter" href="Macros"><img alt="Up" src="images/up.gif" /></a> <a class="start" title="Go to start of book" href="Title"><img alt="Top" src="images/top.gif" /></a> <a class="contents" title="Go to table of contents" href="Contents"><img alt="Contents" src="images/content.gif" /></a> <a class="index" title="Go to index" href="Index"><img alt="index" src="images/index.gif" /></a></p>
      <p class="footer">Copyright Apple Computer, Inc. 1996. Apple&reg; and the Apple logo are
      registered trademarks of Apple Computer, Inc. Used with permission. All Rights Reserved.</p>
      <p class="footer">Originally generated
      with <a href="http://www.harlequin.com/webmaker">Harlequin WebMaker&reg;</a>, subsequently
      revised.</p>

    </div>
  </body>
</html>
