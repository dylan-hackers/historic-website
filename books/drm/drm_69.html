<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="top" href="drm_1.html" />
<link rel="up" href="drm_59.html" />
<link rel="prev" href="drm_68.html" />
<link rel="next" href="drm_70.html" />
<link title="main style sheet" rel="stylesheet" href="drm.css" type="text/css" />
<title>Limited Collection Types</title>
</head>
<body>

<div class="wm-div-body">
<a name="HEADING69"></a>

<div class="wm-div-headers">
<p class="header"><a href="drm_70.html" class="header"><img alt="next" src="next.gif" class="header" /></a> <a href="drm_68.html" class="header"><img alt="prev" src="prev.gif" class="header" /></a> <a href="drm_59.html" class="header"><img alt="up" src="up.gif" class="header" /></a> <a href="drm_1.html" class="header"><img alt="top" src="top.gif" class="header" /></a> <a href="drm_2.html" class="header"><img alt="content" src="content.gif" class="header" /></a> <a href="drm_127.html" class="header"><img alt="index" src="index.gif" class="header" /></a></p>
<p class="header">8 Collections</p>

</div>
<a name="HEADING69-0"></a>
<a name="UID-Collections-3802"></a>
<h1 class="H1.Heading1"> <a name="MARKER-9-1060"></a>Limited Collection Types</h1>
<p class="T0.Text0"><a name="MARKER-2-1061"></a>Limited collections are subtypes of <code class="cv T0.Text0">&lt;collection&gt;</code> that are constrained to have a particular size or dimensions and that are constrained to hold elements of a particular type.</p>
<p class="T1.Text1">If <i class="Parameter T1.Text1">C</i> is a subclass of <code class="cv T1.Text1">&lt;collection&gt;</code> whose element type is indefinite <code class="cv T1.Text1">&lt;</code> <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">1</em></i>, then it is possible to create any number of limited collection types that can be described as <code class="cv T1.Text1">limited(<i class="Parameter cv T1.Text1">C, of: T<em class="Subscript Parameter cv T1.Text1">2, size: S)</em></i></code>.</p>
<p class="T1.Text1">Like a collection class, a limited collection type has a conceptual element type. The element type of <code class="cv T1.Text1">limited(<i class="Parameter cv T1.Text1">C, of: T<em class="Subscript Parameter cv T1.Text1">2, size: S)</em></i></code> is <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">2</em></i>. <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">2</em></i> must be an instance of <code class="cv T1.Text1">&lt;type&gt;</code> and a subtype of <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">1</em></i>. <i class="Parameter T1.Text1">C</i> is the base class of the new limited collection type.</p>
<p class="T1.Text1"><i class="Parameter T1.Text1">S</i> limits the size of instances of a limited collection type. <i class="Parameter T1.Text1">S</i> can be <code class="cv T1.Text1">#f</code>, which means no limitation, or a non-negative integer, which means that every instance of the limited collection type has exactly that many elements.</p>
<p class="T1.Text1"><i class="Parameter T1.Text1">S</i> must be <code class="cv T1.Text1">#f</code> if <i class="Parameter T1.Text1">C</i> is stretchy (e.g. <code class="cv T1.Text1">&lt;table&gt;</code>, <code class="cv T1.Text1">&lt;stretchy-vector&gt;</code>, or <code class="cv T1.Text1">&lt;deque&gt;</code>).</p>
<p class="T1.Text1">If <i class="Parameter T1.Text1">C</i> is <code class="cv T1.Text1">&lt;array&gt;</code> then it is also possible to create any number of limited collection types, which can be described as <code class="cv T1.Text1">limited(&lt;array&gt;, of: <i class="Parameter cv T1.Text1">T, dimensions: D)</i></code>. <i class="Parameter T1.Text1">D</i> must be a sequence of non-negative integers; the rank of each instance is <code class="cv T1.Text1">size(<i class="Parameter cv T1.Text1">D)</i></code> and the dimensions of each instance are the elements of <i class="Parameter T1.Text1">D</i>. You cannot specify both <code class="cv T1.Text1">size:</code> and <code class="cv T1.Text1">dimensions:</code> in the same type.</p>
<p class="T1.Text1">Some limited collection types are instantiable. <code class="cv T1.Text1">make(limited(<i class="Parameter cv T1.Text1">C, </i></code>...<code class="cv T1.Text1">), </code>...<code class="cv T1.Text1">)</code> returns a direct instance of some subclass of <i class="Parameter T1.Text1">C</i>. Typically this class is not standardized and its name is not exported, but it is valid for this class to be <i class="Parameter T1.Text1">C</i> itself. There is nothing special about this class; it is simply a class known to the applicable <code class="cv T1.Text1">limited</code> method and its creation is subject to all the usual sealing restrictions.</p>
<p class="T1.Text1"><a name="MARKER-2-1062"></a>An object <i class="Parameter T1.Text1">X</i> is an instance of a limited collection type <code class="cv T1.Text1">limited(<i class="Parameter cv T1.Text1">C, of:</i></code> <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">2</em></i>, <code class="cv T1.Text1">size: <i class="Parameter cv T1.Text1">S)</i></code> if and only if all of the following are true:</p>
<ul class="B1.Bullet1">
<li class="B1.Bullet1"><code class="cv B1.Bullet1">object-class(<i class="Parameter cv B1.Bullet1">X)</i></code> is a subclass of <i class="Parameter B1.Bullet1">C</i>.</li>
<li class="B1.Bullet1"><i class="Parameter B1.Bullet1">X</i>'s size matches <i class="Parameter B1.Bullet1">S</i>, as described above.</li>
<li class="B1.Bullet1">If <i class="Parameter B1.Bullet1">X</i> is an instance of <code class="cv B1.Bullet1">&lt;stretchy-collection&gt;</code> then <i class="Parameter B1.Bullet1">S</i> must be <code class="cv B1.Bullet1">#f</code>.</li>
<li class="B1.Bullet1">The element type of <i class="Parameter B1.Bullet1">X</i> is equivalent to <i class="Parameter B1.Bullet1">T<em class="Subscript Parameter B1.Bullet1">2</em></i>.
<p class="T1.Text1">An object <i class="Parameter T1.Text1">X</i> is an instance of a type <code class="cv T1.Text1">limited(<i class="Parameter cv T1.Text1">C, of: T<em class="Subscript Parameter cv T1.Text1">2, dimensions: D)</em></i></code> if and only if all of the following are true:</p></li>
<li class="B1.Bullet1"><code class="cv B1.Bullet1">object-class(<i class="Parameter cv B1.Bullet1">X)</i></code> is a subclass of <i class="Parameter B1.Bullet1">C</i>.</li>
<li class="B1.Bullet1"><code class="cv B1.Bullet1">dimensions(<i class="Parameter cv B1.Bullet1">X)</i></code> <code class="cv B1.Bullet1">=</code> <i class="Parameter B1.Bullet1">D</i>.</li>
<li class="B1.Bullet1"><i class="Parameter B1.Bullet1">X</i> is not an instance of <code class="cv B1.Bullet1">&lt;stretchy-collection&gt;</code>.</li>
<li class="B1.Bullet1">The element type of <i class="Parameter B1.Bullet1">X</i> is equivalent to <i class="Parameter B1.Bullet1">T<em class="Subscript Parameter B1.Bullet1">2</em></i>.<a name="MARKER-2-1063"></a>
<p class="T1.Text1">Each element of an instance of a limited collection type must be an instance of the element type. Fetching an element of the collection is guaranteed to return an instance of the element type. Setting or initializing an element will check that the new element is an instance of the element type and signal an error of type <code class="cv T1.Text1">&lt;type-error&gt;</code> if it is not.</p>
<p class="T1.Text1"><a name="MARKER-2-1064"></a>If <i class="Parameter T1.Text1">L<em class="Subscript Parameter T1.Text1">1</em></i> is a subtype of <i class="Parameter T1.Text1">L<em class="Subscript Parameter T1.Text1">2</em></i> and <i class="Parameter T1.Text1">L<em class="Subscript Parameter T1.Text1">2</em></i> is a limited collection type, then <i class="Parameter T1.Text1">L<em class="Subscript Parameter T1.Text1">1</em></i> is either a singleton of an instance of <i class="Parameter T1.Text1">L<em class="Subscript Parameter T1.Text1">2</em></i> or a limited collection type that satisfies one of the following sets of rules:</p>
<p class="N.NList">If neither <i class="Parameter N.NList">L<em class="Subscript Parameter N.NList">1</em></i> nor <i class="Parameter N.NList">L<em class="Subscript Parameter N.NList">2</em></i> specifies a <code class="cv N.NList">dimensions:</code> attribute, let <i class="Parameter N.NList">L<em class="Subscript Parameter N.NList">1</em></i> be <code class="cv N.NList">limited(<i class="Parameter cv N.NList">C<em class="Subscript Parameter cv N.NList">1, of: T1, size: S1)</em></i></code>, and <i class="Parameter N.NList">L<em class="Subscript Parameter N.NList">2</em></i> be <code class="cv N.NList">limited(<i class="Parameter cv N.NList">C<em class="Subscript Parameter cv N.NList">2, of: T2, size: S2)</em></i></code>. All of the following must be true:</p></li>
<li><ul class="B2.Bullet2">
<li class="B2.Bullet2"><i class="Parameter B2.Bullet2">C<em class="Subscript Parameter B2.Bullet2">1</em></i> is a subclass of <i class="Parameter B2.Bullet2">C<em class="Subscript Parameter B2.Bullet2">2</em></i>.</li>
<li class="B2.Bullet2">If <i class="Parameter B2.Bullet2">S<em class="Subscript Parameter B2.Bullet2">2</em></i> is not #<code class="cv B2.Bullet2">f</code>, <i class="Parameter B2.Bullet2">S<em class="Subscript Parameter B2.Bullet2">1</em></i> = <i class="Parameter B2.Bullet2">S<em class="Subscript Parameter B2.Bullet2">2</em></i>.</li>
<li class="B2.Bullet2"><i class="Parameter B2.Bullet2">T<em class="Subscript Parameter B2.Bullet2">1</em></i> and <i class="Parameter B2.Bullet2">T<em class="Subscript Parameter B2.Bullet2">2</em></i> are equivalent types.
<p class="N.NList">If either <i class="Parameter N.NList">L<em class="Subscript Parameter N.NList">1</em></i> or <i class="Parameter N.NList">L<em class="Subscript Parameter N.NList">2</em></i>, specifies a <code class="cv N.NList">dimensions:</code> attribute, then all of the following must be true. Let <i class="Parameter N.NList">L<em class="Subscript Parameter N.NList">1</em></i> be <code class="cv N.NList">limited(<i class="Parameter cv N.NList">C<em class="Subscript Parameter cv N.NList">1, of: T1, dimensions: D1)</em></i></code>, and <i class="Parameter N.NList">L<em class="Subscript Parameter N.NList">2</em></i> be either <code class="cv N.NList">limited(<i class="Parameter cv N.NList">C<em class="Subscript Parameter cv N.NList">2, of: T2, dimensions: D2</em></i></code>) or <code class="cv N.NList">limited(<i class="Parameter cv N.NList">C<em class="Subscript Parameter cv N.NList">2, of: T2, size: S2)</em></i></code>.</p></li>
<li class="B2.Bullet2"><i class="Parameter B2.Bullet2">C<em class="Subscript Parameter B2.Bullet2">1</em></i> is a subclass of <i class="Parameter B2.Bullet2">C<em class="Subscript Parameter B2.Bullet2">2</em></i>.</li>
<li class="B2.Bullet2"><i class="Parameter B2.Bullet2">D<em class="Subscript Parameter B2.Bullet2">1</em></i> is present (i.e. <i class="Parameter B2.Bullet2">L<em class="Subscript Parameter B2.Bullet2">1</em></i> must specify a dimensions attribute).</li>
<li class="B2.Bullet2">If <i class="Parameter B2.Bullet2">D<em class="Subscript Parameter B2.Bullet2">2</em></i> is present, <i class="Parameter B2.Bullet2">D<em class="Subscript Parameter B2.Bullet2">1</em></i> <code class="cv B2.Bullet2">=</code> <i class="Parameter B2.Bullet2">D<em class="Subscript Parameter B2.Bullet2">2</em></i>.</li>
<li class="B2.Bullet2">If <i class="Parameter B2.Bullet2">S<em class="Subscript Parameter B2.Bullet2">2</em></i> is not <code class="cv B2.Bullet2">#f</code>, <code class="cv B2.Bullet2">reduce1(\*, <i class="Parameter cv B2.Bullet2">D<em class="Subscript Parameter cv B2.Bullet2">1) = S2</em></i></code>.</li>
<li class="B2.Bullet2"><i class="Parameter B2.Bullet2">T<em class="Subscript Parameter B2.Bullet2">1</em></i> and <i class="Parameter B2.Bullet2">T<em class="Subscript Parameter B2.Bullet2">2</em></i> are equivalent types.
<p class="T1.Text1">The limited collection type <code class="cv T1.Text1">limited(<i class="Parameter cv T1.Text1">C, of: T, size: S)</i></code> is a subtype of <i class="Parameter T1.Text1">C</i>. The limited collection type <code class="cv T1.Text1">limited(<i class="Parameter cv T1.Text1">C, of: T, dimensions: D)</i></code> is a subtype of <i class="Parameter T1.Text1">C</i>.<a name="MARKER-2-1065"></a></p></li>
</ul></li>
</ul>
<a name="HEADING69-31"></a>
<h3 class="H3.Heading3"> Element Type Subclassing</h3>
<p class="T1.Text1"><a name="MARKER-2-1066"></a>The element type subclassing rules are generalized to limited collection types as follows (this is implied by the preceding and is included here for explanatory purposes only):</p>
<p class="T1.Text1">If the element type of a limited collection type <i class="Parameter T1.Text1">L<em class="Subscript Parameter T1.Text1">1</em></i> is <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">1</em></i>, each instance of <i class="Parameter T1.Text1">L<em class="Subscript Parameter T1.Text1">1</em></i> stores elements of type <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">1</em></i>. The <code class="cv T1.Text1">element</code> method will always return an instance of <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">1</em></i> and the <code class="cv T1.Text1">element-setter</code> method will accept any instance of <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">1</em></i>. Each limited collection type that is a subtype of <i class="Parameter T1.Text1">L<em class="Subscript Parameter T1.Text1">1</em></i> must have an element type <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">2</em></i> that is equivalent to <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">1</em></i>.</p>
<p class="T1.Text1">If the element type of a class <i class="Parameter T1.Text1">C<em class="Subscript Parameter T1.Text1">1</em></i> is indefinite <code class="cv T1.Text1">&lt;</code> <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">1</em></i>,  each limited collection type that is a subtype of <i class="Parameter T1.Text1">C<em class="Subscript Parameter T1.Text1">1</em></i> has an element type <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">2</em></i> and <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">2</em></i> must be a subtype of <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">1</em></i>. Thus <code class="cv T1.Text1">element</code> on any instance of <i class="Parameter T1.Text1">C<em class="Subscript Parameter T1.Text1">1</em></i> will return an instance of <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">1</em></i> (and will not return all possible instances of <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">1</em></i> if <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">2</em></i> is a proper subtype of <i class="Parameter T1.Text1">T<em class="Subscript Parameter T1.Text1">1</em></i>), and it is not determined by <i class="Parameter T1.Text1">C<em class="Subscript Parameter T1.Text1">1</em></i> what the applicable <code class="cv T1.Text1">element-setter</code> method will accept (hence the term "indefinite").</p>
<p class="T1.Text1">The above statements about the value returned by <code class="cv T1.Text1">element</code> only apply when no <code class="cv T1.Text1">default:</code> keyword argument is specified.<a name="MARKER-2-1067"></a></p>
<a name="HEADING69-36"></a>
<a name="UID-Collections-3838"></a>
<h2 class="H2.Heading2"> Creating Limited Collection Types</h2>
<p class="T1.Text1"><a name="MARKER-2-1068"></a>You obtain a type object for a limited collection type by calling the <code class="cv T1.Text1">limited</code> generic function on a collection class. There are several built-in methods for <code class="cv T1.Text1">limited</code> specialized for specific subclasses of <code class="cv T1.Text1">&lt;collection&gt;</code>. Each of these methods accepts a required keyword argument <code class="cv T1.Text1">of:</code> and also accepts an optional keyword argument <code class="cv T1.Text1">size:</code> if the class is not stretchy. If the class is <code class="cv T1.Text1">&lt;array&gt;</code> the optional keyword argument <code class="cv T1.Text1">dimensions:</code> is also accepted. Each method returns a type. The returned type  is never a class. If the <code class="cv T1.Text1">size:</code> keyword argument is accepted but not supplied, it defaults to <code class="cv T1.Text1">#f</code>.</p>
<p class="T1.Text1">Users cannot write portable methods for <code class="cv T1.Text1">limited</code>. There are no built-in methods for <code class="cv T1.Text1">limited</code> applicable to user-defined classes.</p>
<a name="HEADING69-39"></a>
<h3 class="H3.Heading3"> Uninstantiable Limited Collection Types</h3>
<p class="T1.Text1"><a name="MARKER-2-1069"></a>Methods on <code class="cv T1.Text1">limited</code> support the creation of uninstantiable limited types for the following classes:</p>
<ul class="B1.Bullet1">
<li class="B1.Bullet1"><code class="B1.Bullet1">&lt;collection&gt;</code></li>
<li class="B1.Bullet1"><code class="B1.Bullet1">&lt;explicit-key-collection&gt;</code></li>
<li class="B1.Bullet1"><code class="B1.Bullet1">&lt;mutable-collection&gt;</code></li>
<li class="B1.Bullet1"><code class="B1.Bullet1">&lt;stretchy-collection&gt;</code></li>
<li class="B1.Bullet1"><code class="B1.Bullet1">&lt;mutable-explicit-key-collection&gt;</code></li>
<li class="B1.Bullet1"><code class="B1.Bullet1">&lt;sequence&gt;</code></li>
<li class="B1.Bullet1"><code class="B1.Bullet1">&lt;mutable-sequence&gt;</code>
<p class="T1.Text1">Although limited types created from these classes cannot be instantiated, they are still useful as specializers.<a name="MARKER-2-1070"></a></p></li>
</ul>
<a name="HEADING69-49"></a>
<h3 class="H3.Heading3"> Instantiable Limited Collection Types</h3>
<p class="T1.Text1"><a name="MARKER-2-1071"></a>Methods on <code class="cv T1.Text1">limited</code> support the creation of instantiable limited types for the following classes:</p>
<ul class="B1.Bullet1">
<li class="B1.Bullet1"><code class="B1.Bullet1">&lt;table&gt;</code></li>
<li class="B1.Bullet1"><code class="B1.Bullet1">&lt;object-table&gt;</code></li>
<li class="B1.Bullet1"><code class="B1.Bullet1">&lt;array&gt;</code></li>
<li class="B1.Bullet1"><code class="B1.Bullet1">&lt;vector&gt;</code></li>
<li class="B1.Bullet1"><code class="B1.Bullet1">&lt;simple-vector&gt;</code></li>
<li class="B1.Bullet1"><code class="B1.Bullet1">&lt;stretchy-vector&gt;</code></li>
<li class="B1.Bullet1"><code class="B1.Bullet1">&lt;string&gt;</code></li>
<li class="B1.Bullet1"><code class="B1.Bullet1">&lt;range&gt;</code>
<p class="T1.Text1">These methods are described in <a href="drm_96.html#MARKER-9-1527" class="T1.Text1">Chapter 12, "The Built-In Functions,"</a> on <a href="drm_98.html#MARKER-9-1559" class="T1.Text1">page 263</a>.<a name="MARKER-2-1072"></a><a name="MARKER-2-1073"></a><a name="MARKER-2-1074"></a></p>
<a name="LINK-Collections-lastpage"></a><a name="LINK-SealingTOC-firstpage"></a></li>
</ul>
<a name="UID-SealingTOC-411"></a>
<a name="LINK-SealingTOC-lastpage"></a>
</div>

<div class="wm-div-footers">

<div class="wm-div-toc">

<!-- TOC --><ul class="footer">
<li class="footer"><a rel="below" href="drm_69.html#HEADING69-31" class="footer">Element Type Subclassing</a></li>
<li class="footer"><a rel="below" href="drm_69.html#HEADING69-36" class="footer">Creating Limited Collection Types</a></li>
<li class="footer"><a rel="below" href="drm_69.html#HEADING69-39" class="footer">Uninstantiable Limited Collection Types</a></li>
<li class="footer"><a rel="below" href="drm_69.html#HEADING69-49" class="footer">Instantiable Limited Collection Types</a></li>
</ul>


</div>

<hr class="footer" />
<address class="footer">The Dylan Reference Manual - 7 Apr 1998</address>
<p class="footer"><a href="drm_70.html" class="header"><img alt="next" src="next.gif" class="header" /></a> <a href="drm_68.html" class="header"><img alt="prev" src="prev.gif" class="header" /></a> <a href="drm_59.html" class="header"><img alt="up" src="up.gif" class="header" /></a> <a href="drm_1.html" class="header"><img alt="top" src="top.gif" class="header" /></a> <a href="drm_2.html" class="header"><img alt="content" src="content.gif" class="header" /></a> <a href="drm_127.html" class="header"><img alt="index" src="index.gif" class="header" /></a></p>
<p class="footer">Copyright Apple Computer, Inc. 1996. Apple&#174; and the Apple logo are registered trademarks of Apple Computer, Inc. Used with permission. All Rights Reserved.</p>
<p class="footer">Generated with <a href="http://www.harlequin.com/webmaker" class="footer">Harlequin WebMaker&#174;</a></p>

</div>
</body>
</html>
