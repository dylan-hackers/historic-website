<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="top" href="drm_1.html" />
<link rel="up" href="drm_110.html" />
<link rel="prev" href="drm_112.html" />
<link rel="next" href="drm_114.html" />
<link title="main style sheet" rel="stylesheet" href="drm.css" type="text/css" />
<title>Local Declarations</title>
</head>
<body>

<div class="wm-div-body">
<a name="HEADING113"></a>

<div class="wm-div-headers">
<p class="header"><a href="drm_114.html" class="header"><img alt="next" src="next.gif" class="header" /></a> <a href="drm_112.html" class="header"><img alt="prev" src="prev.gif" class="header" /></a> <a href="drm_110.html" class="header"><img alt="up" src="up.gif" class="header" /></a> <a href="drm_1.html" class="header"><img alt="top" src="top.gif" class="header" /></a> <a href="drm_2.html" class="header"><img alt="content" src="content.gif" class="header" /></a> <a href="drm_127.html" class="header"><img alt="index" src="index.gif" class="header" /></a></p>
<p class="header">14 The Built-In Macros and Special Definitions</p>

</div>
<a name="HEADING113-0"></a>
<a name="UID-Built-In_Macros-7985"></a>
<h1 class="H1.Heading1"> Local Declarations</h1>
<p class="T1.Text1"><a name="MARKER-2-2029"></a>Local declarations are used to create bindings or install handlers that are active for the remainder of the innermost body containing the declaration. Bindings created by local declarations can be referenced only in the remaining program text of the body. Handlers installed are active while the execution of the remainder of the body is active, which includes the time during which any functions called from the remainder of the body are active.</p>
<table class="numbered"><caption><strong>Table 14-2</strong>  Local Declarations</caption>
<tr><th class="primary"><p class="TbH.TblHd"> Macro</p>
</th><th><p class="TbH.TblHd"> </p>
</th><th><p class="TbH.TblHd"> Description</p>
</th><th><p class="TbH.TblHd"> Page</p>
</th></tr><tr><td><p class="TbT.TblText"> <code class="TbT.TblText">let</code></p>
</td><td><p class="TbT.TblText"> </p>
</td><td><p class="TbT.TblText"> <a href="#MARKER-9-2031" class="TbT.TblText">Creates and initializes new local bindings within the smallest enclosing implicit body.</a></p>
</td><td><p class="TbT.TblText"> <a href="#MARKER-9-2031" class="TbT.TblText">390</a></p>
</td></tr><tr><td><p class="TbT.TblText"> <code class="TbT.TblText">local</code></p>
</td><td><p class="TbT.TblText"> </p>
</td><td><p class="TbT.TblText"> <a href="#MARKER-9-2035" class="TbT.TblText">Creates new local bindings within the smallest enclosing implicit body and initializes them to local methods that can be self-recursive and mutually recursive.</a></p>
</td><td><p class="TbT.TblText"> <a href="#MARKER-9-2035" class="TbT.TblText">391</a></p>
</td></tr><tr><td><p class="TbT.TblText"> <code class="TbT.TblText">let handler</code></p>
</td><td><p class="TbT.TblText"> </p>
</td><td><p class="TbT.TblText"> <a href="#MARKER-9-2038" class="TbT.TblText">Establishes a condition handler for the duration of the execution of smallest enclosing implicit body.</a></p>
</td><td><p class="TbT.TblText"> <a href="#MARKER-9-2038" class="TbT.TblText">392</a></p>
</td></tr></table><a name="HEADING113-63"></a>
<h3 class="H4.Heading4"> <code class="H4.Heading4"><a name="MARKER-2-2030"></a>let</code> <span class="attributes-summary">[Local Declaration]</span></h3>
<hr class="H4.Heading4" />
<p class="SD.ShortDescription"><a name="MARKER-9-2031"></a>Creates and initializes new local bindings within the smallest enclosing implicit body. </p>
<dl class="Cliche">
  <dt class="Cliche"><strong class="IMPORTANT Cliche">Macro Call:</strong></dt>
  <dd class="Cliche"><p class="Cliche"> <code class="Code Cliche">let<i class="Code Cliche"> variables = init ;</i></code></p></dd>
  <dt class="Cliche"><strong class="IMPORTANT Cliche">Arguments:</strong></dt>
  <dd class="Cliche"><p class="Cliche"> <i class="Parameter Cliche">variables <code class="BNF Parameter Cliche">variable<em class="BNF Parameter Cliche"><sub>bnf</sub> | ( variable-list<sub>bnf</sub> )</em></code></i></p></dd>
  <dd><dl class="RP.RoutineParam">
      <dt class="RP.RoutineParam"><i class="Parameter RP.RoutineParam">init</i></dt>
      <dd class="RP.RoutineParam"><p class="RP.RoutineParam"> <code class="BNF RP.RoutineParam">expression<em class="BNF RP.RoutineParam"><sub>bnf</sub></em></code></p></dd>
  </dl></dd>
  <dt class="Cliche"><strong class="IMPORTANT Cliche">Description:</strong></dt>
  <dd class="Cliche"><p class="Cliche"> <code class="Code Cliche">let</code> creates local bindings for the <i class="Parameter Cliche">variables</i>, and initializes them to the values returned by <i class="Parameter Cliche">init</i>. The bindings are visible for the remainder of the smallest enclosing implicit body.</p>
    <p class="T1.Text1"><a name="MARKER-2-2032"></a>The first value returned by the <i class="Parameter T1.Text1">init</i> is bound to the first <i class="Parameter T1.Text1">variable</i>, the second value to the second <i class="Parameter T1.Text1">variable</i>, etc. The last <i class="Parameter T1.Text1">variable</i> may be preceded by <code class="Code T1.Text1">#rest</code>, in which case it is bound to a sequence containing all the remaining values.</p>
    <p class="T1.Text1">Each <i class="Parameter T1.Text1">variable</i> is a variable-name or a variable-name followed by a specializer.</p>
    <p class="T1.Text1">If more than one binding is defined, the <i class="Parameter T1.Text1">variables</i> are enclosed in parentheses and separated by commas.</p>
    <pre class="Cv.Code">
let start = 0;

let (whole-part, remainder) = truncate(amount);

let (first-value, #rest rest-values) = get-initial-values();</pre>
    <p class="T1.Text1"><a name="MARKER-2-2033"></a>Local variables may be specialized. This ensures that their value will always be of a given type. An attempt to initialize or assign the variable to a value not of that type will signal an error of type <code class="Code T1.Text1">&lt;type-error&gt;</code>.</p>
    <pre class="Cv.Code">
let elapsed-time :: &lt;integer&gt; = 0;

let the-front-window :: &lt;window&gt; = front-window();

let(whole-part :: &lt;integer&gt;, remainder :: &lt;real&gt;) = truncate(amount);</pre>
  </dd>
</dl>
<a name="HEADING113-79"></a>
<h3 class="H4.Heading4"> <code class="H4.Heading4"><a name="MARKER-2-2034"></a>local</code> <span class="attributes-summary">[Local Declaration]</span></h3>
<hr class="H4.Heading4" />
<p class="SD.ShortDescription"><a name="MARKER-9-2035"></a><a name="MARKER-2-2036"></a>Creates new local bindings within the smallest enclosing implicit body and initializes them to local methods that can be self-recursive and mutually recursive.</p>
<dl class="Cliche">
<dt class="Cliche"><strong class="IMPORTANT Cliche">Macro Call:</strong></dt>
<dd class="Cliche"><p class="Cliche"> <code class="Code Cliche">local { [ method ] <i class="Parameter Code Cliche">name parameter-list  [ body ]  end [ method ] [ name ] } ,<em class="Superscript Parameter Code Cliche"><strong class="Superscript Parameter Code Cliche">+</strong></em></i></code></p></dd>
<dt class="Cliche"><strong class="IMPORTANT Cliche">Arguments:</strong></dt>
<dd class="Cliche"><p class="Cliche"> <i class="Parameter Cliche">name <code class="BNF Parameter Cliche">variable-name<em class="BNF Parameter Cliche"><sub>bnf</sub></em></code></i></p></dd>
<dd><dl class="RP.RoutineParam">
<dt class="RP.RoutineParam"><i class="Parameter RP.RoutineParam">parameter-list<code class="BNF Parameter RP.RoutineParam"></code></i></dt>
<dd class="RP.RoutineParam"><p class="RP.RoutineParam"> parameter-list<em class="RP.RoutineParam"><sub>bnf</sub></em></p></dd>
<dt class="RP.RoutineParam"><i class="Parameter RP.RoutineParam">body</i></dt>
<dd class="RP.RoutineParam"><p class="RP.RoutineParam"> <code class="BNF RP.RoutineParam">body<em class="BNF RP.RoutineParam"><sub>bnf</sub></em></code></p></dd>
</dl></dd>
<dt class="Cliche"><strong class="IMPORTANT Cliche">Description:</strong></dt>
<dd class="Cliche"><p class="Cliche"> <code class="cv Cliche">local</code> creates local methods that may be mutually recursive and self-recursive.</p>
<p class="T1.Text1">Each <i class="Parameter T1.Text1">name</i> creates a new local binding. The binding is initialized to a new method specified by the <i class="Parameter T1.Text1">parameter-list</i> and <i class="Parameter T1.Text1">body</i>. In addition to being visible for the remainder of the smallest enclosing implicit body, the bindings created for the <i class="Parameter T1.Text1">names</i> are visible to the <i class="Parameter T1.Text1">parameter-lists</i> and <i class="Parameter T1.Text1">bodies</i> of all the methods created by the <code class="Code T1.Text1">local</code> declaration.</p>
<p class="T1.Text1">The <i class="Parameter T1.Text1">parameter-list</i> is a standard method parameter list. A complete description of parameter lists is given in <a href="drm_49.html#MARKER-9-782" class="T1.Text1">"Parameter Lists" on page 84</a>.</p>
<p class="T1.Text1">The <i class="Parameter T1.Text1">body</i> is an implicit body.</p></dd>
</dl>
<a name="HEADING113-89"></a>
<h3 class="H4.Heading4"> <code class="H4.Heading4"><a name="MARKER-2-2037"></a>let handler</code> <span class="attributes-summary">[Local Declaration]</span></h3>
<hr class="H4.Heading4" />
<p class="SD.ShortDescription"><code class="SD.ShortDescription"><a name="MARKER-9-2038"></a><a name="MARKER-2-2039"></a></code>Establishes a condition handler for the duration of the execution of smallest enclosing implicit body.</p>
<dl class="Cliche">
<dt class="Cliche"><strong class="IMPORTANT Cliche">Macro Call:</strong></dt>
<dd class="Cliche"><p class="Cliche"> <code class="Code Cliche">let handler</code> <i class="Parameter Cliche">condition<code class="Code Parameter Cliche"> = handler</code></i></p></dd>
<dt class="Cliche"><strong class="IMPORTANT Cliche">Arguments:</strong></dt>
<dd class="Cliche"><p class="Cliche"> <i class="Parameter Cliche">condition</i> <i class="Parameter Cliche">type<code class="MetaSyntax Parameter Cliche"> | ( type  { ,option  }*)</code></i></p></dd>
<dd><dl class="RP.RoutineParam">
<dt class="RP.RoutineParam"><i class="Parameter RP.RoutineParam">type</i></dt>
<dd class="RP.RoutineParam"><p class="RP.RoutineParam"> <code class="BNF RP.RoutineParam">expression<em class="BNF RP.RoutineParam"><sub>bnf</sub></em></code></p></dd>
<dt class="RP.RoutineParam"><i class="Parameter RP.RoutineParam">option</i></dt>
<dd class="RP.RoutineParam"><p class="RP.RoutineParam"> test-option<code class="MetaSyntax RP.RoutineParam">  | <i class="Parameter MetaSyntax RP.RoutineParam">init-option</i></code></p></dd>
<dt class="RP.RoutineParam">test-option</dt>
<dd class="RP.RoutineParam"><p class="RP.RoutineParam"> <code class="Code RP.RoutineParam">test: expression<em class="Code RP.RoutineParam"><sub>bnf</sub></em></code></p></dd>
<dt class="RP.RoutineParam"><i class="Parameter RP.RoutineParam">init-option</i></dt>
<dd class="RP.RoutineParam"><p class="RP.RoutineParam"> <code class="Code RP.RoutineParam">init-arguments: expression<em class="Code RP.RoutineParam"><sub>bnf</sub></em></code></p></dd>
<dt class="RP.RoutineParam"><i class="Parameter RP.RoutineParam">handler</i></dt>
<dd class="RP.RoutineParam"><p class="RP.RoutineParam"> <code class="BNF RP.RoutineParam">expression<em class="BNF RP.RoutineParam"><sub>bnf</sub></em></code></p></dd>
</dl></dd>
<dt class="Cliche"><strong class="IMPORTANT Cliche">Description:</strong></dt>
<dd class="Cliche"><p class="Cliche"> <code class="Code Cliche">let handler</code> establishes a new condition handler that is in effect for the duration of the execution of the remainder of the smallest enclosing implicit body. Unlike the local declarations <code class="Code Cliche">let</code> and <code class="Code Cliche">local</code>, <code class="Code Cliche">let handler</code> does not create any bindings.</p>
  <ul class="B1.Bullet1">
    <li class="B1.Bullet1">The <i class="Parameter B1.Bullet1">condition</i> describes the conditions for which the handler is applicable.</li>
    <ul class="B2.Bullet2">
      <li class="B2.Bullet2">The <i class="Parameter B2.Bullet2">type</i> is the type of the applicable conditions. The handler will be applicable to conditions that are general instances of <i class="Parameter B2.Bullet2">type</i>.</li>
      <li class="B2.Bullet2">The <i class="Parameter B2.Bullet2">test-option </i> is a function that is called to further test the applicability of the handler. When a condition of type <i class="Parameter B2.Bullet2">type</i> is signaled, the test function will be called with that condition as an argument. If the test returns true, the handler is considered applicable to the condition. If the test returns false, the handler is considered to be inapplicable to the condition. The default value of this option is a function that always returns true. There can be at most one <i class="Parameter B2.Bullet2">test-option</i>.<br /><br />An example use for this feature is a restart handler for restarting only from a particular condition object, for example restarting from an unbound-slot error by setting the slot and retrying the invocation of the accessor. The <code class="Code B2.Bullet2">&lt;set-and-continue&gt;</code> restart condition will have the signaled <code class="Code B2.Bullet2">&lt;unbound-slot&gt;</code> condition in a slot, and the handler's test will check for it. (These class names are invented for this example and are not part of the specification.)</li>
      <li class="B2.Bullet2">The <i class="Parameter B2.Bullet2">init-option</i> is a sequence of alternating keywords and objects that can be used as initialization arguments to construct a condition to which the handler is applicable. For example, if the handler is a restart handler, a program could retrieve the <i class="Parameter B2.Bullet2">init-option</i> by calling <code class="cv B2.Bullet2">do-handlers</code>, and could then use them to construct a corresponding restart. There can be at most one <i class="Parameter B2.Bullet2">init-option</i>. <i class="Parameter B2.Bullet2">init-option</i> defaults to an empty sequence.</li>
    </ul>
    <li class="B1.Bullet1">The<i class="B1.Bullet1"> handler</i> is function called to handle a condition that matches <i class="Parameter B1.Bullet1">type</i> and passes <i class="Parameter B1.Bullet1">test-option</i>. The function should accept two arguments. The first argument will be the condition being signaled, and the second argument will be a next-handler function. The handler handles the condition by taking a nonlocal exit, returning values according to the condition's recovery protocol, or tail-recursively calling <code class="Code B1.Bullet1">signal</code> of a restart. The function can decline to handle the condition by tail-recursively calling the next-handler function with no arguments.</li>
  </ul>
  <p class="T1.Text1"><i class="Parameter T1.Text1">test-option</i> and <i class="Parameter T1.Text1">handler</i>  are distinct so that handler applicability can be tested without actually handling (which might take a nonlocal exit). One use for this is constructing a list of available restart handlers.</p>
  <p class="T1.Text1">There is no "condition wall," i.e., when executing <i class="Parameter T1.Text1">handler </i> the set of available handlers is not reset to the handlers that were in effect when the <code class="Code T1.Text1">let handler</code> was entered.</p>
  <p class="T1.Text1"> Implementations are encouraged to implement <code class="Code T1.Text1">let handler</code> in a way that optimizes establishing a handler for both speed and space, even if that increases the cost of signaling. The assumption is that most of the time a handler will never be used, because the exception it is looking for will never occur.</p>
  <p class="T1.Text1"><i class="Parameter T1.Text1">type</i>, <i class="Parameter T1.Text1">handler</i>, <i class="Parameter T1.Text1">test-option</i>, and <i class="Parameter T1.Text1">init-option</i> are executed before execution of the rest of the enclosing body begins.<a name="MARKER-2-2040"></a></p>
</dd>
</dl>

</div>

<div class="wm-div-footers">

<div class="wm-div-toc">

<ul class="footer">
<li class="footer"><a href="drm_113.html#HEADING113-63" class="footer">let [Local Declaration]</a></li>
<li class="footer"><a href="drm_113.html#HEADING113-79" class="footer">local [Local Declaration]</a></li>
<li class="footer"><a href="drm_113.html#HEADING113-89" class="footer">let handler [Local Declaration]</a></li>
</ul>


</div>

<hr class="footer" />
<address class="footer">The Dylan Reference Manual - 7 Apr 1998</address>
<p class="footer"><a href="drm_114.html" class="header"><img alt="next" src="next.gif" class="header" /></a> <a href="drm_112.html" class="header"><img alt="prev" src="prev.gif" class="header" /></a> <a href="drm_110.html" class="header"><img alt="up" src="up.gif" class="header" /></a> <a href="drm_1.html" class="header"><img alt="top" src="top.gif" class="header" /></a> <a href="drm_2.html" class="header"><img alt="content" src="content.gif" class="header" /></a> <a href="drm_127.html" class="header"><img alt="index" src="index.gif" class="header" /></a></p>
<p class="footer">Copyright Apple Computer, Inc. 1996. Apple&#174; and the Apple logo are registered trademarks of Apple Computer, Inc. Used with permission. All Rights Reserved.</p>
<p class="footer">Generated with <a href="http://www.harlequin.com/webmaker" class="footer">Harlequin WebMaker&#174;</a></p>

</div>
</body>
</html>
